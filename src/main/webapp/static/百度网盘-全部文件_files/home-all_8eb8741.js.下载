define("disk-system:widget/system/uiRender/menu/contextMenu/contextMenu.js",function(e){var t=e("base:widget/libs/jquerypacket.js"),n=(e("base:widget/tools/tools.js"),e("system-core:context/context.js").instanceForSystem),o=n.Broker,i=n.getList(),r=n.router,u=n.message,c={top:[{title:"查看",variableMenu:function(){var e=[{title:"列表",keyboard:"l"},{title:"缩略图",keyboard:"g"}];return i.isGridMode()?(e[1].icon=["icon-menu-point","icon-menu-point-hover"],e[0].action=function(){r.query.set("vmode","list")}):(e[0].icon=["icon-menu-point","icon-menu-point-hover"],e[1].action=function(){r.query.set("vmode","grid")}),e},keyboard:"v"},{title:"排序方式",nextMenu:[{title:"名称",action:function(){i.updateOrder("name")}},{title:"大小",action:function(){i.updateOrder("size")}},{title:"修改日期",action:function(){i.updateOrder("time")}}],display:function(){return"search"===n.router.currentRouteName?"disable":!0},keyboard:"o"},{title:"刷新",action:function(){u.trigger("system-refresh")},keyboard:"e"}],middle:[{title:"重新加载页面",action:function(){window.location.reload()},keyboard:"r"},{title:"新建文件夹",icon:"icon-menu-createfolder",action:function(){u.trigger("system-newdir")},display:function(){return"list"===n.router.currentRouteName?!0:"disable"},keyboard:"e"}],bottom:[{title:"会员中心",icon:"icon-menu-vip",action:function(){n.log.send({name:"rmenu_value_added",value:"右键菜单_会员中心"}),window.open(location.protocol+"//yun.baidu.com/buy/center?tag=8&from=rmenu&version=v5")},keyboard:"e"}]};o.initMenuBroker({target:document.getElementById("layoutMain"),type:"blank",config:c,events:{beforeMenu:function(){return t(this).hasClass("ExFGye")||t(this).closest(".ExFGye").length?!1:(i.cancelEidtingDir(),i.cancelFilesSelect(),void n.log.send({name:"web_rightContextMenu_white",value:"右键操作"}))},afterMenu:function(){i.lock(!0)},menuHide:function(){i.lock(!1)}}})});
;define("disk-system:widget/system/uiRender/menu/listMenu.js",function(e){var t=e("base:widget/libs/jquerypacket.js"),i=(e("base:widget/tools/tools.js"),e("system-core:context/context.js").instanceForSystem),n=i.message,s=i.Broker,o=i.getList(),r=".cEefyz",a=".AuPKyz",d={top:[{title:"打开",action:function(){t(this).closest(o.isGridMode()?r:a).find(".xlytjQoP").trigger("click")},display:function(){if(o.getCheckedIndexs().length>1)return"disable";var e=t(this).closest(o.isGridMode()?r:a);return e.length&&!e.hasClass("open-enable")?"disable":void 0},keyboard:"o"}],middle:[],bottom:[]};n.once("after-list-loaded",function(){s.initMenuBroker({target:t(".vdAfKMb").get(0),type:"file",config:d,events:{beforeMenu:function(){var e=t(this),i=e.closest(a);if(!i.length)return!1;var n=i.attr("_position");return isNaN(n)?!1:(o.cancelEidtingDir(),o.isItemChecked(n)||(o.setSingleItemChecked(n,!0),e.closest(".NHcGw").find(a).removeClass("xz0Enz"),i.addClass("xz0Enz")),void i.removeClass("dojQaj"))},afterMenu:function(){o.lock(!0)},menuHide:function(){o.lock(!1)}}}),s.initMenuBroker({target:t(".JKvHJMb").get(0),type:"file",config:d,events:{beforeMenu:function(){var e=t(this),i=e.closest(r);if(!i.length)return!1;var n=+i.attr("_position");if(isNaN(n))return!1;o.cancelEidtingDir();var s=i.index(),a=o.getGridPostiion(n,s);o.isItemChecked(a)||(o.setSingleItemChecked(a,!0),e.closest(".BNfIyPb").find(r).removeClass("xz0Enz"),i.addClass("xz0Enz")),i.removeClass("dojQaj")},afterMenu:function(){o.lock(!0)},menuHide:function(){o.lock(!1)}}}),t('input[node-type="kqrp8eK6"]').bind("contextmenu",function(e){e.stopPropagation()})})});
;define("disk-system:widget/system/uiRender/button/buttonBoxGuide.js",function(e,i,s){function t(){u&&d(".fujp0A7a").remove()}function r(e){var i=d("body"),s=e.left+10,r=e.top+40,a=['<div class="fujp0A7a" style="left: '+s+"px; top: "+r+'px;">','<i class="muno8RQm"></i>','<i class="ffrm03Qw"></i>','<span class="ptjMPK">与好友共同管理文件夹吧</span>','<a class="fjzz6x3">知道了</a>',"</div>"].join("");i.append(a),u=!0,i.find(".fjzz6x3").click(t)}var a=e("base:widget/libs/underscore.js"),d=e("base:widget/libs/jquerypacket.js"),n=e("base:widget/storage/storage.js"),o=window.yunData,u=!1;s.exports=a.throttle(function(e){1!==e.length&&t();var i=n.getItem("sharedir-guide-"+o.MYUK,1);if(!i){var s=this.$box.find(".icon-sharedir:visible");s.length&&(n.setItem("sharedir-guide-"+o.MYUK,1),r(s.offset()))}},500)});
;define("disk-system:widget/pageModule/toolbar/sort.js",function(t,e,i){var o=t("base:widget/libs/jquerypacket.js"),s=t("system-core:context/context.js"),n=0,r=!0,c={sortSwitchBtn:'div[node-type="jwk8PQN"]',sortSwitchList:'div[node-type="sDwvAgb"]',sortSwitchItem:'div[node-type="sDwvAgb"] .vAFAFF'},a={openOrCloseList:function(t){t?o(c.sortSwitchList).show():o(c.sortSwitchList).hide()},updateOrder:function(t){s.getList().updateOrder(t)},bindEvent:function(){var t=this;o(c.sortSwitchBtn).on("mouseenter",function(){return r?(clearTimeout(n),void t.openOrCloseList(!0)):!1}),o(c.sortSwitchBtn).on("mouseleave",function(){clearTimeout(n),n=setTimeout(function(){t.openOrCloseList(!1)},300)}),o(c.sortSwitchList).on("mouseenter",function(){clearTimeout(n),t.openOrCloseList(!0)}),o(c.sortSwitchList).on("mouseleave",function(){clearTimeout(n),n=setTimeout(function(){t.openOrCloseList(!1)},300)}),o(c.sortSwitchItem).on("click",function(){var e=o(this).attr("data-key");t.updateOrder(e),t.openOrCloseList(!1)})}},u=i.exports.setSortSelect=function(t){if(t){var e=-1;"name"===t.item?e=0:"size"===t.item?e=1:"time"===t.item&&(e=2),e>=0&&o(c.sortSwitchItem).removeClass("ugcOHtb").eq(e).addClass("ugcOHtb")}};i.exports.setSortAvailable=function(t){var e=o(c.sortSwitchBtn);(r=!!t)?e.removeClass("xvqjQ2P"):e.addClass("xvqjQ2P")},i.exports.init=function(){u({item:"time"}),a.bindEvent()}});
;define("disk-system:widget/system/util/imageSystem/imageSystem.js",function(e,n,t){var i=e("base:widget/tools/tools.js"),r=e("disk-system:widget/data/yunData.js").get(),o=window.URL&&window.URL.revokeObjectURL.bind(window.URL)||window.webkitURL&&window.webkitURL.revokeObjectURL.bind(window.webkitURL)||window.revokeObjectURL,a=window.URL&&window.URL.createObjectURL.bind(window.URL)||window.webkitURL&&window.webkitURL.createObjectURL.bind(window.webkitURL)||window.createObjectURL,u={name:"ImageSystem",version:1,db:null,isAvailable:!1,isOpen:!1},s={imageList:"imageList",owner:"owner"},c={imageWithSize:["imageWithSize",["fs_id","w","h"],{unique:!0}]},d=function(e,n,t){return new Promise(function(i,r){n?e[n]=function(e){i(e)}:e.onsuccess=function(e){i(e)},t?e[t]=function(e){r(e)}:e.onerror=function(e){r(e)}})},w=function(e,n){var t=indexedDB.open(e,n);return t.onupgradeneeded=function(e){var n,t=e.target.result,i=e.target.transaction;n=t.objectStoreNames.contains(s.imageList)?i.objectStore(s.imageList):t.createObjectStore(s.imageList,{autoIncrement:!0});for(var r in c)c.hasOwnProperty(r)&&!n.indexNames.contains(r)&&n.createIndex.apply(n,c[r]);t.objectStoreNames.contains(s.owner)||t.createObjectStore(s.owner,{keyPath:"uk"})},d(t)},b=function(){var e=!!window.ProgressEvent,n=!!window.FormData,t=window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest;return e&&n&&t},f=function(){return!!a},g=function(e,n){for(var t=u.db.transaction(e,"readwrite"),i=t.objectStore(e),r=0;r<n.length;r++)i.put(n[r]);return d(t,"oncomplete")},m=function(e){var n=u.db.transaction(e,"readonly"),t=n.objectStore(e),i=t.openCursor();return d(i)},l=function(e){var n=u.db.transaction(e,"readwrite"),t=n.objectStore(e),i=t.clear();return d(i)},v=function(e,n){return l(e).then(function(){return g(e,n)})},L=function(){return m(s.owner).then(function(e){var n=e.target.result;return n&&n.value.uk===r.uk?void 0:l(s.imageList)}).then(function(){return v(s.owner,[{uk:r.uk}])})},h=function(){return"object"!=typeof indexedDB?!1:"function"!=typeof Promise?!1:"yun.baidu.com"===location.hostname?!1:b()&&f()?navigator.userAgent.indexOf("Edge")>-1?!1:navigator.userAgent.indexOf("Safari")>-1&&-1===navigator.userAgent.indexOf("Chrome")?!1:!0:!1},R=function(){h()&&w(u.name,u.version).then(function(e){u.db=e.target.result,u.isOpen=!0},function(){u.isOpen=!1,u.isAvailable=!1}).then(function(){return L()}).then(function(){u.isAvailable=!0},function(){})},p=function(e,n){var t=u.db.transaction(s.imageList,"readonly"),i=t.objectStore(s.imageList),r=i.index(e),o=r.get(n);return d(o)},j=function(e){var n=i.getParam("size",e),t=/c(\d+)/gi,r=/u(\d+)/gi,o=t.exec(n);t=o?Number(o[1])||0:Number(i.getParam("height",e))||0;var a=r.exec(n);return r=a?Number(a[1])||0:Number(i.getParam("height",e))||0,{w:t,h:r}},U=function(e){return new Promise(function(n,t){var i=new XMLHttpRequest;i.open("GET",e),i.withCredentials=!0,i.responseType="blob",i.onload=function(e){200===e.target.status?n(e.target.response):t(e)},i.onerror=function(e){t(e)},i.send()})},k=function(e,n){var t=j(n);return p(c.imageWithSize[0],IDBKeyRange.only([e,t.w,t.h])).then(function(i){var r=i.target.result;return r?Promise.resolve(a(r.blob)):U(n).then(function(n){return g(s.imageList,[{fs_id:e,w:t.w,h:t.h,blob:n}]).then(function(){},function(){}),Promise.resolve(a(n))})})},y=/^blob:/,O={isAvailable:function(){return u.isAvailable&&u.isOpen},getImageURL:function(e,n){return O.isAvailable()?k(e,n):void Promise.reject({})},revokeBlobURL:function(e){y.test(e)&&o(e)}};R(),t.exports=O});
;define("disk-system:widget/system/util/lazyLoadImage.js",function(t,i,e){function s(){function t(){s.isReady=!0,r.isFunction(s.callback)&&s.callback()}if(b||u||!h)return void t();var i=l.getItem(d);return i?(_.HTTPVersion=i,void t()):void n.getJSON("https://thumbnail10.baidupcs.com/httpv").fail(function(){l.setItem(d,"1.1")}).done(function(t){t&&t.version?(l.setItem(d,t.version),_.HTTPVersion=String(t.version)):l.setItem(d,"1.1")}).always(function(){t()})}function o(t){if(t&&!t.src){var i=t.getAttribute("_src");if(i){var e=i.indexOf(I)>-1,s=!e&&i.indexOf(v)>-1;if(!e&&!s)return void(t._src=i);var o=e?I:v,a=I;e&&b&&(a=_.getIdleDomain()),s&&(a=_.getIdleDomain(!0)),o!==a&&(i=i.replace(o,a)),t._src=i}}}function a(){c.call(this),this.images=[],this.fids=[]}var n=t("base:widget/libs/jquerypacket.js"),r=(t("system-core:context/context.js").instanceForSystem,t("disk-system:widget/system/util/imageSystem/imageSystem.js"),t("base:widget/libs/underscore.js")),c=t("base:widget/tools/service/tools.event.js").EventEmitter,m=t("base:widget/tools/service/tools.util.js"),l=t("base:widget/storage/storage.js"),u=!1,d="thumbs_hv",h=!!(XMLHttpRequest&&"withCredentials"in XMLHttpRequest.prototype),g=/thumbnail10\.baidupcs/,p="normal",f="thumbs",b="http:"===document.location.protocol,I="d.pcs.baidu.com",v="thumbnail0.baidupcs",_={HTTPVersion:"1.1",currentDomainIndex:0,domainsList:{normal:[],thumbs:[]},_init:function(){for(var t=this.domainsList,i=0;10>i;i++)t.normal.push("d"+i+".pcs.baidu.com"),t.thumbs.push("thumbnail"+i+".baidupcs")},getIdleDomain:function(t){if(t&&"2"===_.HTTPVersion)return"thumbnail10.baidupcs";var i=t?f:p,e=this.domainsList[i];return e[this.currentDomainIndex++%10]}};_._init(),s.isReady=!1,s(),m.inherits(a,c),a.prototype.changeImages=function(t){if([].push.apply(this.images,t||[]),s.isReady)this._loadImage();else{var i=this;s.callback=function(){i._loadImage()}}},a.prototype._loadImage=function(){if(0!==this.images.length){var t=this.images.shift();o(t),t._src&&(this._installImage(t),this._loadImage())}},a.prototype._installImage=function(t){var i=r.now(),e=this,s=function(t){t.hasError||(t.src=t._src),t.complete?e._loadImageSucc(t):(t.onload=function(){e._loadImageSucc(this,r.now()-i)},t.onerror=function(){t.hasError=!0,e._loadImageFail(this)})};s(t)},a.prototype._loadImageSucc=function(t,i){var e=g.test(t.src);this.emit("done",t,i,e),this._commonLoadImageCall(t,e)},a.prototype._loadImageFail=function(t){this.emit("fail",t),this._commonLoadImageCall(t)},a.prototype._commonLoadImageCall=function(t){t.onload=t.onerror=null,this._loadImage()},e.exports=a});
;define("disk-system:widget/system/util/fileSystem/fileSystem.js",function(e,r,t){function n(){z("shareDir",IDBKeyRange.only([1,1])).then(function(e){e.length&&(p=e.map(function(e){return console.log("[SHARE DIR DEBUG] get share dir path:",e.path),new RegExp("^"+e.path+"/?")}))})}function i(e,r){if("[object Array]"===Object.prototype.toString.call(e)){var t=null;switch(r){case!0:t=function(e){e.share=1};break;case void 0:t=function(e){o(e.path)&&(e.share=1)};break;default:return}e.forEach(t)}}function o(e){for(var r=0,t=p.length;t>r;r++)if(p[r].test(e))return!0;return!1}function a(){var e=d.db.transaction(h.fileList,"readonly"),r=e.objectStore(h.fileList);try{r.index("shareDir")}catch(t){return!1}return!0}var s=e("base:widget/libs/jquerypacket.js"),u=e("base:widget/tools/tools.js"),c=e("disk-system:widget/data/yunData.js").get(),l=e("system-core:context/context.js").instanceForSystem,f=e("base:widget/storage/storage.js"),d={name:"FileSystem",version:1,db:null,isAvailable:!1,isOpen:!1,ajaxApi:"/api/filediff",throttleTime:100,syncTime:3e5,fileLimit:4e4},h={fileList:"fileList",cursor:"cursor",owner:"owner"},m={path:["path",["parent_path","isdir","server_mtime"],{unique:!1}],pathAndFileName:["pathAndFileName",["parent_path","isdir","server_filename"],{unique:!1}],pathAndSize:["pathAndSize",["parent_path","isdir","size"],{unique:!1}],category:["category",["category","isdir","server_mtime"],{unique:!1}],categoryAndFileName:["categoryAndFileName",["category","isdir","server_filename"],{unique:!1}],categoryAndSize:["categoryAndSize",["category","isdir","size"],{unique:!1}],shareDir:["shareDir",["share","isdir"],{unique:!1}]},p=[],v=function(e,r,t){return new Promise(function(n,i){r?e[r]=function(e){n(e)}:e.onsuccess=function(e){n(e)},t?e[t]=function(e){i(e)}:e.onerror=function(e){i(e)}})},g=function(e,r){var t=indexedDB.open(e,r);return t.onupgradeneeded=function(e){var r,t=e.target.result,n=e.target.transaction;r=t.objectStoreNames.contains(h.fileList)?n.objectStore(h.fileList):t.createObjectStore(h.fileList,{keyPath:"path"});for(var i in m)m.hasOwnProperty(i)&&!r.indexNames.contains(i)&&r.createIndex.apply(r,m[i]);t.objectStoreNames.contains(h.cursor)||t.createObjectStore(h.cursor,{keyPath:"cursor"}),t.objectStoreNames.contains(h.owner)||t.createObjectStore(h.owner,{keyPath:"uk"})},v(t)},y=function(e){var r=e.lastIndexOf("/");return r>0?e.slice(0,r):"/"},b=function(e,r){var t=d.db.transaction(e,"readwrite"),n=t.objectStore(e);for(var i in r)if(r.hasOwnProperty(i)){var o=r[i];o.path&&(o.parent_path=y(o.path)),o.isdelete?n["delete"](o.path):n.put(o)}return v(t,"oncomplete")},S=function(e){var r=d.db.transaction(e,"readonly"),t=r.objectStore(e),n=t.openCursor();return v(n)},A=function(e){var r=d.db.transaction(e,"readonly"),t=r.objectStore(e),n=t.count();return v(n)},j=function(e){var r=d.db.transaction(e,"readwrite"),t=r.objectStore(e),n=t.clear();return v(n)},_=function(e,r){return j(e).then(function(){return b(e,r)})},P=function(){return S(h.owner).then(function(e){var r=e.target.result;return r&&r.value.uk===c.uk?void 0:Promise.all([j(h.fileList),j(h.cursor)])}).then(function(){return _(h.owner,{uk:{uk:c.uk}})})},w=function(e,r){return new Promise(function(t,n){s.getJSON(e,r,function(e){e&&0===e.errno?t(e):n(e)}).error(function(e){n(e)})})},k=!0,x=u.throttle(function(){d.isAvailable||localStorage.getItem("block_uk_"+c.uk)||A(h.fileList).then(function(e){var r=e.target.result;return r>d.fileLimit||a()===!1?(localStorage.setItem("block_uk_"+c.uk,1),indexedDB.deleteDatabase("FileSystem"),Promise.reject(r)):Promise.resolve(r)}).then(function(){return S(h.cursor)}).then(function(e){var r={cursor:"null"},t=e.target.result;if(t)r.cursor=t.value.cursor;else{if(!k)return Promise.reject(!1);k=!1}return l.log.send({name:"filediff",sendServerLog:!1}),w(d.ajaxApi,r)}).then(function(e){var r=Promise.resolve(!0);return e.reset&&(r=j(h.fileList)),r.then(function(){return Promise.resolve(e)})}).then(function(e){return new Promise(function(r){setTimeout(function(){for(var t in e.entries)if(e.entries.hasOwnProperty(t)){var n=e.entries[t];1===n.isdir&&1===n.share&&(n.is_root=1)}r(e)},0)})}).then(function(e){return Promise.all([b(h.fileList,e.entries),_(h.cursor,{cursor:{cursor:e.cursor}})]).then(function(){return Promise.resolve(e)})}).then(function(e){e.has_more?x():(d.isAvailable=!0,N(),n())},function(){})},d.throttleTime,d.throttleTime),D=function(){return"object"!=typeof indexedDB?!1:"function"!=typeof Promise?!1:"yun.baidu.com"===location.hostname?!1:navigator.userAgent.indexOf("Edge")>-1?!1:f.overwrite&&!f.indexedDBCall?!1:!0},L=function(){D()&&g(d.name,d.version).then(function(e){d.db=e.target.result,d.isOpen=!0},function(){d.isOpen=!1,d.isAvailable=!1}).then(function(){return P()}).then(function(){x()},function(){})},z=function(e,r){var t=d.db.transaction(h.fileList,"readonly"),n=t.objectStore(h.fileList),i=n.index(e),o=i.openCursor(r,"next");return new Promise(function(e,r){var t=[];o.onsuccess=function(r){var n=r.target.result;n?(t.push(n.value),n["continue"]()):e(t)},o.onerror=function(e){r(e)}})},O=function(e,r){var t=d.db.transaction(h.fileList,"readonly"),n=t.objectStore(h.fileList),i=n.index(e),o=i.count(IDBKeyRange.bound([r,1,-1/0],[r,1,String.fromCharCode(65535)]));return v(o).then(function(e){return Promise.resolve(e.target.result)})},C=function(e,r){return e&&r?e[0]===r[0]?C(e.slice(1),r.slice(1)):/[a-zA-Z]/.test(e[0])&&/[a-zA-Z]/.test(r[0])||/\W/.test(e[0])&&/\W/.test(r[0])?e[0].localeCompare(r[0]):indexedDB.cmp(e[0],r[0]):e.localeCompare(r)},I=function(e){var r=function(e){var r=100,t=location.protocol+"//pcs.baidu.com/rest/2.0/pcs/thumbnail?method=generate&app_id=250528",n={path:e,quality:r};for(var i in n)if(n.hasOwnProperty(i)){var o=encodeURIComponent(n[i]);t+="&"+i+"="+o}return t};if("[object Array]"===Object.prototype.toString.call(e))for(var t=e.length,n=0;t>n;n++)if(e[n].category&&(1===e[n].category||3===e[n].category)&&e[n].path){var i=r(e[n].path);e[n].thumbs={icon:i+"&size=c60_u60",url1:i+"&size=c140_u90",url2:i+"&size=c360_u270",url3:i+"&size=c850_u580"}}return e},B={"/api/list":function(e,r){var t=m.path[0];t="name"===r.order?m.pathAndFileName[0]:"size"===r.order?m.pathAndSize[0]:m.path[0];var n=o(r.dir),a=[z(t,IDBKeyRange.bound([r.dir,1,-1/0],[r.dir,1,String.fromCharCode(65535)]))];return r.folder||a.push(z(t,IDBKeyRange.bound([r.dir,0,-1/0],[r.dir,0,String.fromCharCode(65535)]))),Promise.all(a).then(function(e){var o=[],a=[];o=e[0],e.length>1&&(a=e[1]),"name"===r.order&&(o.sort(function(e,r){return C(e.server_filename,r.server_filename)}),a.sort(function(e,r){return C(e.server_filename,r.server_filename)})),r.desc?(o.reverse(),a.reverse()):"size"===r.order&&o.reverse();var s=[0];if(r.folder)for(var u=0;u<o.length;u++){var c=o[u];s.push(O(t,c.path))}return Promise.all(s).then(function(e){for(var t=1;t<e.length;t++)o[t-1].dir_empty=e[t]>0?0:1;var s=o.concat(a);return r.page&&r.page>1&&(s=s.slice((r.page-1)*r.num+1)),i(s,n),s=I(s),Promise.resolve({errno:0,list:s,has_more:!1})})})},"/api/categorylist":function(e,r){var t=m.category[0];return t="name"===r.order?m.categoryAndFileName[0]:"size"===r.order?m.categoryAndSize[0]:m.category[0],z(t,IDBKeyRange.bound([parseInt(r.category,10),0,-1/0],[parseInt(r.category,10),0,String.fromCharCode(65535)])).then(function(e){var t=e;return"name"===r.order&&t.sort(function(e,r){return C(e.server_filename,r.server_filename)}),r.desc&&t.reverse(),r.page&&r.page>1&&(t=t.slice((r.page-1)*r.num+1)),i(t),t=I(t),Promise.resolve({errno:0,info:t,has_more:!1})})}},N=u.throttle(function(){x()},d.syncTime,d.syncTime),q={isAvailable:function(){return d.isAvailable&&d.isOpen},invalidCache:function(){q.isAvailable()&&N(),d.isAvailable=!1},hasApi:function(e){return q.isAvailable()&&B.hasOwnProperty(e)},getApi:function(e,r){return q.hasApi(e)?B[e](e,r):Promise.reject({})}};L(),t.exports=q});
;define("disk-system:widget/pageModule/preScanGarbage/preScanGarbage.js",function(e,n,i){var t=e("base:widget/libs/jquerypacket.js"),o=window.yunData||{},a=e("system-core:context/context.js").instanceForSystem,r=e("base:widget/storage/storage.js"),u=e("base:widget/tools/service/tools.format.js"),s={conf:{dialog:null,junkfileDialog:null,someThingShow:!1},url:{garbageTaskQueryUrl:"/api/garbagetaskquery",junkFileTaskQueryUrl:"/api/garbageguid"},util:{getDuplicatePreScan:function(){return s.conf.someThingShow?!1:void t.getJSON(s.url.garbageTaskQueryUrl,{type:"prescan"},function(e){0===e.errno&&e.valid&&s.util.showPreScanDialog(e)})},getJunkFileScan:function(e){var n=e.length?e.length:0;if(!(n>100)){for(var i=[],o=0;n>o;o++){var a={};a.fs_id=e[o].fs_id,a.md5=e[o].md5,a.md5&&a.fs_id&&i.push(a)}t.ajax({url:s.url.junkFileTaskQueryUrl,data:{filelist:t.stringify(i)},type:"POST",success:function(e){0===e.errno&&e.guid&&s.util.showJunkFileDialog()}})}},showGuide:function(){if(9===+o.CURRACTIVITYCODE)return!1;if(s.conf.someThingShow)return!1;if(9===o.CURRACTIVITYCODE)return!1;if(1===o.LOGINSTATUS&&!r.getItem("hide_couponbanner_uk_"+o.MYUK)&&(9===+o.CURRACTIVITYCODE||10===+o.CURRACTIVITYCODE||2===+o.SHOWVIPAD))return!1;var e=Date.parse(new Date),n="preScan_uk_"+o.MYUK,i=r.getItem(n),t=0;if(i){var a=i.indexOf("_");if(a>-1?t=Number(i.substring(i.length-1)):(t=0,i+="_0"),t>=3)return!1}return i?void(i&&e-Number(i.substring(0,i.length-2))>24192e5&&s.util.getDuplicatePreScan()):void s.util.getDuplicatePreScan()},showJunkFileGuide:function(e){if(9===+o.CURRACTIVITYCODE)return!1;if(s.conf.someThingShow)return!1;if(9===+o.CURRACTIVITYCODE)return!1;if(1===o.LOGINSTATUS&&!r.getItem("hide_couponbanner_uk_"+o.MYUK)&&(9===+o.CURRACTIVITYCODE||10===+o.CURRACTIVITYCODE||2===+o.SHOWVIPAD))return!1;if("1"===e.key&&"category"===e.cacheName||"list"===e.cacheName&&"/我的资源"===e.key.substring(0,5)){var n=Date.parse(new Date),i="showJunkVideo_uk_"+o.MYUK,t=r.getItem(i),a=0;if(t){var u=t.indexOf("_");if(u>-1?a=Number(t.substring(t.length-1)):(a=0,t+="_0"),a>=3)return!1}if(!t)return void s.util.getJunkFileScan(e.data);if(t&&n-Number(t.substring(0,t.length-2))>6048e5)return void s.util.getJunkFileScan(e.data)}},showPreScanDialog:function(e){var n=e.info&&e.info.totalSize;if(50>n/1024/1024/1024)return!1;var i=u.toFriendlyFileSize(n);s.conf.dialog||(s.conf.dialog=a.ui.window({id:"pre-scan",title:"",lock:!1,draggable:!1,width:"342px",zIndex:40,noFooter:!0,position:{xy:"bottom-right",offset:{bottom:"10px",right:"10px"},using:{props:{bottom:0},opts:{duration:800}}},body:'<p>您的网盘存有大量重复文件</p><p>清理后可以释放<span class="pre-clear-size">'+i+'</span>空间</p><a href="javascript:void(0);" class="vipbtn">扫描重复文件</a>',onClose:function(){var e=Date.parse(new Date),n="preScan_uk_"+o.MYUK,i=r.getItem(n),t=0;if(i){var u=i.indexOf("_");t=u>-1?Number(i.substring(i.length-1)):0}r.setItem(n,e+"_"+(3===t?3:t+1)),a.log.send({name:"clear_home_guide_duplicate_close",value:"重复文件引导弹窗关闭",sendServerLog:!0})}})),a.log.send({name:"clear_home_guide_duplicate",value:"重复文件引导弹窗",sendServerLog:!0}),s.conf.dialog.show(),s.conf.someThingShow="duplicate"},showJunkFileDialog:function(){s.conf.junkfileDialog||(s.conf.junkfileDialog=a.ui.window({id:"junk-scan",title:"",lock:!1,draggable:!1,width:"342px",zIndex:43,position:{xy:"bottom-right",offset:{bottom:"10px",right:"10px"},using:{props:{bottom:0},opts:{duration:800}}},body:'<p>您的网盘存有大量垃圾视频</p><p>清理后可以释放大量空间</p><a href="javascript:void(0);" class="vipbtn">扫描垃圾视频</a>',onClose:function(){var e=Date.parse(new Date),n="showJunkVideo_uk_"+o.MYUK,i=r.getItem(n),t=0;if(i){var u=i.indexOf("_");t=u>-1?Number(i.substring(i.length-1)):0}r.setItem(n,e+"_"+(3===t?3:t+1)),a.log.send({name:"clear_home_guide_junkFile_close",value:"垃圾文件引导弹窗关闭",sendServerLog:!0})}})),a.log.send({name:"clear_home_guide_junkFile",value:"垃圾文件引导弹窗",sendServerLog:!0}),s.conf.junkfileDialog.show(),s.conf.someThingShow="JunkFile"}},eventInit:function(){t("body").on("click",".dialog-pre-scan .vipbtn",function(){var e=Date.parse(new Date),n="preScan_uk_"+o.MYUK;r.setItem(n,e+"_0"),s.conf.dialog.hide(),a.log.send({name:"clear_home_guide_duplicate_click",value:"重复文件引导弹窗点击",sendServerLog:!0}),window.open("/disk/clear")}),t("body").on("click",".dialog-junk-scan .vipbtn",function(){var e="showJunkVideo_uk_"+o.MYUK,n=Date.parse(new Date);r.setItem(e,n+"_0"),s.conf.junkfileDialog.hide(),a.log.send({name:"clear_home_guide_junkFile_click",value:"垃圾文件引导弹窗点击",sendServerLog:!0}),window.open("/disk/clear")})}};s.eventInit(),i.exports.duplicateCheck=s.util.showGuide,i.exports.junkFileShow=s.util.showJunkFileGuide});
;define("disk-system:widget/pageModule/list/list-view-empty/list-view-empty.js",function(e,o,t){var s=e("base:widget/libs/jquerypacket.js"),d=e("system-core:context/context.js").instanceForSystem,n=d.router,i={dom:{module:".KPDwCE",searchEmptyModule:".jj8Rbr",viewEmptyModule:".aljqoz",noResultTcode:".eia81rM",noResultTcodePic:'div[node-type~="bnkjdBK"]',noResultTcodeClose:'a[node-type~="hvjW4K"]',newDirBox:'input[node-type~="kqrp8eK6"]',newDir:'div[node-type~="vlx0rbb"]',upLoad:".fgaa84X8",swfUpload:".zfjqAY",iconSpeed:".icon-speed"},bindEvent:function(){var e=s(i.dom.module);e.delegate(i.dom.noResultTcode,"mouseover",function(){s(i.dom.noResultTcodePic).show()}),e.delegate(i.dom.noResultTcode,"mouseout",function(){s(i.dom.noResultTcodePic).hide()})},tmpl:{emptyViewContainer:'<div class="bij8OdG aljqoz" style="" node-type="yraszboG"><div node-type="vlx0rbb" class="item global-clearfix" style="display: none;"><div class="fufHyA iw07ya" style="width: 60%;"><span class="MPbHyA"><span class="ecn8a4Q"></span></span><span class="qvnzmbD rfzZmJ hqz5xO"></span><div class="pdp0ox5" style="display: block;"><input node-type="kqrp8eK6" class="GadHyA" type="text" value=""><span node-type="ylaw0VGa" class="yuajvbQ"></span><span node-type="jdj8kvR" class="ie8Pgk"></span></div></div><div class="fufHyA" style="width: 16%">-</div><div class="fufHyA" style="width: 23%">-</div></div><div class="aGMvFtb"><div class="de8ek0 qvjWwj"><p class="ggEQwFb">您还没上传过文件哦，点击<span class="fgaa84X8">上传</span>按钮～</p></div><div class="zro0r7z"><div class="ie8O38"><div class="fedzjwv8"></div><span>您还可以下载百度网盘其它客户端</span></div><a hidefocus="true" class="nbajzmKE" href="http://pan.baidu.com/download#ipad" target="_blank">iPad版下载</a><a hidefocus="true" class="eia81rM" href="http://pan.baidu.com/download#android" target="_blank">手机版下载</a><a hidefocus="true" class="xcmgjvlQ" href="http://pan.baidu.com/download" target="_blank">PC版下载</a></div><div class="gbuz5V8" node-type="bnkjdBK"></div></div></div>',emptySearchContainer:'<div class="jj8Rbr"><div class="bflh0pa2"><div class="qcm0AE6"><i class="mivt02YW"></i><p>你的网盘中，没有找到相应内容</p></div></div></div>'},util:{render:function(){s(i.tmpl.emptyViewContainer).appendTo(i.dom.module),s(i.tmpl.emptySearchContainer).appendTo(i.dom.module)}}};s(document).ready(function(){i.bindEvent()}),t.exports.emptyView=function(){setTimeout(function(){d.message.callPlugin("上传@com.baidu.pan",{button:s(".fgaa84X8").get(0),mode:"directory",usdDialog:!0}),s(document).on("mouseover",".fgaa84X8",function(){s(this).attr({title:""}).css({cursor:"pointer"})}).on("click",".fgaa84X8",function(){s(this).attr("title",""),(s(i.dom.iconSpeed).length>0||s(i.dom.swfUpload).length>0)&&d.ui.tip({mode:"caution",msg:"请点击左上角“上传”按钮"})})},500);var e="search"===n.currentRouteName,o=n.query.get("key");return e&&o?i.tmpl.emptySearchContainer:i.tmpl.emptyViewContainer}});
;define("disk-system:widget/pageModule/list/grid-view/grid-view-builder.js",function(e,i,t){function a(){var e=document.createElement("dd");e.className="g-clearfix";var i=[];i.push('<div class="cEefyz">'),i.push('<div class="ul0JKz" title="">'),i.push('<img class="qkejzbDj"/>'),i.push('<span class="amhj81nj"></span>'),i.push("</div>"),i.push('<div class="file-name">'),i.push('<a node-type="xf0E4l" class="xlytjQoP" href="javascript:void(0);" title=""></a>'),i.push("</div>"),i.push('<span node-type="EOGexf" class="EOGexf"><span class="icon eekjBO0">&#xe93b;</span><span class="icon checkgridsmall">&#xe935;</span></span>'),i.push("</div>");for(var t=[],a=b.columnsCount=this.getColumnsCount(),s=0;a>s;s++)t.push(i.join(""));return e.innerHTML=t.join(""),e}function s(){v=null,f=null}function n(e,i){for(var t in i)o.inArray(+t,e)>=0?i[t].addClass("xz0Enz"):i[t].removeClass("xz0Enz")}function r(e,i,t){var a=i;null==a&&(a=this.buildView(e,i,t));for(var s,r,l,c=this.getGroupElementsData(),d=c[t],y=o(a),k=this,w="sharedir"===m.currentRouteName&&"/"===m.query.get("path"),I=this.getColumnsCount(),S=y.find(".cEefyz"),L=0;L<d.length;L++){s=d[L],r=S[L],l=o(r),r.style.display="block",r.setAttribute("_position",t),C[t*I+L]=l;var A=l.find(".ul0JKz");s.disableCheck?l.addClass("gxvMIQ"):l.removeClass("gxvMIQ"),this.isAllItemChecked()||this.isItemChecked(t*I+L)?l.addClass("xz0Enz"):l.removeClass("xz0Enz dojQaj"),r.getAttribute("_installed")||(l.mouseover(function(){return k.parent.isLocked()?!1:(o(this).addClass("dojQaj"),!1)}).mouseout(function(){return k.parent.isLocked()?!1:(o(this).removeClass("dojQaj"),!1)}),l.bind("click dblclick",function(e){var i=(new Date).getTime();if(k.parent.isLocked())return!1;var t,a=o(this),s=parseInt(a.attr("_position"),10),r=a.index(),l=s*I+r,c=k.getElementsData()[l],d=k.isItemChecked(l),b=!1;if(e.shiftKey){k.setItemsChecked(!1);var y=p,w=l;if(w>y)for(;w>=y;)k.setItemChecked(y,!0),y++;else if(y>w)for(;y>=w;)k.setItemChecked(y,!0),y--;else k.setItemChecked(y,!0);n(k.getCheckedIndexs(),C),v=l}else{if(!e.ctrlKey){if(c.isdir){k.setItemsChecked(!1);{c.server_filename}return k.parent.cache.cacheName===g.SEARCH||k.parent.cache.cacheName===g.SEARCHGLOBAL||k.parent.cache.cacheName===g.SEARCHPATH?m.push({name:"list",query:{path:c.path}}):c.externalFun&&"function"==typeof c.externalFun?c.externalFun():"sharedir"===m.currentRouteName?k.parent.goHistory("sharedir",c.path):k.parent.addHistory(c.server_filename,c.server_filename),!1}var S=a.data("plugin");if(S&&S.length)return h.trigger("plugin:"+S,{filesList:[c]}),!1;p=l,t=k.getCheckedIndexs(),t.length>0&&(d===!1||d&&t.length>1)&&(k.setItemsChecked(!1),b=!0),d&&t.length>1&&(d=!1)}v=l,f=null,k.setItemChecked(l,!d),b?k.requestLayout():d?a.removeClass("xz0Enz"):a.addClass("xz0Enz")}var L=(new Date).getTime();return u.log.send({name:"gridListSingleSel",value:L-i}),window.getSelection&&window.getSelection().removeAllRanges(),!1}).delegate(".EOGexf","click",function(e){var i=(new Date).getTime();if(k.parent.isLocked())return!1;e.stopPropagation();var t=o(this).closest(".cEefyz");if(t.hasClass("gxvMIQ"))return!1;var a=parseInt(t.attr("_position"),10),s=t.index(),n=a*I+s,r=k.isItemChecked(n);k.setItemChecked(n,!r),p=n,r?t.removeClass("xz0Enz"):(t.addClass("xz0Enz"),u.log.send({name:"listSel",value:1}));var l=(new Date).getTime();u.log.send({name:"gridListMultiSel",value:l-i})}).delegate(".EOGexf","dblclick",function(e){e.stopPropagation()}),r.setAttribute("_installed",1));var _=s.path;w&&(s.isdir=1,_=s.server_filename);var x=u.file.getIconAndPlugin(_,s.isdir,!1,s.share);l.find(".amhj81nj").remove(),"fileicon-large-video"===x.largeIcon&&(A.append('<span class="amhj81nj"></span>'),l.mouseenter(function(){o(this).find(".amhj81nj").show()}).mouseleave(function(){o(this).find(".amhj81nj").hide()})),A.attr('class', 'ul0JKz '+x.largeIcon),s.isdir||x.plugin?(l.addClass("open-enable"),l.data("plugin",x.plugin)):(l.removeClass("open-enable"),l.data("plugin",""));var J,H,T=l.find(".ul0JKz img");T.removeAttr("src"),4!==s.category&&s.thumbs&&s.thumbs.url1?(H=s.thumbs.url1.replace("size=c140_u90","size=c180_u194"),T.data("fs_id",s.fs_id),(J=b.loadedImgMap[H])?(T.removeAttr("_src").attr("src",J.src).css({left:J.left,top:J.top,visibility:"visible"}),T.parent().attr('class', 'ul0JKz')):T.removeAttr("src").attr("_src",H).css("visibility","hidden")):T.removeAttr("_src").removeAttr("src").css("visibility","hidden"),l.find(".xlytjQoP").html(x.name).attr("title",x.fileName).data("filename",s.server_name)}if(d.length!=I)for(var V=d.length;I>V;++V)S[V].style.display="none";return a}function l(e){b.gridViewContainer||(b.gridViewContainer=e.$gridViewContainer.find(".BNfIyPb")),b.itemHeight||(b.itemHeight=e.getCurrentView().itemHeight);var i=0;if(b.itemHeight>0){var t=b.gridViewContainer.scrollTop();i=Math.max(parseInt(t/b.itemHeight,10)-2,0)}b.load(i)}var c=e("base:widget/libs/underscore.js"),o=e("base:widget/libs/jquerypacket.js"),d=e("disk-system:widget/system/util/lazyLoadImage.js"),u=e("system-core:context/context.js").instanceForSystem,h=u.message,m=u.router,g={LIST:"list",CATEGORY:"category",SEARCHPATH:"searchPath",SEARCHGLOBAL:"searchGlobal",SEARCH:"search"},p=0,v=null,f=null,C={},b={columnsCount:0,gridViewContainer:null,itemHeight:0,lazyLoadImagePlugin:new d,loadedImgMap:{},init:function(){this.lazyLoadImagePlugin.on("done",c.bind(this.imgLoadedSuccessFunc,this)),this.lazyLoadImagePlugin.on("fail",c.bind(this.imgLoadedFailFunc,this))},imgLoadedSuccessFunc:function(e,i,t){e=o(e);var a,s=0,n=0,r=e.width(),l=e.height();r>0&&l>0&&(s=(90-r)/2,n=(92-l)/2),a={left:s,top:n,visibility:"visible"},e.css(a).removeAttr("_src");var c=e.attr("src");if(!c)return!1;var d=c.replace(/http:\/\/d[0-9]\./,"http://d.");a.src=c,this.loadedImgMap[d]=a,e.parent().attr('class', 'ul0JKz'),i&&u.log.send(t?{type:"imgLoading_h2_thumbnail_"+50*Math.ceil(i/50)}:{type:"imgLoading_thumbnail_"+50*Math.ceil(i/50)})},imgLoadedFailFunc:function(e){e=o(e),e.removeAttr("src"),e.removeAttr("_src")},checkCanLoad:function(e){for(var i=0,t=b.gridViewContainer,a=t.scrollTop(),s=t.height();e&&-1===e.className.indexOf("cEefyz");)e=e.parentNode,i+=e.offsetTop;return a-100>i?-1:i>a+s?0:1},load:function(e){for(var i=b.gridViewContainer,t=e?i.find("dd:gt("+e+")").find(".qkejzbDj[_src]"):i.find(".qkejzbDj[_src]"),a=[],s=0,n=t.length;n>s;s++){var r=t[s],l=this.checkCanLoad(r);if(0===l)break;-1!==l?1===l&&([].push.apply(a,[].slice.call(t,s,s+this.columnsCount)),s=s+this.columnsCount-1):s=s+this.columnsCount-1}this.lazyLoadImagePlugin.changeImages(a)}};b.init();var y=-1,k=0,w=1e3;t.exports={getView:r,buildView:a,onScroll:c.debounce(function(){h.trigger("list-view-scroll");var e=this.parent,i=c.now(),t=k;clearTimeout(y),k=i,i-t>w?l(e):y=setTimeout(l,w,e)},350),clear:s},h.listen("clearGridView",s),h.listen("clearViewBuilderCache",s)});
;define("disk-system:widget/pageModule/list/list-view/list-view-builder.js",function(e,t,i){function a(){return g.getButtonBroker("list")}function s(){C=null,k=null}function n(){var e=this.parent.listHeader.config.columns||[{width:60},{width:16},{width:23}],t=u.currentRouteName,i=document.createElement("dd");return i.className="g-clearfix AuPKyz",i.innerHTML="sharedir"===t?'<span node-type="EOGexf" class="EOGexf"><span class="icon NbKJexb">&#xe937;</span></span><div class="ul0JKz"></div><div class="file-name" style="width:'+e[0].width+'%"><div class="text"><a href="javascript:void(0);" class="xlytjQoP"></a></div><div class="operate"></div></div><div class="cwlz9JR" style="width:'+e[1].width+'%">-</div><div class="cckzlPW" style="width:'+e[2].width+'%"></div><div class="avv0n1A" style="width:'+e[3].width+'%"></div><div class="ihjxDO" style="width:'+(e[4]?e[4].width-1:0)+'%"><span class="dud8NNZ" node-type="qcf8PQk"></span></div>':'<span node-type="EOGexf" class="EOGexf"><span class="icon NbKJexb">&#xe937;</span></span><div class="ul0JKz"></div><div class="file-name" style="width:'+e[0].width+'%"><div class="text"><a href="javascript:void(0);" class="xlytjQoP"></a></div><div class="operate"></div></div><div class="cwlz9JR" style="width:'+e[1].width+'%">-</div><div class="avv0n1A" style="width:'+e[2].width+'%"></div><div class="ihjxDO" style="width:'+(e[3]?e[3].width-1:0)+'%"><span class="dud8NNZ" node-type="qcf8PQk"></span></div>',i}function l(e){if(e.highlighting&&e.highlighting.abstract){e.highlighting.abstractFixed=e.highlighting.abstract,e.highlighting.abstract=e.highlighting.abstract.replace(/\n+\s*\n/g,"\n"),e.highlighting.abstract=e.highlighting.abstract.replace(b,"");var t=e.highlighting.abstract,i=t.search(/<em>/);i>36&&(t=t.slice(i-12,t.length),e.highlighting.abstractFixed=t),e.highlighting.abstractFixed=e.highlighting.abstractFixed.replace(b,"")}return e}function r(e,t,i){var s=t,n=this;null==s&&(s=this.buildView(e,t,i));var r=this.getElementDataByPosition(i),g=c(s),b=g.find(".ul0JKz"),y=this.parent.cache.cacheName===f.SEARCHGLOBAL,x="sharedir"===u.currentRouteName,S=x&&"/"===u.query.get("path"),A=r.path;S&&(r.isdir=1,A=r.server_filename);var I=m.file.getIconAndPlugin(A,r.isdir,!1,r.share),_="-";if(r.show_name)_=d.encodeHTML(r.show_name);else{var L=v.getShowNameByUk(r.oper_id);L&&(_=d.encodeHTML(L))}if(g.find(".cckzlPW").html(_).attr("title",_).data("show_name",_),s.setAttribute("_position",i),s.setAttribute("_cmd_installed",1),r.disableCheck?g.find(".EOGexf").addClass("gxvMIQ"):g.find(".EOGexf").removeClass("gxvMIQ"),this.isAllItemChecked()||this.isItemChecked(i)?g.addClass("xz0Enz"):g.removeClass("xz0Enz dojQaj"),y){if(r=l(r),g.addClass("hyejy9R"),1!==+r.category&&3!==+r.category||!I.plugin)b.removeAttr("style");else{var H=r.thumbs.url1.replace(/size=.*&/,"size=c50_u50&").replace(/&quality=100/,"&quality=80");b.css("background","url("+H+") 50% 50% no-repeat")}b.attr('class', 'ul0JKz '+I.middleIcon)}else b.attr('class', 'ul0JKz '+I.smallIcon);if(r.isdir||I.plugin?(g.addClass("open-enable"),g.data("plugin",I.plugin)):(g.removeClass("open-enable"),g.data("plugin","")),y&&r.highlighting.filename?g.find(".xlytjQoP").html(r.highlighting.filename).attr("title",I.fileName).data("filename",r.server_filename):g.find(".xlytjQoP").html(I.name).attr("title",I.name).data("filename",r.server_filename),y){var E=[],R=g.find(".srnizbaD");E.push(r.highlighting&&r.highlighting.abstract?'<div node-type="ppqfjDY6" class="wnuu8kaa srnizbaD" title=" '+r.highlighting.abstract.replace(/\<em\>/g,"").replace(/\<\/em\>/g,"")+'">':'<div node-type="ppqfjDY6" class="wnuu8kaa srnizbaD" title="">'),E.push('<span class="gu0poB">'),E.push(r.highlighting.abstractFixed?'<span node-type="yzOBbsb" class="yzOBbsb">'+r.highlighting.abstractFixed+"</span>":'<span node-type="yzOBbsb" class="yzOBbsb">'+(r.highlighting.abstract||"")+"</span>"),E.push("</span></div>"),E=E.join(""),0===R.length?g.find(".file-name").append(E):R.html(E)}if(g.find(".cwlz9JR").text(r.isdir?"-":h.toFriendlyFileSize(r.size)),r.server_mtime||(r.server_mtime="-"),g.find(".avv0n1A").text("-"===r.server_mtime?r.server_mtime:o.parseDate(r.server_mtime)),this.parent.cache.cacheName===f.SEARCH||this.parent.cache.cacheName===f.SEARCHGLOBAL||this.parent.cache.cacheName===f.SEARCHPATH){var B=r.path.split("/"),J="",N="";2===B.length?(J="/",N="全部文件"):(J=B.slice(0,B.length-1).join("/"),N=B[B.length-2]),g.find(".dud8NNZ").data("path",J).attr("title",N).text(N)}if(!s.getAttribute("_installed")){var F,P;g.mouseenter(function(){if(F=(new Date).getTime(),n.parent.isLocked())return!1;var e=c(this);e.addClass("dojQaj");var t=e.find(".operate");if(""===t.html()){var i=parseInt(e.attr("_position"),10),s=n.getElementDataByPosition(i),l=a();l.resizeButtons([s]),t.html(l.getContent()),m.addIconFont&&m.message.trigger("addIcon",t[0])}return!1}).mouseleave(function(){if(n.parent.isLocked())return!1;var e=c(this);return e.removeClass("dojQaj"),e.find(".g-dropdown-button").removeClass("button-open"),P=(new Date).getTime(),m.log.send({name:"listListHover",value:P-F}),!1}),g.click(function(e){if(-1!==n.mCheckedChildren.indexOf(!0)){var t=g.parent().children();t.removeClass("xz0Enz"),n.setItemsChecked(!1)}var i=(new Date).getTime();if(n.parent.isLocked())return!1;if(g.find(".EOGexf").hasClass("gxvMIQ"))return!1;var a=parseInt(this.getAttribute("_position"),10),s=n.isItemChecked(a),l=n.getCheckedIndexs(),r=e.ctrlKey,o=c(this);if(e.shiftKey){var h=Math.min(a,C),d=Math.max(a,C),p=o,u=!1;if("number"==typeof k){var v=Math.min(a,k),f=Math.max(a,k);for(u=v===a;f>=v;)n.setItemChecked(v,!1),p.length>0&&p.removeClass("xz0Enz"),p=u?p.next(w.listViewItem):p.prev(w.listViewItem),v++}for(p=o,u=h===a;d>=h;)n.setItemChecked(h,!0),p.length>0&&p.addClass("xz0Enz"),p=u?p.next(w.listViewItem):p.prev(w.listViewItem),h++;k=a}else k=null,r||(l.length>0&&(s===!1||s&&l.length>1)&&(n.setItemsChecked(!1),o.siblings(w.listViewItem).removeClass("xz0Enz")),s&&l.length>1&&(s=!1)),n.setItemChecked(a,!s),s?o.removeClass("xz0Enz"):o.addClass("xz0Enz"),C=a;var b=(new Date).getTime();m.log.send({name:"listListSingleSel",value:b-i}),window.getSelection&&window.getSelection().removeAllRanges()}),g.delegate(".xlytjQoP","click",function(){if(n.parent.isLocked())return!1;var e=parseInt(c(this).closest(w.listViewItem)[0].getAttribute("_position"),10),t=n.getElementDataByPosition(e);if(t.isdir)if(n.parent.cache.cacheName===f.SEARCH||n.parent.cache.cacheName===f.SEARCHGLOBAL||n.parent.cache.cacheName===f.SEARCHPATH){var i=u.query.get("vmode")||"list";u.push({name:"list",query:{path:t.path,vmode:i}})}else t.externalFun&&"function"==typeof t.externalFun?t.externalFun():"sharedir"===u.currentRouteName?n.parent.goHistory("sharedir",t.path):n.parent.addHistory(t.server_filename,t.server_filename);else{var a=g.data("plugin");if(!a||!a.length)return!0;p.trigger("plugin:"+a,{filesList:[t]})}return!1}).delegate(".g-button","click",function(){if(n.parent.isLocked())return!1;var e=parseInt(c(this).closest(w.listViewItem)[0].getAttribute("_position"),10),t=n.getElementDataByPosition(e),i=c(this).next(".menu");if(i.length)return c(this).closest(".g-dropdown-button").toggleClass("button-open"),void(i.offset().top>c(window).height()-i.outerHeight()?i.addClass("more-list-up"):i.removeClass("more-list-up"));var s=c(this).index()-1;a().triggerClick(s,{filesList:[t],position:[e]})}).delegate(".g-button-menu","click",function(){if(n.parent.isLocked())return!1;var e=parseInt(c(this).closest(w.listViewItem)[0].getAttribute("_position"),10),t=n.getElementDataByPosition(e),i=c(this).index();a().triggerClick(i,{filesList:[t],position:[e]}),c(this).closest(".g-dropdown-button").removeClass("button-open")}).delegate(".operate","click",function(e){return n.parent.isLocked()?!1:void e.stopPropagation()}).delegate(".EOGexf","click",function(e){e.stopPropagation();var t=(new Date).getTime();if(n.parent.isLocked())return!1;if(g.find(".EOGexf").hasClass("gxvMIQ"))return!1;var i=c(this).closest(w.listViewItem),a=parseInt(i.attr("_position"),10),s=n.isItemChecked(a);n.setItemChecked(a,!s),s?i.removeClass("xz0Enz"):(i.addClass("xz0Enz"),m.log.send({name:"listSel",value:1})),a=parseInt(c(this).parent()[0].getAttribute("_position"),10),C=a;var l=(new Date).getTime();m.log.send({name:"listListMultiSel",value:l-t})}).delegate(".EOGexf","dblclick",function(e){e.stopPropagation()}).delegate(".dud8NNZ","click",function(e){e.stopPropagation(),u.push({name:"list",query:{path:c(e.target).data("path")}})}),g.bind("dblclick",function(){if(n.parent.isLocked())return!1;var e=parseInt(c(this)[0].getAttribute("_position"),10),t=n.getElementDataByPosition(e);if(t.isdir)n.parent.cache.cacheName===f.SEARCH||n.parent.cache.cacheName===f.SEARCHGLOBAL||n.parent.cache.cacheName===f.SEARCHPATH?u.push({name:"list",query:{path:t.path}}):t.externalFun&&"function"==typeof t.externalFun?t.externalFun():"sharedir"===u.currentRouteName?n.parent.goHistory("sharedir",t.path):n.parent.addHistory(t.server_filename,t.server_filename);else{var i=g.data("plugin");if(!i||!i.length)return!0;p.trigger("plugin:"+i,{filesList:[t]})}return!1}),s.setAttribute("_installed",1)}return s}var c=e("base:widget/libs/jquerypacket.js"),o=e("base:widget/tools/service/tools.date.js"),h=e("base:widget/tools/service/tools.format.js"),d=e("base:widget/tools/service/tools.html.js"),m=e("system-core:context/context.js").instanceForSystem,g=m.Broker,p=m.message,u=m.router,v=m.tools.shareDirManager,f={LIST:"list",CATEGORY:"category",SEARCHPATH:"searchPath",SEARCHGLOBAL:"searchGlobal",SEARCH:"search"},w={listViewItem:".AuPKyz"},b=/^[.,?\]})';:`~!%&*|>，﹐。？、】）·！…’”；：]*/,C=null,k=null;i.exports={getView:r,buildView:n,clear:s,onScroll:function(){p.trigger("list-view-scroll")}},p.listen("clearListView",s),p.listen("clearViewBuilderCache",s)});
;define("disk-system:widget/system/util/cache/cacheUtils.js",function(e,t,a){var h=e("system-core:system/cache/listCache/cacheManage.js"),r={getCache:function(){return h.getCache()},deleteCacheByMode:function(e,t,a){var h=t.getDataByKey();this.removeCacheAll();for(var c=h&&h.list,i=!1,o="",s="",n=c.length,v=n-1;v>=0;v--){for(var C=a.length,m=C-1;m>=0;m--)o=a[m],s=o.path||o,c[v].path==s&&(a.splice(m,1),i=!0);i&&(c.splice(v,1),i=!1)}return h.list=c,r.getCache()[t.cacheName].data[t.getKey()]=h,h},removeCacheByPath:function(e){var t=this.getCache(),a={};t&&t.list&&t.list.data&&(a=t.list.data),a[e]&&delete a[e],this.removeOtherListCache()},removeCacheAll:function(){var e=this.getCache();for(var t in e)e.hasOwnProperty(t)&&e[t]&&e[t].data&&(e[t].data={})},removeCacheByType:function(e,t,a,h){var r=this.getCache(),c={};return r&&r[e]&&r[e].data?(c=r[e].data,this.removeSubFiles(c,t),void("move"===a&&this.removeSubFiles(c,h))):!1},removeCache:function(e,t,a,h){h||(h="list"),this.removeCacheByType(h,e,t,a),"list"===h&&this.removeOtherListCache()},removeSubFiles:function(e,t){t="/"===t?t:t+"/";for(var a in e)e.hasOwnProperty(a)&&0===(a+"/").indexOf(t)&&delete e[a]},removeOtherListCache:function(){this.removeCategoryCache(),this.removeSearchCache(),this.removeTreeCache()},removeCategoryCache:function(){this.removeCacheByKey("category")},removeSearchCache:function(){this.removeCacheByKey("search")},removeTreeCache:function(){this.removeCacheByKey("tree")},removeCacheByKey:function(e){var t=this.getCache();t&&t[e]&&t[e].data&&(t[e].data={})}};a.exports=r});
;define("disk-system:widget/pageModule/list/dragAndSelect.js",function(e,i,t){var s=e("system-core:context/context.js").instanceForSystem,n=e("base:widget/libs/jquerypacket.js");t.exports=function(){var i={listViewContainer:".vdAfKMb",gridViewContainer:".JKvHJMb",listViewItem:".AuPKyz",gridViewItem:".cEefyz"};e.async("disk-system:widget/system/util/mouse-utils/mouse-select.js",function(e){var t=s.getList();new e({$dom:n(i.listViewContainer),item:i.listViewItem,viewMod:"list",selectClass:"xz0Enz",list:t,canSelect:function(){return t.isLocked()?!1:void 0},onEnd:function(){}}),new e({$dom:n(i.gridViewContainer),item:i.gridViewItem,vieMod:"grid",selectClass:"xz0Enz",list:t,canSelect:function(){return t.isLocked()?!1:void 0},onEnd:function(){}})}),e.async("disk-system:widget/system/util/mouse-utils/mouse-drag.js",function(e){function t(e){var i=o.getCheckedItems();s.message.trigger("system-move-to",i,e.path),s.log.send({name:"web_mouseDrag",value:"拖拽"})}var o=s.getList();new e({$dom:n(i.listViewContainer),item:i.listViewItem,viewMod:"list",selectClass:"xz0Enz",list:o,onDragEndCallback:t}),new e({$dom:n(i.gridViewContainer),item:i.gridViewItem,viewMod:"grid",selectClass:"xz0Enz",list:o,onDragEndCallback:t})})}});
;define("disk-system:widget/system/fileService/fileOperateEntry.js",function(e,t,s){function i(e,t){var s=l.getInstance();if(s.flagExists())return void s.focus();i.file=e;var a=o.getList(),n=s.show({rename:!0,viewClassName:a.isGridMode()?"cbkz5WO":"",path:e.path,position:t,cacheMod:a.cache.cacheName});n&&a.lock(!0)}var a=e("base:widget/tools/tools.js"),n=e("base:widget/storage/storage.js"),c=e("base:widget/libs/jquerypacket.js"),o=e("system-core:context/context.js").instanceForSystem,r=e("disk-system:widget/system/util/cacheUtil.js"),l=e("disk-system:widget/system/fileService/createNewDir/createNewDir.js"),g=e("disk-system:widget/system/fileService/fileDelete/fileDelete.js"),d=e("disk-system:widget/system/fileService/fileMoveCopy/fileMoveCopy.js").getInstance(),f=e("disk-system:widget/system/fileService/fileRecycle/fileRecycle.js"),m=o.message,h=o.tools.topMountManager,v=o.router;i.file=null;var y=s.exports.removeFiles=function(e,t,s){g.deleteFiles(e,function(s,i,a){var n=o.getList(),c=v.currentRouteName;0===s&&(a=r.deleteCacheByMode(c,n.cache,e),n.setItemsChecked(!1,!0),n.updateLoadingTips(a.hasMore?1:2,a.list.length),n.getCurrentView().updateBackedData(a.list)),"function"==typeof t&&t(s,i)},s)};s.exports.isBlocking=function(){return l.getInstance().isBlocking()},s.exports.forReady=function(){var e=l.getInstance();e.on("success",function(t,s){var n=o.getList();if(n.lock(!1),e.rename){var c=i.file;i.file=void 0;var l=v.currentRouteName,g=a.parseFullDirFromPath(c.path);c.path=g+"/"+t,c.server_filename=t,c.highlighting&&c.highlighting.filename&&(c.highlighting.filename=t),n.setItemsChecked(!1);var d=r.deleteCacheByMode(l,n.cache,[]);n.getCurrentView().updateBackedData(d.list)}else{var f=n.cache.cacheName,m=n.cache.getKey();n.setItemsChecked(!1,!0),r.replaceSingleCache(f,m,s,h.getLengthByKey(m))}}),e.on("cancel",function(){var t=o.getList();if(t.lock(!1),!e.rename){var s=t.cache.getKey();t.cache.removeByIndex(h.getLengthByKey(s)),t.refreshList()}})},d.on("success",function(e,t){var s=o.getList(),i=v.currentRouteName;if("move"===e){var a=r.deleteCacheByMode(i,s.cache,t);s.setItemsChecked(!1,!0),s.updateLoadingTips(a.hasMore?1:2,a.list.length),s.getCurrentView().updateBackedData(a.list)}else r.deleteCacheByMode(i,s.cache,[])}),m.listen("cancelEidtingDir",function(){var e=l.getInstance();e.isBlocking()&&e.cancel()}),m.listen("system-newdir",function(){var e=l.getInstance();if(e.flagExists())return void e.focus();var t=o.getList(),s=t.cache.getKey(),i=h.getLengthByKey(s);t.setItemsChecked(!1,!0),t.cache.addDataByIndex({obj:{path:"/-",server_filename:"-",isdir:1,server_mtime:"-",oper_id:window.yunData.MYUK},index:i}),t.refreshList(),s="/"===s?"":s,s+="/新建文件夹";var a=t.isGridMode();e.show({viewClassName:a?"cbkz5WO rjg8klR":"",path:s,position:{left:a?128*i-3:20,top:a?54:45*i+58}}),t.lock(!0)}),m.listen("system-rename",function(e){var t=d.manageStatus();if(!t){var s=o.getList();if(!s.isLocked()){var a=e.position,n=e.list;if(!a){var r=s.getCheckedItems();r.length===n.length&&n[0]===s.getCheckedItems()[0]&&(a=s.getCheckedIndexs())}if(a&&a.length>0){s.fixTargetPositionVisible(a[0]);var l=s.getDomByPosition(a[0]);if(!l)return;var g=s.$container.offset(),f=c(l).offset(),m=f.left-g.left+20,h=f.top-g.top;s.isGridMode()&&(h-=7,m-=34),i(n[0],{left:m,top:h})}}}}),m.listen("system-delete",function(e){var t=d.manageStatus();if(!t){var s=o.getList();s.isLocked()||y(e.list,e.callback,e.sync)}}),m.listen("system-copy",function(e){var t=d.manageStatus();if(!t){var s=o.getList();if(!s.isLocked()){var i=e.list;i&&i.length>0&&d.showDialog(i,"copy")}}}),m.listen("system-move-to",function(e,t){d.moveTo(e,t)}),m.listen("system-clearRecycle",f.clearFiles),m.listen("system-deleteRecycle",f.deleteFiles),m.listen("system-restore",f.restore),m.listen("system-move",function(e){var t=d.manageStatus();if(!t){var s=d.isNotMoveByPaths(e.list);if(s)return void o.instanceForSystem.ui.tip({mode:"caution",msg:"预置文件不可以移动"});var i=o.getList();if(!i.isLocked()){var a=e.list;a&&a.length>0&&d.showDialog(a,"move")}}}),setTimeout(function(){var e="asynfilemanager_"+(yunData.MYNAME||"").replace(/@/g,""),t=n.getItem(e)||"",s=t.split("_");2===s.length&&(n.removeItem(e),d.resolveHasTask(s[0],s[1],function(e,t,s,i){if((1===e||3===e)&&i){var a=o.getList(),n=i.operate;"move"===n||"delete"===n?r.removeCache(a.cache.getKey(),n):r.removeCacheByKey("list"),a.refreshList()}}))},1500)});
;define("disk-system:widget/system/fileService/asynFileManager/asynFileManager.js",function(e,a,t){function r(e){this.config=e,this.tiping=!1}var s=e("base:widget/libs/jquerypacket.js"),o=e("base:widget/storage/storage.js"),i=e("system-core:context/context.js").instanceForSystem,n=e("disk-system:widget/system/fileService/asynFileManager/asynFileManagerView.js");r.moveFiles=function(e,a,t){l.doCommonTest(e,"move")&&l.doMoveCopyThing("move",e,a,t)},r.copyFiles=function(e,a,t){l.doCommonTest(e,"copy")&&l.doMoveCopyThing("copy",e,a,t)},r.deleteFiles=function(e,a){l.doCommonTest(e,"delete")&&(l.doDeleteThing("delete",e,a),this.operating=!0)},r.deleteFileSync=function(e,a){l.doCommonTest(e,"delete")&&s.post("/api/filemanager?opera=delete&async=0",{filelist:s.stringify(e)},function(e){e&&0===e.errno?a(1,e):e&&132===e.errno?a(132,e):a(0,e)},"json").error(function(e){var t=s.parseJSON(e.responseText);a(0,t)})},r.rename=function(e,a,t){l.doCommonTest(e,"rename")&&l.doRename("rename",e,a,t)},r.transferFiles=function(){},r.resolveHasTask=function(e,a,t){var r={},s={},o={};o.taskid=parseInt(e,10),r.operate=a,s.operate=a,s.callback=t,s.async=1,l.doMoveCopySuccCall(o,r,s)},r.transferFile=function(){},r.restore=function(e){var a="restore";l.doCommonTest(e.fidlist,a)&&(l.data.selectedFiles=e.selectedFiles,l.getData(a,e))},r.deleteRecycle=function(e){var a="deleteRecycle";l.doCommonTest(e.fidlist,a)&&(l.data.selectedFiles=e.selectedFiles,l.getData(a,e))},r.clearRecycle=function(e){var a="clearRecycle";l.data.selectedFiles=e.selectedFiles,l.getData(a,e)};var l={};l.data={},l.QUERY_TIMEER=1e3,l.getFileNameByPath=function(e){e=e||"";var a=e.lastIndexOf("/");return e.substring(a+1)},l.getDirFromPath=function(e){return e=e||"",e.substring(0,e.lastIndexOf("/"))},l.doCommonTest=function(e,a){var t=e&&e.length>0;return i.ui.tip(t?{mode:"loading",msg:"正在"+l.getOperateName(a)+"文件，请稍候&hellip;",autoClose:!1}:{mode:"caution",msg:"请选择要"+l.getOperateName(a)+"的文件"}),t},l.doMoveCopyThing=function(e,a,t,r){var o,i,n={},c=[];t="/"===t?"":t;for(var p=0,d=a.length;d>p;p++)o=a[p],i={path:o.path,dest:t,newname:o.newname||l.getFileNameByPath(o.path)},c.push(i);n.filelist=s.stringify(c),n.list=c,n.callback=r,l.getData(e,n)},l.doDeleteThing=function(e,a,t){var r={};r.filelist=s.stringify(a),r.list=a,r.callback=t,l.getData(e,r)},l.doRename=function(e,a,t,r){var o={};o.filelist=s.stringify([{path:a,newname:t}]),o.callback=r,l.getData(e,o,null,l.doRenameFailCall)},l.doSuccessCall=function(e,a,t){l.doMoveCopySuccCall(e,a,t)},l.doFailCall=function(e,a,t){if(2===t.async||12!==e.errno&&-8!==e.errno&&-9!==e.errno||e.info&&e.info[0]&&111===e.info[0].errno)if(132===e.errno)c=132,l.callTaskOverCallBack(c,t.callback,e,a,t);else{var r,o=e.errno,n="文件"+l.getOperateName(t.operate)+"失败，请稍候再试",c=3;if(12===o&&"delete"===t.operate?r=n:(12===o&&e.info&&e.info[0]&&e.info[0].errno&&(o=e.info[0].errno),102===o&&e.info&&e.info[0]&&e.info[0].errno&&(o=102===e.info[0].errno?"-102":e.info[0].errno),r=3===o?"一次操作数量不可以超过"+(e.limit||500)+"个":i.errorMsg(o,n,function(){a.removeNest=!0,a.callback=t.callback,a.list=t.list,l.getData(t.operate,a)})),e.flagNetError){if(c=0,!e.flagNetErrorProcess){var p=t.list,d=[];if("delete"===t.operate)for(var f=0,u=p.length;u>f;f++)d.push({from:p[f]});else if("restore"===t.operate){if(l.data.selectedFiles)for(var f=0;f<l.data.selectedFiles.length;f++){var g=l.data.selectedFiles[f];d.push({from:g.path})}}else for(var f=0,u=p.length;u>f;f++)d.push({from:p[f].path});return l.hideTips(),void l.showOtherErrorAsynView("failnet",d,t.operate,a,t)}r="任务进度查询失败，请稍候重试"}l.showErrorCloseTips(r),l.callTaskOverCallBack(c,t.callback,e,a,t)}else{if(a.async=2,a.callback=t.callback,a.list=t.list,"restore"===t.operate)a.url=t.url,a.fidlist=s.stringify(e.faillist);else{var m=e.info,h=[];if(m&&m.length>0)for(var f=0,u=m.length;u>f;f++)0===m[f].errno&&h.push(m[f].path);if(h.length>0&&t.list&&t.list.length>0)if("delete"===t.operate)for(var y=t.list.length-1;y>=0;y--)s.inArray(t.list[y],h)>=0&&t.list.splice(y,1);else for(var y=t.list.length-1;y>=0;y--)s.inArray(t.list[y].path,h)>=0&&t.list.splice(y,1);a.filelist=s.stringify(t.list)}l.getData(t.operate,a)}},l.doRenameFailCall=function(e,a,t){e.flagNetError?l.showErrorCloseTips("网络异常，重名失败，稍后重试下吧"):12===e.errno?l.showRenameAsynView(e,a,t):l.callTaskOverCallBack(0,t.callback,e,a,t)},l.doMoveCopySuccCall=function(e,a,t){e.taskid>0?(l.setTaskProcess(e.taskid,0),l.taskMap.result=e,l.taskMap.params=a,l.taskMap.otherParams=t,o&&o.setItem&&e.taskid&&t.operate&&o.setItem(l.getTaskKey(),e.taskid+"_"+t.operate),l.startGetQueryData(t.operate,e.taskid,a)):(l.showSuccTips("文件"+l.getOperateName(t.operate)+"成功"),l.callTaskOverCallBack(1,t.callback,e,a,t))},l.processSuccCall=function(e,a,t){if(0!==e.task_errno)if(l.hideTips(),-32===e.task_errno)e.errno=e.task_errno,l.doFailCall(e,a,t);else switch(t.operate){case"delete":l.showDeleteAsynView(e,a,t);break;case"rename":l.showRenameAsynView(e,a,t);break;default:l.showAsynView(e,a,t)}else if("pending"===e.status)r.tiping||l.showProcessTips("正在"+l.getOperateName(t.operate),0),l.startGetQueryData(t.operate,t.taskid,a);else if("running"===e.status){var s=0;s=e.progress?Math.min(Math.max(parseInt(e.progress,10),0),100):l.getTaskProcess(e.taskid),l.setTaskProcess(e.taskid,s),r.tiping||l.showProcessTips("正在"+l.getOperateName(t.operate),s),l.startGetQueryData(t.operate,t.taskid,a)}else"success"===e.status&&(o&&o.removeItem&&o.removeItem(l.getTaskKey()),l.showSuccTips("文件"+l.getOperateName(t.operate)+"成功"),"restore"===t.operate&&(e=l.taskMap.ignoreList),l.callTaskOverCallBack(1,l.getLastCallback(),e,a,t))},l.processFailCall=function(e,a,t){e.flagNetErrorProcess=1,l.doFailCall(e,a,t)},l.getData=function(e,a,t,r){if(t||(t=l.doSuccessCall),r||(r=l.doFailCall),"restore"===e||"deleteRecycle"===e)l.getRestoreAndDeleteData(e,a,t,r);else if("clearRecycle"===e)l.getClearRecycleData(e,a,t,r);else{var s={},o=1;s.operate=e,s.callback=a.callback,s.list=a.list,delete a.callback,delete a.list,a.async&&(o=a.async,s.async=o,delete a.async);var i="";a.removeNest||(i="&onnest=fail"),o=2,l.fetchData("/api/filemanager?opera="+e+"&async="+o+i,a,t,r,s)}},l.getRestoreAndDeleteData=function(e,a,t,r){var s=a.fidlist?{fidlist:a.fidlist}:{filelist:a.filelist},o=a;o.operate=e;var i=a.url+"&async="+a.async;l.fetchData(i,s,t,r,o)},l.getClearRecycleData=function(e,a,t,r){var s=a;s.operate=e;var o=a.url+"&async="+a.async;l.fetchData(o,null,t,r,s)},l.startGetQueryData=function(e,a,t){setTimeout(function(){l.getQueryData(e,a,t)},l.QUERY_TIMEER)},l.getQueryData=function(e,a,t){var r={};r.operate=e,r.taskid=a,r.callback=l.getLastCallback(),l.fetchData("/share/taskquery?taskid="+a,t,l.processSuccCall,l.processFailCall,r)},l.fetchData=function(e,a,t,r,o){s.post(e,a,function(n,l,c){if(n&&0===n.errno){t(n,a,o);var p=/taskid=(\d+)&*/i;i.log.send({type:"async",op:"async",action:o.operate,url:"//update.pan.baidu.com/statistics",product:"pan",success:1,taskid:n.taskid||(p.test(e)?e.match(p)[1]:0),ajaxerrno:n.errno,ajaxerrmsg:i.errorMsg(n.errno),ajaxstatus:c.status||0,ajaxurl:encodeURIComponent(e),ajaxparam:s.stringify(a),ajaxdata:s.stringify(n),file:a?s.stringify(a.filelist):""})}else if(132===n.errno)r(n,a,o);else{r(n,a,o);var p=/taskid=(\d+)&*/i;i.log.send({type:"async",op:"async",action:o.operate,url:"//update.pan.baidu.com/statistics",product:"pan",success:0,taskid:n.taskid||(p.test(e)?e.match(p)[1]:0),ajaxerrno:n.errno,ajaxerrmsg:i.errorMsg(n.errno,"未知错误"),ajaxstatus:c.status||0,ajaxurl:encodeURIComponent(e),ajaxparam:s.stringify(a),ajaxdata:s.stringify(n),file:a?s.stringify(a.filelist):""})}},"json").error(function(t,n,l){var c;try{c=s.parseJSON(t.responseText)}catch(p){}c||(c={}),c.flagNetError=1,r(c,a,o);var d=/taskid=(\d+)&*/i;i.log.send({type:"async",op:"async",action:o.operate,url:"//update.pan.baidu.com/statistics",product:"pan",success:0,taskid:c.taskid||(d.test(e)?e.match(d)[1]:0),ajaxerrno:c.errno||31021,ajaxerrmsg:i.errorMsg(c.errno||31021),ajaxstatus:l.status||0,ajaxurl:encodeURIComponent(e),ajaxparam:s.stringify(a),ajaxdata:s.stringify(c),file:a?s.stringify(a.filelist):""})})},l.hideTips=function(){i.ui.hideTip()},l.showSuccTips=function(e){i.ui.tip({mode:"success",msg:e})},l.showErrorTips=function(e){i.ui.tip({mode:"caution",msg:e})},l.showLoadingTips=function(e){i.ui.tip({mode:"loading",msg:e,autoClose:!1})},l.showProcessTips=function(e,a){var t='<span class="asyn-tip-process" style="float: right;width: 180px;height: 5px;background: #1b71f0;margin: 17px 0 0 17px;border-radius: 4px;overflow: hidden;"><span class="asyn-tip-process-inner" style="float: left;display: inline-block;background: #fff;height: 5px;font-size: 0;width:'+a+'%"></span></span>';i.ui.tip({mode:"none",msg:'<span style="float: left;">'+e+a+"%</span>"+t,autoClose:!1,hasClose:!1})},l.showErrorCloseTips=function(e){return e?void i.ui.tip({mode:"caution",msg:e,autoClose:!1,hasClose:!0}):void i.ui.hideTip()},l.taskMap={},l.setTaskProcess=function(e,a){var t=l.taskMap[e];t||(t={},l.taskMap[e]=t),t.process=a},l.getTaskProcess=function(e){var a=l.taskMap[e],t=0;return a&&(t=a.process||0),t},l.getLastCallback=function(){var e=l.taskMap;return e.otherParams&&e.otherParams.callback?e.otherParams.callback:null},l.getOperateName=function(e){var a=l.taskMap,t="操作";switch(e||a.otherParams&&a.otherParams.operate&&(e=a.otherParams.operate),e){case"copy":t="复制";break;case"move":t="移动";break;case"delete":t="删除";break;case"transfer":t="转存";break;case"rename":t="重命名";break;case"restore":t="还原"}return t},l.addTaskObj=function(e,a,t,r,s,o,i){var n=l.taskMap;n.currentTypeIndex=e||0,n.currentIndex=a||0,n.defaultList=t,n.repeatFileList=r,n.repeatFolderList=s;var c=n.notFoundList;c instanceof Array||(c=[],n.notFoundList=c),Array.prototype.push.apply(c,o);var p=n.otherList;p instanceof Array||(p=[],n.otherList=p),Array.prototype.push.apply(p,i)},l.hasNext=function(){var e,a=l.taskMap,t=a.currentTypeIndex,r=a.currentIndex;if(0===t)e=a.repeatFileList;else{if(1!==t)return!1;e=a.repeatFolderList}return r>=e.length?(a.currentTypeIndex++,a.currentIndex=0,0===t&&a.repeatFolderList.length>0?!0:!1):!0},l.doNext=function(){if(l.hasNext()){var e,a,t=l.taskMap,r=t.currentTypeIndex,s=t.currentIndex;0===r?(e=t.repeatFileList,a=0):(e=t.repeatFolderList,a=1),l.showAsynViewItem(e[t.currentIndex++],e.length-s-1,a)}else l.doAllDone()},l.doNextAll=function(e){for(var a,t=l.taskMap,r=t.currentTypeIndex,s=t.currentIndex,o=0===r?t.repeatFileList:t.repeatFolderList,i=s,n=o.length;n>i;i++)a=o[i],a.from_meta.isdir&&"overwrite"===e?a.ignore=1:a.ondup=e;t.currentIndex=o.length,0===r?l.doNext():l.doAllDone()},l.doRetryTask=function(){i.ui.tip({mode:"loading",msg:"正在"+l.getOperateName()+"文件，请稍候&hellip;",autoClose:!1});var e=l.taskMap;l.doCommonDone(e,e.otherList,l.getLastCallback()),e.otherList=[]},l.doRetryDeleteTask=function(){i.ui.tip({mode:"loading",msg:"正在"+l.getOperateName()+"文件，请稍候&hellip;",autoClose:!1});for(var e=l.taskMap,a=e.otherParams,t=e.otherList,r=[],o={},n=0,c=t.length;c>n;n++)r.push(t[n].path);e.otherList=[],o.list=r,o.filelist=s.stringify(r),o.async=2,o.callback=a.callback,l.getData(a.operate,o)},l.doNetErrorRetryTask=function(e,a,t,r){i.ui.tip({mode:"loading",msg:"正在"+l.getOperateName()+"文件，请稍候&hellip;",autoClose:!1}),t.async=r.async,"restore"===a?t.url=r.url:(t.list=r.list,delete t.fidlist),t.callback=r.callback,l.getData(a,t)},l.doAllDone=function(){var e=l.taskMap,a=e.defaultList,t=e.repeatFileList,r=e.repeatFolderList,s=[],o=(e.otherParams,l.getLastCallback());Array.prototype.push.apply(s,a),Array.prototype.push.apply(s,t),Array.prototype.push.apply(s,r),l.doCommonDone(e,s,o)},l.doCommonDone=function(e,a,t){i.ui.tip({mode:"loading",msg:"正在"+l.getOperateName()+"文件，请稍候&hellip;",autoClose:!1});for(var r,n,c=e.otherParams,p=[],d={},f=[],u=[],g=0,m=a.length;m>g;g++)r=a[g],r.ignore?f.push(r.from):(n=l.getDirFromPath(r.to),n="/"===n?"":n,p.push({path:r.from,dest:n,newname:l.getFileNameByPath(r.from),ondup:r.ondup||"fail"}),"restore"===c.operate&&r.fs_id&&u.push({fid:r.fs_id,ondup:r.ondup||"fail"}));if(l.taskMap.ignoreList=f,p.length>0)d.async=2,d.callback=c.callback,"restore"===c.operate?(d.url=c.url,d.filelist=s.stringify(u)):(d.filelist=s.stringify(p),d.list=p),l.getData(c.operate,d);else{o&&o.removeItem&&o.removeItem(l.getTaskKey());var h=e.repeatFileList.length+e.repeatFolderList.length;e.ignoreList.length<h?l.showSuccTips("文件"+l.getOperateName()+"成功"):l.hideTips(),l.callTaskOverCallBack(1,t,e.result,e.params,e.otherParams)}},l.doAllNotFound=function(){var e=l.taskMap,a=e.notFoundList;return a instanceof Array&&a.length>0?(l.showOtherErrorAsynView("notfound",a,e.otherParams.operate,e.params,e.otherParams),e.notFoundList=[],!0):!1},l.doAllFail=function(){var e=l.taskMap,a=e.otherList;return a instanceof Array&&a.length>0?(l.showOtherErrorAsynView("fail",a,e.otherParams.operate,e.params,l.getLastCallback()),!0):!1},l.showDeleteAsynView=function(e,a,t){if(!e.list||e.list.length<=0)return delete e.errno,void l.doFailCall(e,a,t);for(var r,s=e.list,o=[],i=[],n=0,c=s.length;c>n;n++)r=s[n],r.from=r.path,-9===r.error_code?o.push(r):i.push(r);l.addTaskObj(0,0,[],[],[],o,i),l.doNext()},l.showRenameAsynView=function(e,a,t){if(12===e.errno||-8===e.errno||-30===e.task_errno){var r={title:"提示",contentTitle:"此目录下已存在同名文件，是否要保存两个文件",okText:"保留两个文件",cancelText:"取消",okCall:function(){a.ondup="newcopy",a.callback=t.callback,a.async=2,l.getData("rename",a,null,l.doRenameFailCall)},cancelCall:function(){var r=l.taskMap;r.otherParams=t,r.result=e,r.params=a,l.callTaskOverCallBack(2,l.getLastCallback(),e,a,t)}};l.hideTips(),n.showException(r)}else delete e.errno,l.doFailCall(e,a,t)},l.showAsynView=function(e,a,t){if(!e.list||e.list.length<=0)return delete e.errno,void l.doFailCall(e,a,t);var r,s=e.list,o=[],i=[],n=[],c=[],p=[];if(s instanceof Object){for(var d=0,f=s.length;f>d;d++)r=s[d],-8===r.error_code?r.from_meta&&r.to_meta&&(r.from_meta.isdir&&r.to_meta.isdir?n.push(r):r.from_meta.isdir||r.to_meta.isdir?(r.ondup="newcopy",o.push(r)):i.push(r)):-9===r.error_code?c.push(r):p.push(r);l.addTaskObj(0,0,o,i,n,c,p),l.doNext()}},l.showOtherErrorAsynView=function(e,a,t,r,s){var o={};if(o.title="提示","restore"===s.operate)for(var i=this.data.selectedFiles,c=0;c<i.length;c++)for(var p=i[c],d=0;d<a.length;d++){var f=a[d];p.fs_id===f.fs_id&&(f.from=p.server_filename,f.to=p.server_filename,f.isdir=p.isdir)}("fail"===e||"failnet"===e)&&(o.contentTitle='网络异常，<span class="asyn-red">'+a.length+"</span>个文件"+l.getOperateName(t)+"失败，是否重试？",o.okText="重试",o.cancelText="取消"),"fail"===e?(o.okCall="delete"===t?function(){l.doRetryDeleteTask()}:function(){l.doRetryTask()},o.cancelCall=function(){l.taskMap.otherList=[],l.callTaskOverCallBack(1,l.getLastCallback())}):"failnet"===e?(o.okCall=function(){l.doNetErrorRetryTask(a,t,r,s)},o.cancelCall=function(){}):(o.cancelText="我知道了",o.contentTitle='有<span class="asyn-red">'+a.length+"</span>个文件的源文件找不到了，操作未完成",o.cancelCall=function(){l.callTaskOverCallBack(1,l.getLastCallback())}),o.flagRepeat=!1,o.errorList=a,n.showException(o)},l.showAsynViewItem=function(e,a,t){var r=e.from_meta,s=(e.to_meta,{}),o=t?"夹":"",i=l.getOperateName();if(s.title=i+"文件",s.contentTitle=i+"的位置已经包含了同名的文件"+o+"，请选择你的操作：",s.plusText=r.isdir?"跳过":"替换文件",s.plusCall=function(a){r.isdir&&(e.ignore=1),e.ondup="overwrite",a?l.doNextAll(e.ondup):l.doNext()},s.okCall=function(a){e.ondup="newcopy",a?l.doNextAll(e.ondup):l.doNext()},s.cancelCall=function(){var e=l.taskMap,a=e.otherParams,t=e.result,r=e.params;l.callTaskOverCallBack(2,l.getLastCallback(),t,r,a)},s.okText="保留两个文件"+o,s.cancelText="取消",a>0&&(s.checkboxMsg='为其余的<span class="asyn-red">'+a+"</span>个重名文件"+o+"都执行此操作"),s.flagRepeat=!0,s.repeatToMsg="已有文件"+o+"：",s.repeatFrmMsg="正在"+i+"的文件"+o+"：","还原"===i&&this.data.selectedFiles)for(var c=this.data.selectedFiles,p=0;p<c.length;p++){var d=c[p];d.fs_id===e.fs_id&&(e.from=d.path,e.to=d.path)}s.errorList=e,n.showException(s)},l.callTaskOverCallBack=function(e,a,t,r,s){return l.doAllFail()?void l.hideTips():(l.doAllNotFound()&&l.hideTips(),"function"==typeof a&&a.call(null,e,t,r,s,l.taskMap.ignoreList),void((1===e||2===e||3===e)&&o&&o.removeItem&&o.removeItem(l.getTaskKey())))},l.getTaskKey=function(){return"asynfilemanager_"+(yunData.MYNAME||"").replace(/@/g,"")},t.exports=r});
;define("disk-system:widget/system/fileService/fileManagerApi/fileManagerApi.js",function(e,r,t){var a=e("base:widget/libs/jquerypacket.js"),i=e("system-core:context/context.js").instanceForSystem,n=i.message,s=i.pluginControl.BrokerData,o=e("disk-system:widget/system/fileService/asynFileManager/asynFileManager.js"),l={FILE_NAME_REG:/[\\\/:*?'<>|]/i,KEYWORDS_REG:function(){var e=s.getAllData().button,r=["共享给我的文件夹","我的卡包"];for(var t in e)if(e.hasOwnProperty(t))for(var a=e[t],i=0;i<a.length;i++){var n=a[i].excludeDirType;if(n)for(var o=n.split(","),l=0;l<o.length;l++)r.indexOf(o[l])<0&&r.push(o[l])}return new RegExp("^"+r.join("|")+"$")}(),resolveFileName:function(e){var r="";if(0===e.indexOf("/")&&(e=e.slice(1)),l.FILE_NAME_REG.test(e)?r="文件名不能包含以下字符：<,>,|,*,?,,/":l.KEYWORDS_REG.test(e)&&(r="文件名含有关键字，换一个试试吧！"),!r)if(e.length>0){for(var t=0,a=0;t<e.length;t++)e.charCodeAt(t)<128?a++:a+=2;a>255&&(r="文件(夹)名称长度不能超过255字节")}else r="文件(夹)名称不能为空，请输入文件名称";return r},resolveNewName:function(e,r,t){return t?e.substring(0,e.lastIndexOf("/"))+"/"+r:r}},c={COPY:"copy",MOVE:"move",DELETE:"delete",UPLOAD:"upload",createDirFlag:!1,sendFileMoveCopyApi:function(e,r,t,n,s){for(var o,l,c=[],f=null,g=0,p=r.length;p>g;g++)f=r[g].path,o=i.tools.baseService.parseDirPath(f),l=i.tools.baseService.parseDirFromPath(f),c.push({path:o,dest:t,newname:l});a.post("/api/filemanager?channel=chunlei&clienttype=0&web=1&opera="+e,{filelist:a.stringify(c)},n,"json").error(s)},sendCreateNewFileApi:function(e,r,t,n,s,o){var c,f,g=i.tools.baseService.parseDirFromPath(e),p="";if(l.FILE_NAME_REG.test(g))return p="文件名不能包含以下字符：<,>,|,*,?,,/",o(p),!1;if(g.length>0){for(f=0,c=0;f<g.length;f++)g.charCodeAt(f)<128?c++:c+=2;c>255&&(p="文件(夹)名称长度不能超过255字节",o(p))}else p="文件(夹)名称不能为空，请输入文件名称",o(p);p||a.post("/api/create?a=commit",{path:e,isdir:t,size:r,block_list:n?'["'+n+'"]':"[]",method:"post"},s)},createNewDir:function(e,r,t){var n=this;if(!n.createDirFlag){n.createDirFlag=!0;var s=l.resolveFileName(t);return s?(r(1,s),n.createDirFlag=!1):void a.post("/api/create?a=commit",{path:e,isdir:1,block_list:"[]"},function(e){e&&0==e.errno?r(0,"创建文件夹成功",e):(s=i.errorMsg(e.errno,"发生未知错误，请稍后重试"),r(1,s,e))},"json").fail(function(e){var t;try{t=a.parseJSON(e.responseText)}catch(n){}t=t||{},s=i.errorMsg(t.errno,"发生未知错误，请稍后重试"),r(1,s,t)}).always(function(){n.createDirFlag=!1})}},deleteFiles:function(e,r,t){var a=t?o.deleteFileSync:o.deleteFiles;a.call(null,e,function(e,t){if(1===e)n.trigger("quota-change"),r(0,"删除成功",t);else{var a=i.errorMsg(t.errno,"发生未知错误，请稍后重试");r(132===e?132:1,a,t||{})}})},reName:function(e,r,t){var a=this;if(!a.createDirFlag){a.createDirFlag=!0;var n=l.resolveFileName(t);if(n)r(1,n),a.createDirFlag=!1;else{var s=l.resolveNewName(e,t);o.rename(e,s,function(e,t){1===e||2===e?(t.status=e,r(0,"重命名成功",t)):(n=-8===t.errno||-9===t.errno?"名称已在使用，请使用其他名称":i.errorMsg(t.errno,"重命名失败，请稍候重试"),r(1,n,t)),a.createDirFlag=!1})}}}};t.exports=c});
;define("disk-system:widget/system/fileService/fileRecycle/fileRecycle.js",function(e,i,s){var c=e("base:widget/libs/jquerypacket.js"),n=e("base:widget/libs/underscore.js"),t=e("disk-system:widget/system/fileService/asynFileManager/asynFileManager.js"),r=e("system-core:context/context.js").instanceForSystem,a={api:{clear:"/api/recycle/clear?channel=chunlei&clienttype=0&web=1","delete":"/api/recycle/delete?channel=chunlei&clienttype=0&web=1"},forceVerifyConfirm:function(e,i){i===!0?this.clearFiles(e.callback):this.deleteFiles(e)},reportUser:function(e){c.getJSON("/api/report/user?action=sapi_auth",function(i){c.isFunction(e)&&e(i)})},clearFiles:function(i){var s={url:"/api/recycle/clear?channel=chunlei&clienttype=0&web=1",async:1,callback:function(s,c,n,t,l){2!==s&&3!==s&&132!==s?(r.ui.tip({hasClose:!1,autoClose:!1,mode:"success",msg:"回收站已清空"}),"function"==typeof i&&i(l)):132===s&&e.async("base:widget/passAPI/passAPI.js",function(e){e.promiseForceverify.done(function(){e.passAPI.PassportForceInit.netdiskForceVerify(),e.passAPI.PassForceverify.onSubmitFailure=function(){},e.passAPI.PassForceverify.onSubmitSuccess=function(){a.reportUser(function(e){e&&0===e.errno&&a.forceVerifyConfirm({callback:i},!0)})}})})}};t.clearRecycle(s)},hideTips:function(){r.ui.hideTip()},deleteFiles:function(i){var s=i.list,c=i.callback,l="["+n.map(s,function(e){return e.fs_id})+"]";t.deleteRecycle({url:"/api/recycle/delete?channel=chunlei&clienttype=0&web=1",async:1,fidlist:l,selectedFiles:s,callback:function(i,n,t,l,o){2!==i&&3!==i&&132!==i?(r.ui.tip({hasClose:!1,autoClose:!1,mode:"success",msg:"文件已经彻底删除"}),"function"==typeof c&&c(o)):132===i&&(a.hideTips(),e.async("base:widget/passAPI/passAPI.js",function(e){e.promiseForceverify.done(function(){e.passAPI.PassportForceInit.netdiskForceVerify(),e.passAPI.PassForceverify.onSubmitFailure=function(){},e.passAPI.PassForceverify.onSubmitSuccess=function(){a.reportUser(function(e){e&&0===e.errno&&a.forceVerifyConfirm({list:s,callback:c},!1)})}})}))}})},restore:function(e){var i=e.list,s=e.callback,c=i.length,a=10>c?1:2,l="["+n.map(i,function(e){return e.fs_id})+"]";t.restore({url:"/api/recycle/restore?channel=chunlei&clienttype=0&web=1",async:a,fidlist:l,selectedFiles:i,callback:function(e,i,c,n,t){"function"==typeof s&&2!==e&&3!==e&&(s(t),r.message.trigger("system-refresh",{flagChangeSuffix:!1,path:"/"}))}})}};s.exports=a});
;define("disk-system:widget/system/fileService/fileMoveCopy/fileMoveCopy.js",function(e,t,i){function r(){return r.instance?r.instance:(r.instance=this,o.call(this),this.canNotMoveMap={"/apps":!0},void(this.textMappings={copy:"复制到",move:"移动到"}))}var s=e("base:widget/storage/storage.js"),a=e("base:widget/tools/service/tools.util.js"),o=e("base:widget/tools/service/tools.event.js").EventEmitter,n=e("system-core:context/context.js").instanceForSystem,c=e("disk-system:widget/system/fileService/asynFileManager/asynFileManager.js"),p=n.message,u=n.router,l=n.tools.shareDirManager,h=0;r.getInstance=function(){return new r},a.inherits(r,o),r.prototype.getTransferFiles=function(e,t){for(var i,r,s,a,o="sharedir"===u.currentRouteName,c=[],p=!1,h=0;h<e.length;h++)if(i=e[h],r=i.path,s=n.tools.baseService.parseFullDirFromPath(r)||"/",a=1===parseInt(i.isdir,10),p=o&&l.checkIsShareDirByPath(r),p&&(s=("/shareHolder"+s).replace(/\/$/,"")),a&&t!==r&&s!==t&&0!==(t+"/").indexOf(r+"/")||!a&&s!==t)c.push({path:r,dest:t,newname:p?i.server_filename:n.tools.baseService.parseDirFromPath(r)});else if(a)return[];return c},r.prototype.transfer=function(e,t,i){var r=this;if(t.length<=0)return n.ui.tip({mode:"caution",msg:"不能将文件"+r.textMappings[e]+"自身或其子目录下"}),!1;var s=c[e+"Files"];s(t,i,function(s,a,o,n,c){1===s?(p.trigger("quota-change"),r.emit("success",e,t,i,c)):r.emit("fail",e,t,i)})},r.prototype.showDialog=function(e,t){var i="move"===t,r="copy"===t,s=this;if(i||r){var a="",o=e[0].path,c=l.checkIsShareDirByPath(o);i&&c&&(a=l.getRootSharePath(o));var p=this.textMappings[t];n.ui.treeDialog({title:p,confirm:function(i){n.ui.treeDialog(!1);var r=s.isNotMoveByPaths(i);if(r)return n.ui.tip({mode:"caution",msg:"无法将文件"+p+"预置文件夹"}),void s.emit("fail",t,i);var a=s.getTransferFiles(e,i);s.transfer(t,a,i)},showShareDir:r&&!c,path:a})}},r.prototype.moveTo=function(e,t){var i=this.getTransferFiles(e,t);this.transfer("move",i,t)},r.prototype.isNotMoveByPaths=function(e){for(var t=0,i=e.length;i>t;t++)if(this.canNotMoveMap[e[t].path])return!0;return!1},r.prototype.manageStatus=function(){var e=!!s.getItem("asynfilemanager_"+(yunData.MYNAME||"").replace(/@/g,""));return e?(h&&clearTimeout(h),c.tiping=!0,h=setTimeout(function(){c.tiping=!1},2e3),n.ui.tip({mode:"caution",msg:"当前还有未完成的任务，需完成后才能操作"}),!0):!1},r.prototype.resolveHasTask=function(e,t,i){c.resolveHasTask(e,t,i)},i.exports=r});
;define("disk-system:widget/system/fileService/fileDelete/fileDelete.js",function(e,t,i){function n(e,t){var i=a.ui.confirm({title:"确认删除",width:"460px",body:t||u.getTip(e),extra:f.getExtra(),onSure:function(){i.hide(),u.doDelete(u.conf.paths,u.conf.callback,u.conf.sync)},onCancel:function(){i.hide()}});i.topShow()}var r=e("base:widget/libs/jquerypacket.js"),s=e("disk-system:widget/system/fileService/fileManagerApi/fileManagerApi.js"),a=e("system-core:context/context.js").instanceForSystem,o=a.router,c={"/apps":!0},u={conf:{},defaultFunc:function(){},getPartFileTipByPath:function(e){var t="",i="你选择的文件包含第三方应用文件，";return e+="/",-1!==e.indexOf("/apps/联通冲印/")?t=i+"删除后将导致联通冲印服务读取数据异常":-1!==e.indexOf("/apps/album/")?t="你选择的文件包含百度相册中的文件，删除后百度相册中的文件也将同步删除":-1!==e.indexOf("/我的分享/")?t="该文件已经分享给你的朋友们了，删除后将无法再被查看":-1!==e.indexOf("/apps/")&&(t=i+"删除后该应用中的文件也将同步被删除"),t},getPartFileTipByPaths:function(e){for(var t="",i=0,n=e.length;n>i&&!(t=u.getPartFileTipByPath(e[i]));i++);return t},getTip:function(e){var t=u.getPartFileTipByPaths(e),i="";return i=t?t+"<br/>是否继续？":"确认要把所选文件放入回收站吗？<br/>",i+f.middleText},isNotDeleteByPaths:function(e){for(var t=!1,i=0,n=e.length;n>i;i++)if(c[e[i]]){t=!0;break}return t},reportUser:function(e){r.getJSON("/api/report/user?action=sapi_auth",function(t){r.isFunction(e)&&e(t)})},doDelete:function(t,i,n){var r=this;s.deleteFiles(t,function(t,n,s){0===t?(a.ui.tip({mode:"success",msg:n}),i.call(null,0,n,s)):132===t?(a.ui.tip({mode:"caution",msg:n}),e.async("base:widget/passAPI/passAPI.js",function(e){e.promiseForceverify.done(function(){e.passAPI.PassportForceInit.netdiskForceVerify(),e.passAPI.PassForceverify.onSubmitFailure=function(){},e.passAPI.PassForceverify.onSubmitSuccess=function(){r.reportUser(function(e){e&&0===e.errno?setTimeout(function(){u.doDelete(u.conf.paths,u.conf.callback,u.conf.sync)},300):a.ui.tip({mode:"caution",msg:"验证失败，请稍后重试！"})})}})})):i(1,n,s)},n)}},f={middleText:"",extra:"<div class='dialog-extra-body'><button onclick='javascript:window.open(\"/buy/center?tag=8&form=deletefile\",\"_blank\");' class='extra-button' title='立即开通'>立即开通</button><em class='extra-picture'></em>开通超级会员，立享回收站文件30天保存期限</div>",memberStatus:[10,15,30],MemberType:{NOT_MEMBER:0,ORDINARY_MEMBER:1,SUPER_MEMBER:2},isSuperMember:!1,getMemberLevel:function(){return"1"===String(window.yunData.ISSVIP)?this.MemberType.SUPER_MEMBER:window.yunData.ISVIP||0},init:function(){var e=this.getMemberLevel(),t=this.memberStatus[e];this.middleText="删除的文件可在"+t+"天内通过回收站还原",this.isSuperMember=this.getMemberLevel()===this.MemberType.SUPER_MEMBER},getExtra:function(){return this.isSuperMember||u.conf.isInShare?"":this.extra}};f.init(),i.exports.deleteFiles=function(e,t,i){u.conf.isInShare="sharedir"===o.currentRouteName;for(var r,s=[],c=!1,f=!1,l=!1,p=0,d=e.length;d>p;p++){if(r=e[p],u.conf.isInShare)if(r.oper_id&&r.oper_id!==yunData.MYUK){if(!l&&(l=!!r.isdir),!f&&(f=!r.isdir),!r.isdir)continue}else!c&&(c=!0);else 1===r.share&&!c&&(c=!0);s.push(r.path)}u.conf.paths=s,u.conf.callback=t,u.conf.sync=i;var m="",h=u.isNotDeleteByPaths(s);if(h)return m="预置文件不可以删除",a.ui.tip({mode:"caution",msg:m}),void t.call(null,1,m);var b="";if(u.conf.isInShare)if(f){if(!s.length)return void a.ui.alert("此文件为他人创建，只有创建者和目录所属者可删除");b="所选文件中包含他人创建文件，无法删除，<br/>是否只删除自己上传的文件?"}else l&&(b="所选文件中包含他人创建文件，无法删除，<br/>是否只删除自己上传的文件?");!b&&c&&(b="确认删除所选文件吗?<br/>删除后他人将无法查看和管理"),n(s,b)},i.exports.canDelete=function(e){return!e instanceof Array&&(e=[e]),u.isNotDeleteByPaths(e)}});
;define("disk-system:widget/system/fileService/createNewDir/createNewDir.js",function(e,t,i){function s(e){return s.instance?s.instance:(s.instance=this,o.EventEmitter.call(this),this.$container=e?n(e):a.getList().$container,this.canNotRenameMap={"/apps":!0},this.path="",this.blocking=!1,this.parentPath="",this.filename="",this.$newDirDom=this.initDom(),this.$box=this.$newDirDom.find(".GadHyA"),void this.bindEvent())}var n=e("base:widget/libs/jquerypacket.js"),o=e("base:widget/tools/tools.js"),a=e("system-core:context/context.js").instanceForSystem,r=e("system-core:system/uiService/tip/tip.js"),c=e("disk-system:widget/system/fileService/fileManagerApi/fileManagerApi.js");s.getInstance=function(){return new s},o.inherits(s,o.EventEmitter),s.prototype.isNotRenameByPaths=function(e){return!!this.canNotRenameMap[e]},s.prototype.flagExists=function(){return"block"===this.$newDirDom.css("display")},s.prototype.isTypeList=function(){return"block"===this.$container.find(".zJMtAEb").css("display")},s.prototype.focus=function(e){e&&this.$box.val(n.trim(e));var t=n.trim(this.$box.val()),i=t.lastIndexOf(".");0>=i&&(i=t.length),a.ui.Selection.setSelectionRange(this.$box[0],0,i)},s.prototype.initDom=function(){var e='<div class="ExFGye"><div class="nlkw0V4a"><input node-type="kqrp8eK6" class="GadHyA" type="text" value="" /><span node-type="ylaw0VGa" class="yuajvbQ"><em class="icon adzkjD76">&#xe908;</em><em class="icon ngyh0p5B">&#xe937;</em></span><span node-type="jdj8kvR" class="ie8Pgk"><em class="icon adzkjD76">&#xe908;</em><em class="icon hegqzLWk">&#xe93a;</em></span></div></div>';return this.$container.append(e),this.$container.find(".ExFGye")},s.prototype.bindEvent=function(){var e=this;this.$newDirDom.delegate("span","click",function(){var t=n(this);return t.hasClass("yuajvbQ")?e.sure():t.hasClass("ie8Pgk")&&e.cancel(),!1}).delegate(".GadHyA","keydown",function(t){13===t.keyCode?e.sure():27===t.keyCode&&e.cancel()})},s.prototype.cancel=function(){this.blocking=!1,this.emit("cancel"),this.hide()},s.prototype.sure=function(){if(this.rename){if(this.filename===n.trim(this.$box.val()))return void this.cancel();this.sendNewDir(this.path,n.trim(this.$box.val()))}else{var e=("/"===this.parentPath?"":this.parentPath)+"/"+n.trim(this.$box.val());this.sendNewDir(e,n.trim(this.$box.val()))}},s.prototype.sendSuccess=function(e,t){this.blocking=!1,this.emit("success",e,t),this.hide(t)},s.prototype.sendNewDir=function(e,t){r.show({mode:"loading",msg:this.rename?"正在重命名，请稍候&hellip;":"正在创建文件夹，请稍候&hellip;",autoClose:!1});var i=this;c[this.rename?"reName":"createNewDir"](e,function(e,s,n){if(1===e)r.show({mode:"caution",msg:s}),i.focus();else{if(2!==n.status&&r.show({mode:"success",msg:s}),i.rename){var a=n.list&&n.list[0]||n.info&&n.info[0],c=(2===n.status?a.from:a.to)||a.path||t;t=o.getFileNameByPath(c)}i.sendSuccess(t,n)}},t)},s.prototype.show=function(e){return this.blocking&&r.show({mode:"caution",msg:"请先取消当前正在进行的新建文件夹或重命名操作"}),e.rename&&this.isNotRenameByPaths(this.path)?(r.show({mode:"caution",msg:"预置文件不可以重命名"}),this.emit("cancel"),!1):(this.path=e.path,this.rename=e.rename,this.parentPath=o.parseFullDirFromPath(this.path),this.filename=o.parseDirFromPath(this.path),this.viewClassName=e.viewClassName,this.$newDirDom.addClass(this.viewClassName),this.cacheMod=e.cacheMod,e.position&&this.$newDirDom.css(e.position),this.rename?("searchGlobal"===this.cacheMod?this.$newDirDom.addClass("tvlz02aA"):this.$newDirDom.removeClass("tvlz02aA"),this.$container.addClass("rdac0oa5")):this.$container.removeClass("rdac0oa5"),this.$newDirDom.show(),this.focus(this.filename),this.blocking=!0,!0)},s.prototype.hide=function(e){if(this.viewClassName&&this.$newDirDom.removeClass(this.viewClassName),this.$newDirDom.removeClass("tvlz02aA"),e&&!this.rename){var t=a.getList().cache.getKey(),i=e.path.substring(e.path.lastIndexOf("/")+1),s="-"===e.mtime?e.mtime:o.parseDate(e.mtime),n=a.tools.topMountManager.getLengthByKey(t);this.$newDirDomNode=this.isTypeList()?this.$container.find('dd[_position="'+n+'"]'):this.$container.find('.cEefyz[_position="0"]').eq(n),this.$newDirDomNode.find(".xlytjQoP").attr("title",i).text(i),this.$newDirDomNode.find(".avv0n1A").text(s),delete this.$newDirDomNode}this.$newDirDom.hide()},s.prototype.isBlocking=function(){return this.blocking},i.exports=s});
;define("disk-system:widget/system/util/cacheUtil.js",function(e,t,a){function h(){}var c=e("system-core:system/cache/listCache/cacheManage.js"),r={getCache:function(){return c.getCache()},deleteCacheByMode:function(e,t,a){var c=t.getDataByKey();this.removeCacheAll();for(var i=c&&c.list,o=!1,s="",n="",v=i.length,C=v-1;C>=0;C--){for(var l=a.length,m=l-1;m>=0;m--)s=a[m],n=s.path||s,i[C].path==n&&(a.splice(m,1),o=!0);o&&(i.splice(C,1),o=!1)}return c.list=i,r.getCache()[t.cacheName].data[t.getKey()]=c,h(),c},removeCacheByPath:function(e){var t=this.getCache(),a={};t&&t.list&&t.list.data&&(a=t.list.data),a[e]&&delete a[e],this.removeOtherListCache(),h()},removeCacheAll:function(){var e=this.getCache();for(var t in e)e.hasOwnProperty(t)&&e[t]&&e[t].data&&(e[t].data={});h()},removeCache:function(e,t,a){var c=this.getCache(),r={};c&&c.list&&c.list.data&&(r=c.list.data),this.removeSubFiles(r,e),"move"===t&&this.removeSubFiles(r,a),this.removeOtherListCache(),h()},removeSubFiles:function(e,t){t="/"===t?t:t+"/";for(var a in e)e.hasOwnProperty(a)&&0===(a+"/").indexOf(t)&&delete e[a];h()},removeOtherListCache:function(){this.removeCategoryCache(),this.removeSearchCache(),this.removeTreeCache(),h()},removeCategoryCache:function(){this.removeCacheByKey("category"),h()},removeSearchCache:function(){this.removeCacheByKey("search"),h()},removeTreeCache:function(){this.removeCacheByKey("tree"),h()},removeCacheByKey:function(e){var t=this.getCache();t&&t[e]&&t[e].data&&(t[e].data={}),h()},replaceSingleCache:function(e,t,a,h){c.replaceSingleCache(e,t,a,h)}};a.exports=r});
;define("disk-system:widget/router/view/base/PageView.js",function(e,t,r){function i(e,t){s.isFunction(t)&&(t=t()),this.systemList=t||a.getList(),this.type=e,e&&(this.cache=new n(e,this.getCacheConfig(),""))}var s=e("base:widget/libs/underscore.js"),o=e("base:widget/tools/service/tools.util.js"),n=e("system-core:system/cache/listCache/cacheManage.js"),a=e("system-core:context/context.js").instanceForSystem,c=a.router,d=a.message;i.createView=function(e){function t(){i.call(this,n,a)}var r=this,n=e.type,a=e.list;return e=s.omit(e,["type","list"]),t.app=null,t.getInstance=function(){return t.app||(t.app=new t)},o.inherits(t,r),s.extend(t.prototype,e),t.createSubView=i.createView,t},i.prototype.isView=!0,i.prototype.getHeaderConfig=function(){var e,t,r=this.systemList.onListOrderChange();r&&(e=r.item,t="number"==typeof r.desc?r.desc:1);var i=c.query.get("path");return[{order:e||"time",desc:void 0!==t?t:1,operateOrderKey:function(){},columns:[{name:"文件名",key:"name",checkbox:!0,width:60},{name:"大小",key:"size",width:16},{name:"修改日期",key:"time",width:23}],module:["list","category"]},{order:"time",desc:1,columns:[{name:"文件名",key:"name",checkbox:!0,width:60,order:!1},{name:"大小",key:"size",width:16,order:!1},{name:"修改日期",key:"time",width:13,order:!1},{name:"所在目录",key:"path-info",width:10,order:!1}],module:["searchPath","searchGlobal","search"]},{order:e||"time",desc:void 0!==t?t:1,operateOrderKey:function(){},columns:[{name:"文件名",key:"name",checkbox:!0,width:50,order:function(){return!("/"===i)}},{name:"大小",key:"size",width:13,order:function(){return!("/"===i)}},{name:"创建人",key:"uname",width:13,order:!1},{name:"修改日期",key:"time",width:23,order:function(){return!("/"===i)}}],module:["sharedir"]}]},i.prototype.resetHeader=function(){if(this.cache)for(var e=this.cache,t=this.getHeaderConfig(),r=this.systemList.cache&&this.systemList.cache.cacheName,i=e.cacheName,s=null,o=[],n=0;n<t.length;n++){if(s=t[n],o=s.module,-1!==o.indexOf(r)&&-1!==o.indexOf(i)&&"category"!==i&&"sharedir"!==i)return;if(-1!=o.indexOf(i))return this.systemList.changeHeaderConfig(s),e.config.params.order=s.order,void(e.config.params.desc=s.desc)}},i.prototype.getCacheFailCallBack=function(e){var t=!0,r=!1,i="caution",s="";if(!e||-1!==e.errno&&20!==e.errno){if(e&&e.errno){var o=e.errno,n=a.accountBan(o);if(n.isBan)return this.systemList.updateLoadingTips(2,0),this.systemList.listEmptyTip(this.systemList.$emptyTips),!1;s=a.errorMsg(e.errno,"网络错误，请稍候重试")}}else s='由于您的帐号存在违规行为，帐号已被封禁。<a href="http://help.baidu.com/add?prod_id=48">申诉</a>';a.ui.tip({msg:s,mode:i,autoClose:r,hasClose:t}),this.systemList.updateLoadingTips(2,0),this.systemList.updateListLoading(3)},i.prototype.start=function(e,t){this.resetHeader(),this.cache&&this.systemList.changeCache(this.cache),this.buildHistory(e,t),d.trigger("clearViewBuilderCache"),d.trigger("system-change-toolbar")},i.prototype.render=function(){this.onRender(c.query.getAll())},i.prototype.buildHistory=function(){throw new Error("buildHistory needs override")},i.prototype.getCacheConfig=function(){throw new Error("getCacheConfig needs override")},i.prototype.onRender=function(){throw new Error("onRender needs override")},r.exports=i});
;define("disk-system:widget/router/view/base/SearchBaseView.js",function(e,r,t){var i=e("system-core:context/context.js").instanceForSystem,s=e("disk-system:widget/router/view/base/PageView.js"),a=i.message;t.exports=s.createView({_buildSearchHistory:function(e){if(e+=""){var r=["",e],t=["全部文件",'搜索："'+e+'"'];this.systemList.changeHistory(r,t)}else a.trigger("changePathHistory",["/"])},buildSearchHistory:function(){throw new Error("buildSearchHistory needs override")},buildSearchPathHistory:function(){throw new Error("buildSearchPathHistory needs override")},buildHistory:function(e,r){var t=r.searchPath;t?this.buildSearchPathHistory(e,t):this.buildSearchHistory(e)},onRender:function(e){var r=e.key;a.trigger("header-search-val",r),e.type="search",this.start(r,e)}})});
;define("disk-system:widget/router/view/RecycleBinView.js",function(e,t,s){var i=e("disk-system:widget/router/view/base/PageView.js"),n=e("system-core:context/context.js").instanceForSystem,o=n.PageSet;s.exports=i.createView({onRender:function(){o.invoker(o.instances.RECYCLE_BIN)}})});
;define("disk-system:widget/router/view/SearchPathView.js",function(e,t,a){var i=e("disk-system:widget/router/view/base/SearchBaseView.js"),r=e("base:widget/libs/jquerypacket.js"),s=e("system-core:context/context.js").instanceForSystem,n=s.message;a.exports=i.createSubView({type:"searchPath",getCacheConfig:function(){var e=this;return{api:"/api/filemetas",params:{recursion:1,order:"time",desc:1,showempty:0,web:1},limit:100,currentPage:0,listKey:"info",getParamsBykey:function(e){return{target:r.stringify([e])}},getPageParams:function(e,t){return{page:e+1,num:t}},getKeyByParams:function(e){return e.target},failCallBack:function(t,a){e.getCacheFailCallBack(t,a)}}},buildSearchPathHistory:function(e,t){if(e+=""){var a=["",t],i=["全部文件",'搜索："'+e+'"'];this.systemList.changeHistory(a,i)}else n.trigger("changePathHistory",["/"])}})});
;define("disk-system:widget/router/view/SearchGlobalView.js",function(e,t,i){var r=e("disk-system:widget/router/view/base/SearchBaseView.js");i.exports=r.createSubView({type:"searchGlobal",getCacheConfig:function(){var e=this;return{api:"/api/textsearch",params:{recursion:1,order:"time",desc:1,showempty:0,web:1},limit:100,currentPage:0,listKey:"list",getParamsBykey:function(e){return{key:e}},getPageParams:function(e,t){return{start:e*t,limit:t}},getKeyByParams:function(e){return e.key},failCallBack:function(t,i){e.getCacheFailCallBack(t,i)}}},buildSearchHistory:function(e){this._buildSearchHistory(e)}})});
;define("disk-system:widget/router/view/SearchNormalView.js",function(e,t,a){var n=e("system-core:context/context.js").instanceForSystem,r=e("base:widget/storage/storage.js"),s=e("disk-system:widget/router/view/base/SearchBaseView.js"),i=n.message,o=s.createSubView({type:"search",getTipContent:function(e){return'<span node-type="msg-text" class="text">成为<a class="vip-help" target="_blank" href="/buy/center?tag=4#FAQ_YEARVIP&amp;from=search" style="text-decoration: underline;" target="_blank">年费会员</a>，尊享全文检索特权，任意搜索office、pdf等文档里面的文字了！</span><a target="_blank"  class="g-button download" node-type="download-link" href="/buy/center?tag=1&usertype='+e+'&from=search"><span class="g-button-right"><span class="text">购买年费会员</span></span></a>'},getCacheConfig:function(){var e=this;return{api:"/api/search",params:{recursion:1,order:"time",desc:1,showempty:0,web:1},limit:100,currentPage:0,listKey:"list",getParamsBykey:function(e){return{key:e}},getPageParams:function(e,t){return{page:e+1,num:t}},getKeyByParams:function(e){return e.key},beforeListPush:function(e){for(var t=0;t<e.length;t++)e[t].share=e[t].share?e[t].share%2:0;return e},failCallBack:function(t,a){e.getCacheFailCallBack(t,a)}}},buildSearchHistory:function(e){this._buildSearchHistory(e);var t=window.yunData;if(!+t.ISYEARVIP){var a,s,i;if(+t.ISVIP?(i=3,s=r.getItem("search_vip_guide3_"+t.MYNAME),a=this.getTipContent("vip")):(i=1,s=r.getItem("search_vip_guide1_"+t.MYNAME),a=this.getTipContent("novip")),!s){var o=n.toolbar.setTipContent({content:a,styleType:1,className:"JS-toolbartip-search-guide",onClose:function(){r.setItem("search_vip_guide"+i+"_"+t.MYNAME,1),n.toolbar.prevDom(!1)}});n.toolbar.prevDom(o,!0),o.delegate(".vip-help","click",function(){n.log.send({name:"searchTip",value:"全文检索_会员引导"})}).delegate('a[node-type="download-link"]',"click",function(){n.log.send({name:"searchTip",value:"全文检索_会员引导"})})}}}});i.listen("transferToSearchNormal",function(){o.getInstance().render()}),a.exports=o});
;define("disk-system:widget/router/view/CardHolderView.js",function(e,t,i){var s=e("disk-system:widget/router/view/base/PageView.js"),n=e("system-core:context/context.js").instanceForSystem.PageSet;i.exports=s.createView({buildHistory:function(e){"/"===e&&(e=""),/\S\/+$/.test(e)&&(e=e.replace(/\/+$/,""));var t=e.split("/"),i=t.slice();return t[0]="/",i[0]="全部文件",t[1]&&"cardholder"===t[1]&&(i[1]="我的卡包"),{ids:t,names:i}},onRender:function(e){var t=e.path;"undefined"==typeof t&&(t="");var i=this.buildHistory(t);n.invoker(n.instances.CARD_HOLDER,function(e){e.emit("changeHistory",i.ids,i.names)})}})});
;define("disk-system:widget/router/view/ShareDirView.js",function(e,t,i){var r=e("disk-system:widget/router/view/base/PageView.js"),s=e("system-core:context/context.js").instanceForSystem,a=s.message,n=s.tools.topMountManager,o=s.tools.shareDirManager,l=r.createView({type:"sharedir",getCacheConfig:function(){var e,t,i=this.systemList.onListOrderChange();i&&(e=i.item,t="number"==typeof i.desc?i.desc:1);var r=this;return{params:{order:e||"time",desc:void 0!==t?t:1,showempty:0,web:1},forceRequestAPI:"/",limit:100,currentPage:0,listKey:"list",getApi:function(e){return"/"===e.dir?"/sharedir/list?method=receive":"/api/list"},getParamsBykey:function(e){return{dir:e}},getPageParams:function(e,t){return{start:e*t,limit:t}},getKeyByParams:function(e){return e.dir},beforeListPush:function(e,t,i){for(var r=0;r<e.length;r++)e[r].share=1;return s.tools.shareDirManager.diffAll&&(e=s.tools.shareDirManager.diffAll.addDiffMsgToCache(e),"/"===i&&s.tools.shareDirManager.diffAll.checkShareDirRoot()),e},failCallBack:function(e,t){r.getCacheFailCallBack(e,t)}}},buildHistory:function(e){e&&"/"!==e||(e=""),/\S\/+$/.test(e)&&(e=e.replace(/\/+$/,""));var t=this,i=e.split("/");i.unshift("all"),i[1]="/";var r=i.slice();r[0]="全部文件",r[1]="共享给我的文件夹";var a=o.getFakepathInfo(r[2]);a?(o.getMemberList(r[2]),o.getNameByFakepath(r[2],function(e){e?(r[2]=e,t.systemList.changeHistory(i,r)):s.ui.alert({title:"提示",body:"您未加入该共享文件夹，无法继续操作",sureText:"知道了",onSure:function(){location.href="/disk/home#/all?vmode=list&path=%2F"}})})):t.systemList.changeHistory(i,r)},onRender:function(e){var t=e.path;"undefined"==typeof t&&(t=""),this.start(t,e)}});a.listen("system-load-share-dir-list",function(e){var t=e.dir;t===n.FILE_IDENTITY.SHARE&&(t="/"),l.getInstance().cache.getCacheData(t,-1,e.complete,{host:e.host,FileTreeView:e.FileTreeView})}),i.exports=l});
;define("disk-system:widget/router/view/CategoryView.js",function(e,t,i){var s=e("system-core:context/context.js").instanceForSystem,r=s.message,a=e("disk-system:widget/router/view/base/PageView.js"),o=(e("base:widget/tools/service/tools.util.js"),e("base:widget/tools/tools.js")),n={3:"全部图片",2:"全部音乐",4:"全部文档",1:"全部视频",7:"全部种子",6:"其它文件"};i.exports=a.createView({type:"category",getCacheConfig:function(){var e,t,i=this.systemList.onListOrderChange();i&&(e=i.item,t="number"==typeof i.desc?i.desc:1);var s=this;return{api:"/api/categorylist",params:{order:e||"time",desc:void 0!==t?t:1,showempty:0,web:1},limit:100,currentPage:0,listKey:"info",getParamsBykey:function(e){return{category:e}},getPageParams:function(e,t){return{page:e+1,num:t}},getKeyByParams:function(e){return e.category},failCallBack:function(e,t){s.getCacheFailCallBack(e,t)}}},buildHistory:function(e){var t=n[e];t?this.systemList.changeHistory([e],[t]):r.trigger("changePathHistory",["/"])},onRender:function(e){var t=e.type;if(3===t){var i=o.client().browserString;if(i.match(/ie.+$/)){var r=i.split("ie")[1];if(8>=r)return void s.instanceForSystem.toolbar.showTimelineDom()}window.location.href="/disk/timeline"}this.start(t,e)}})});
;define("disk-system:widget/router/view/ListView.js",function(e,t,i){var r=e("disk-system:widget/router/view/base/PageView.js"),s=e("system-core:context/context.js").instanceForSystem,n=s.tools.topMountManager;i.exports=r.createView({type:"list",getCacheConfig:function(){var e,t,i=this.systemList.onListOrderChange();i&&(e=i.item,t="number"==typeof i.desc?i.desc:1);var r=this;return{api:"/api/list",params:{order:e||"time",desc:void 0!==t?t:1,showempty:0,web:1},limit:100,currentPage:0,listKey:"list",getParamsBykey:function(e){return{dir:e}},getPageParams:function(e,t){return{page:e+1,num:t}},getKeyByParams:function(e){return e.dir},topMount:function(e,t,i){return n.mount(e,t,i)},beforeListPush:function(e){for(var t=0;t<e.length;t++)e[t].share=e[t].share?e[t].share%2:0;return s.tools.shareDirManager.diffAll&&(e=s.tools.shareDirManager.diffAll.addDiffMsgToCache(e)),e},failCallBack:function(e,t){r.getCacheFailCallBack(e,t)}}},buildHistory:function(e){"/"===e&&(e="");var t=e.split("/"),i=t.slice();t[0]="/",i[0]="全部文件",this.systemList.changeHistory(t,i)},onRender:function(e){var t=e.path;"undefined"==typeof t&&(t=""),this.start(t,e)}})});
;define("disk-system:widget/system/baseService/shareDir/diffAll/diffAll.js",function(e,t,s){function i(){this.API="/api/diffall?message=2",this.interval=6e4,this.operUpdateMsgList=[],this.dismissMsgList=[],this.shareDirRootChangeList=[],this.init()}var a=e("base:widget/libs/jquerypacket.js"),r=e("base:widget/libs/underscore.js"),o=e("system-core:context/context.js").instanceForSystem,n=o.router,h=e("system-core:system/cache/listCache/cacheManage.js"),g=e("base:widget/storage/storage.js"),d=window.yunData;i.prototype.init=function(){this.getStorageMessage(),this.updateCurrentListCache(),this.intervalQuery(),this.getData().then(function(){o.message.trigger("after-share-dir-root-diffall")})},i.prototype.getData=function(){var e=this,t=new a.Deferred;return a.ajax({url:e.API,method:"GET"}).done(function(s){if(0===+s.errno&&s.sf.list.length>0){for(var i=s.sf.list,a=!1,r=0;r<i.length;r++)if(4===+i[r].status){a=!0;for(var o=!1,n=0;n<e.operUpdateMsgList.length;n++)if(e.operUpdateMsgList[n].fid===i[r].fid){o=!0;break}o||e.operUpdateMsgList.push(i[r])}else if(5===+i[r].status){a=!0;for(var o=!1,n=0;n<e.dismissMsgList.length;n++)if(e.dismissMsgList[n].fid===i[r].fid){o=!0;break}o||e.dismissMsgList.push(i[r])}else if((1===+i[r].status||2===+i[r].status)&&0===+i[r].is_owner){a=!0;for(var n=0;n<e.shareDirRootChangeList.length;n++)if(e.shareDirRootChangeList[n].fid===i[r].fid){o=!0;break}o||e.shareDirRootChangeList.push(i[r])}a&&(e.updateStorageMessage(),e.updateCurrentListCache())}t.resolve()}),t},i.prototype.intervalQuery=function(){var e,t,s=this;"undefined"!=typeof document.hidden?(e="visibilitychange",t="visibilityState"):"undefined"!=typeof document.mozHidden?(e="mozvisibilitychange",t="mozVisibilityState"):"undefined"!=typeof document.msHidden?(e="msvisibilitychange",t="msVisibilityState"):"undefined"!=typeof document.webkitHidden&&(e="webkitvisibilitychange",t="webkitVisibilityState"),e&&t&&a(document).on(e,r.throttle(function(){"visible"===document[t]&&s.getData()},s.interval))},i.prototype.getStorageMessage=function(){var e=this,t=g.getItem("shareDirDiffMsg_"+d.MYUK);if(t){var s=null;try{s=a.parseJSON(t)}catch(i){}s&&(s.operUpdateMsgList&&(e.operUpdateMsgList=s.operUpdateMsgList),s.dismissMsgList&&(e.dismissMsgList=s.dismissMsgList),s.shareDirRootChangeList&&(e.shareDirRootChangeList=s.shareDirRootChangeList))}},i.prototype.updateStorageMessage=function(){g.setItem("shareDirDiffMsg_"+d.MYUK,a.stringify({operUpdateMsgList:this.operUpdateMsgList,dismissMsgList:this.dismissMsgList,shareDirRootChangeList:this.shareDirRootChangeList}))},i.prototype.updateCurrentListCache=function(){var e=this,t=n.currentRouteName,s=n.query.get("path"),i=o.list.getCurrentList(),a=!1;r.each(i,function(i,o){r.each(e.operUpdateMsgList,function(e){i.path!==e.path||i.new_sharedir_detail||(i.new_sharedir_detail=1,h.replaceSingleCache(t,s,i,o))}),r.each(e.dismissMsgList,function(e){i.path===e.path&&1===+i.share&&(a=!0,i.share=0,h.replaceSingleCache(t,s,i,o))})}),a&&(o.list.refresh(),o.message.trigger("system-update-list-operate"))},i.prototype.addDiffMsgToCache=function(e){var t=this;return r.each(e,function(e){r.each(t.operUpdateMsgList,function(t){t.path===e.path&&(e.new_sharedir_detail=1)}),r.each(t.dismissMsgList,function(t){t.path===e.path&&1===+e.share&&(e.share=0)})}),e},i.prototype.checkShareDirRoot=function(){var e=this;e.getData().then(function(){o.message.trigger("after-share-dir-root-diffall",e.shareDirRootChangeList)})},i.prototype.removeDiffMsg=function(e,t){var s=this;if("operUpdate"===e)for(var i=0;i<s.operUpdateMsgList.length;i++){var a=s.operUpdateMsgList[i];if(a.path===t){var r=h.getCache(),o=t.match(/<share>/)?"sharedir":"list",n=t.substr(0,t.lastIndexOf("/"))||"/",g=r[o]&&r[o].data&&r[o].data[n]||{};if(g.list&&g.list.length>0)for(var d=0;d<g.list.length;d++)if(g.list[d].path===t){delete g.list[d].new_sharedir_detail,h.replaceSingleCache(o,n,g.list[d],d);break}s.operUpdateMsgList.splice(i,1),s.updateStorageMessage();break}}else if("dismiss"===e)for(var i=0;i<s.dismissMsgList.length;i++){var p=s.dismissMsgList[i];if(p.path===t){s.dismissMsgList.splice(i,1),s.updateStorageMessage();break}}else"shareDirRoot"===e&&(s.shareDirRootChangeList=[],s.updateStorageMessage())},s.exports=i});
;define("disk-system:widget/system/baseService/payFactory/service/payBase.js",function(t,e,o){function i(){}i.prototype.toPay=function(){this.$form&&$("#"+this.formId).submit()},i.prototype.buildForm=function(){throw new Error('The method "buildForm" must be inherited !')},i.prototype.setFormItem=function(t,e){this.$form&&this.$form.find('input[name="'+t+'"]').val(e)},o.exports=i});
;define("disk-system:widget/system/baseService/payFactory/service/payUtil.js",function(t,e,n){var s=t("system-core:context/context.js").instanceForSystem;n.exports={creatBid:function(){return(new Date).getTime()+""+Math.round(9999*Math.random())},timeFormat:function(t,e){var n=new Date(1e3*parseFloat(t)),s=n.getMonth()+1,i=n.getDate(),a=n.getHours(),o=n.getMinutes(),r=n.getSeconds();return+e?n.getFullYear()+"-"+(String(s).length<2?"0"+s:s)+"-"+(String(i).length<2?"0"+i:i)+" "+(String(a).length<2?"0"+a:a)+":"+(String(o).length<2?"0"+o:o)+":"+(String(r).length<2?"0"+r:r):n.getFullYear()+"-"+(String(s).length<2?"0"+s:s)+"-"+(String(i).length<2?"0"+i:i)},toLogin:function(){var e=s.ui.tip({mode:"loading",msg:"请稍候..."});t.async("base:widget/passAPI/passAPI.js",function(t){e.hideTip(),t.promise.done(function(){t.passAPI.PassportInit.netdiskLogin({reload:!0}),t.passAPI.PassLoginDialog.onLoginSuccessCallback=function(){t.passAPI.PassportInit.hide()}})})}}});
;define("disk-system:widget/system/baseService/payFactory/service/payActivity.js",function(t,e,s){function i(){}var o=t("base:widget/libs/jquerypacket.js"),r=t("disk-system:widget/system/baseService/payFactory/service/payBase.js"),n=t("system-core:context/context.js").instanceForSystem;i.prototype=new r,i.prototype.constructor=i,o.extend(i.prototype,{rePay:function(){if(!this.$form)throw new Error("The $form is must !")},buildForm:function(){var t=['<form target="'+i.ACTION_MODE+'" method="get" action="'+i.API_ACTION_PAY+'" id="'+this.formId+'" style="display:none;">','<input name="method"/>','<input name="product_name"/>','<input name="start"/>','<input name="business_no"/>','<input name="buy_way"/>','<input name="sign"/>','<input name="dqStatCode"/>',"</form>"];this.$form=o(t.join(""))}}),o.extend(i.prototype,{init:function(){this.buildForm(),this.setFormItemsFromConfig(),this.setFormItems()},setFormItems:function(){this.setFormItem("method","purchase"),this.setFormItem("business_no",payUtil.creatBid()),this.setFormItem("sign",""),this.setFormItem("product_name",this.productName),this.setFormItem("start",this.vipStartTime),this.setFormItem("buy_way",this.isVip?1:0),this.setFormItem("dqStatCode",this.dqStateCode?this.dqStateCode:"")},setFormItemsFromConfig:function(){if(this.addFormItems)for(var t in this.addFormItems)this.$form.append('<input name="'+t+'" value="'+this.addFormItems[t]+'" />')},fetchUserInfo:function(t){this.ajaxUserInfo(t)},ajaxUserInfo:function(t){var e=this;o.ajax({url:"/rest/2.0/membership/user?method=query",type:"GET",timeout:1e4,cache:!1,async:!1,dataType:"JSON",success:function(s){e.doVipDuration(s.product_infos,t)},error:function(){n.ui.tip({mode:"loading",msg:"网络错误，请稍候重试",autoClose:!1,hasClose:!1})}})},doVipDuration:function(t,e){for(var s,i=[],o=t,r=0;r<o.length;r++)s=o[r],/vip1/gi.test(s.product_name)&&i.push(s);if(0!=i.length)var n=parseFloat(i[0].start_time),a=parseFloat(i[0].end_time);for(var m=0;m<i.length;m++)n=parseFloat(i[m].start_time)>n?n:parseFloat(i[m].start_time),a=parseFloat(i[m].end_time)<a?a:parseFloat(i[m].end_time);e&&"function"==typeof e&&e({currentVipStartTime:n,currentVipEndTime:a})}}),s.exports=i});
;define("disk-system:widget/system/baseService/payFactory/service/payCapacity.js",function(t,e,i){function r(t){this.$form=null,this.serverTime=t.serverTime,this.isVip=t.isVip,this.quotaStartTime=t.quotaStartTime,this.formId=t.formId||r.DEFAULT_FORM_ID,this.productId=t.productId||r.DEFAULT_PRODUCT_ID,this.buyWay=t.buyWay||r.MODE_BUY_WAY_DEFAULT,this.dqStateCode=t.dqStateCode?t.dqStateCode:"",this.init()}var o=t("base:widget/libs/jquerypacket.js"),s=t("disk-system:widget/system/baseService/payFactory/service/payBase.js"),n=t("disk-system:widget/system/baseService/payFactory/service/payUtil.js"),a=t("system-core:context/context.js").instanceForSystem;r.API_ACTION_PAY="/rest/2.0/membership/product",r.ACTION_MODE="_target",r.DEFAULT_FORM_ID="payQuotaForm",r.MODE_BUY_WAY_RENEW=1,r.MODE_BUY_WAY_COMPOSITION=2,r.MODE_BUY_WAY_DEFAULT=r.MODE_BUY_WAY_RENEW,r.PACKAGE_LIST=[{product_name:"15GB",product_id:"4880050357179372399"},{product_name:"30GB",product_id:"13566730592746897967"},{product_name:"50GB",product_id:"1669981989677457522"},{product_name:"100GB",product_id:"17280046393110397375"}],r.DEFAULT_PRODUCT_ID=r.PACKAGE_LIST[2].product_id,r.prototype=new s,r.prototype.constructor=r,o.extend(r.prototype,{rePay:function(){if(!this.$form)throw new Error("The $form is must !")},buildForm:function(){var t=['<form target="'+r.ACTION_MODE+'" method="get" action="'+r.API_ACTION_PAY+'" id="'+this.formId+'" style="display:none;">','<input name="method">','<input name="business_no">','<input name="sign">','<input name="product_id">','<input name="start">','<input name="buy_way">','<input name="dqStatCode">','<input name="pay_way">','<input name="vcode_str">',"</form>"];this.$form=o(t.join("")),o("body").append(this.$form)}}),o.extend(r.prototype,{init:function(){o("#"+this.formId).remove(),this.buildForm(),this.setFormItems()},setFormItems:function(){this.setFormItem("method","purchase"),this.setFormItem("business_no",n.creatBid()),this.setFormItem("sign",""),this.setFormItem("product_id",this.productId),this.setFormItem("start",this.quotaStartTime),this.setFormItem("buy_way",this.buyWay),this.setFormItem("dqStatCode",this.dqStateCode)},ajaxCurrenUserQouta:function(){var t=this;o.ajax({url:"/api/quota",type:"GET",timeout:1e4,cache:!0,async:!1,dataType:"JSON",success:function(e){t.checkUserProduct(e)},error:function(){a.ui.tip({mode:"caution",msg:"网络错误，请稍候重试"})}})},checkUserProduct:function(){var t=function(t){for(var e,i=0,r=0,o=t.length;o>r;r++)e=t[r],e.end_time>i&&(i=e.end_time);return i};return function(e,i){for(var o=e.product_infos,s=[],n=0;n<r.PACKAGE_LIST.length;n++)for(var a=r.PACKAGE_LIST[n].product_id,d=0;d<o.length;d++)e.currenttime>o[d].end_time||a==o[d].product_id&&s.push(e.product_infos[d]);var u=t(s);i&&"function"==typeof i&&i({currentQuotaStartTime:u})}}()}),i.exports=r});
;define("disk-system:widget/system/baseService/payFactory/service/payVip.js",function(t,e,i){function s(t){this.$form=null,this.serverTime=t.serverTime,this.isVip=t.isVip,this.dqStateCode=t.dqStateCode?t.dqStateCode:"",this.vipStartTime=t.vipStartTime,this.addFormItems=t.addFormItems,this.formId=t.formId||s.DEFAULT_FORM_ID,this.productName=t.productName||s.DEFAULT_PRODUCT_NAME,this.init()}var r=t("base:widget/libs/jquerypacket.js"),o=t("disk-system:widget/system/baseService/payFactory/service/payBase.js"),m=t("disk-system:widget/system/baseService/payFactory/service/payUtil.js"),a=t("system-core:context/context.js");s.LOG_CODE_IS_VIP="99_109_139",s.LOG_CODE_IS_NO_VIP="99_100_138",s.API_ACTION_PAY="/rest/2.0/membership/product",s.ACTION_MODE="_target",s.DEFAULT_FORM_ID="payVipForm",s.PACKAGE_LIST=[{product_name:"vip1_1m",product_id:"13216777582222349574"},{product_name:"vip1_3m",product_id:"7322772448495138379"},{product_name:"vip1_6m",product_id:"7349836666708701604"},{product_name:"vip1_1y",product_id:"145433372644027012"}],s.DEFAULT_PRODUCT_NAME=s.PACKAGE_LIST[2].product_name,s.prototype=new o,s.prototype.constructor=s,r.extend(s.prototype,{rePay:function(){if(!this.$form)throw new Error("The $form is must !")},buildForm:function(){var t=['<form target="'+s.ACTION_MODE+'" method="get" action="'+s.API_ACTION_PAY+'" id="'+this.formId+'" style="display:none;">','<input name="method"/>','<input name="product_name"/>','<input name="start"/>','<input name="business_no"/>','<input name="buy_way"/>','<input name="sign"/>','<input name="dqStatCode"/>',"</form>"];this.$form=r(t.join("")),r("body").append(this.$form)}}),r.extend(s.prototype,{init:function(){r("#"+this.formId).remove(),this.buildForm(),this.setFormItemsFromConfig(),this.setFormItems()},setFormItems:function(){this.setFormItem("method","purchase"),this.setFormItem("business_no",m.creatBid()),this.setFormItem("sign",""),this.setFormItem("product_name",this.productName),this.setFormItem("start",this.vipStartTime),this.setFormItem("buy_way",this.isVip?1:0),this.setFormItem("dqStatCode",this.dqStateCode?this.dqStateCode:"")},setFormItemsFromConfig:function(){if(this.addFormItems)for(var t in this.addFormItems)this.$form.append('<input name="'+t+'" value="'+this.addFormItems[t]+'" />')},fetchUserInfo:function(t){this.ajaxUserInfo(t)},ajaxUserInfo:function(t){var e=this;r.ajax({url:"/rest/2.0/membership/user?method=query",type:"GET",timeout:1e4,cache:!1,async:!1,dataType:"JSON",success:function(i){e.doVipDuration(i.product_infos,t)},error:function(){a.instanceForSystem.ui.tip({mode:"caution",msg:"网络错误，请稍候重试"})}})},doVipDuration:function(t,e){for(var i,s=[],r=t,o=0;o<r.length;o++)i=r[o],/vip1/gi.test(i.product_name)&&s.push(i);if(0!=s.length)var m=parseFloat(s[0].start_time),a=parseFloat(s[0].end_time);for(var n=0;n<s.length;n++)m=parseFloat(s[n].start_time)>m?m:parseFloat(s[n].start_time),a=parseFloat(s[n].end_time)<a?a:parseFloat(s[n].end_time);e&&"function"==typeof e&&e({currentVipStartTime:m,currentVipEndTime:a})}}),i.exports=s});
;define("disk-system:widget/system/fileService/asynFileManager/asynFileManagerView.js",function(e,n,i){function a(e){if(!(e.length&&e.server_filename&&e.isdir))return"";for(var n,i='<ul class="asyn-view-content asyn-view-repeat-content">',a=e.length>10,s=a?10:e.length,t=0;s>t;t++)n=e[t],n.server_filename=n.from,n.isdir=0,i+='<li><span class="global-icon-16 global-icon-16-'+p.encodeHTML(c(n))+'"></span>'+p.encodeHTML(p.getFileNameByPath(n.from))+" </li>";return a&&(i+='<li class="asyn-view-more global-clearfix"><span class="asyn-view-point"></span><span class="asyn-view-point"></span><span class="asyn-view-point"></span></li>'),i+="</ul>"}function s(e,n,i){var a=e.to_meta,s=e.from_meta;return a.path=e.to,s.path=e.from,a.server_filename=p.getFileNameByPath(a.path),s.server_filename=p.getFileNameByPath(s.path),'<div class="asyn-view-content">'+t(a,n)+t(s,i)+"</div>"}function t(e,n){var i='<div class="asyn-view-content-item"><span class="asyn-view-tip-msg">'+n+'</span><div class="asyn-view-tip-info"><span class="asyn-view-tip-icon global-icon-16 global-icon-16-'+p.encodeHTML(c(e))+'"></span><span class="asyn-view-tip-name">'+p.encodeHTML(e.server_filename)+'</span></div><span class="asyn-view-tip-date">';return 1!==parseInt(e.isdir,10)&&(i+="大小："+p.toFriendlyFileSize(e.size)+"&nbsp;&nbsp;"),i+="修改日期："+p.parseDate(e.mtime)+"</span></div>"}function l(e){var n=[].slice.call(arguments,1);return n[0]?(e?s:a).apply(null,n)||"":""}function o(e,n){return e?'<div class="asyn-view-checkbox '+(n?"on":"")+'"><span class="global-icon-checkbox"></span>'+e+"</div>":""}function c(e){return 1===+e.isdir?"dir":p.getFileCategory(String(e.server_filename))||""}var r=e("system-core:context/context.js").instanceForSystem,p=e("base:widget/tools/tools.js"),d="alert-dialog-asyn-view";i.exports.showException=function(e){function n(){a(),e.okCall(s())}function i(){a(),e.cancelCall()}function a(){u.$dialog.removeClass(d),u.hide()}function s(){return p?u.$dialog.find(".asyn-view-checkbox").hasClass("on"):void 0}var t=e.title||"确定",c=l(e.flagRepeat,e.errorList,e.repeatToMsg,e.repeatFrmMsg),p=o(e.checkboxMsg,e.checkboxChecked),v=['<div class="dialog-asyn-view">',"<h4>"+e.contentTitle+"</h4>",c,p,"</div>"],g=[];e.plusText&&g.push({type:"big",color:"blue",name:"confirm",title:e.plusText,click:function(){a(),e.plusCall(s())}}),e.okText&&g.push({type:"big",color:"blue",name:"confirm",title:e.okText,padding:["36px","36px"],click:n}),g.push({type:"big",name:"cancel",title:e.cancelText,padding:["36px","36px"],click:i});var u=r.ui.window({title:t,body:v.join(""),buttons:g,onClose:i});u.show(),u.$dialog.addClass(d),u.$dialog.find(".asyn-view-checkbox").click(function(){$(this).toggleClass("on")})}});
;define("disk-system:widget/system/baseService/topMountManager.js",function(t,e,n){function r(){this.conf=[],this.conf.push({isdir:1,server_filename:"我的卡包",path:d,disableCheck:!0,mountPath:"/",mountView:["list","grid"],externalFun:function(){i.log.send({type:"cardHolder_enter_click",value:"",sendServerLog:!0}),s.callPlugin("网盘二级密码@com.baidu.pan",{success:function(){o.push({name:"cardHolder",query:{path:"/cardholder"}})}})}}),1===u.sharedir&&this.conf.push({isdir:1,dir_empty:1-Number(u.sharedir),server_filename:"共享给我的文件夹",icon:f,path:c,disableCheck:!0,share:1,mountPath:"/",mountView:["list","grid"],externalFun:function(){o.push({name:"sharedir",query:{path:"/"}})}})}var a=t("base:widget/libs/underscore.js"),i=t("system-core:context/context.js").instanceForSystem,o=i.router,s=i.message,u=window.yunData,d="cardHolder",c="shareHolder",f="dir-share-small";r.prototype.FILE_IDENTITY={CARD:d,SHARE:c},r.prototype.SHARE_DIR_ICON=f,r.prototype.mount=function(t,e,n,r){if(e&&e.data){var i=this.conf;r&&(r=r.toString(),i=a.filter(i,function(t){return r.indexOf(t.path)>-1}));for(var o=i.length-1;o>=0;o--){var s=i[o],u=s.mountPath;if(e.data[u]){var d=e.data[u].list;d&&d.indexOf(s)<0&&d.unshift(s)}}return e.data[n].list}},r.prototype.demount=function(t,e,n,r){if(e&&e.data){var i=this.conf;r&&(r=r.toString(),i=a.filter(i,function(t){return r.indexOf(t.path)>-1}));for(var o=i.length-1;o>=0;o--){var s=i[o],u=s.mountPath;if(e.data[u]){var d=e.data[u].list;e.data[u].list=a.filter(d,function(t){return t!==s})}}return e.data[n].list}},r.prototype.removeConfByPath=function(t){var e=this;e.conf=a.filter(e.conf,function(e){return e.path!==t})},r.prototype.getLengthByKey=function(t){for(var e=0,n=this.conf.length-1;n>=0;n--){var r=this.conf[n],a=r.mountPath;t===a&&e++}return e},n.exports=new r});
;define("disk-system:widget/system/baseService/shareDir/shareDirManager.js",function(e,t,a){function i(){this.memberListCache={},this.listFetching=!1,this.fetchCallback=[],this.diffAll=null,this.diffAllInitCnt=0}var r=e("base:widget/libs/jquerypacket.js"),s=e("system-core:context/context.js").instanceForSystem,n=s.router,o=s.ui.cacheManage,h=e("disk-system:widget/system/baseService/shareDir/diffAll/diffAll.js"),f=/^(\/<share>\d+-\d+)\/?/;i.prototype.initDiffAll=function(){0===this.diffAllInitCnt&&(this.diffAllInitCnt++,this.diffAll=new h)},i.prototype.getFakepathInfo=function(e){var t=/^(\/)?(<share>(\d+)-(\d+))(\/)?(.*)$/gi,a=t.exec(e),i=!1;return a&&(i={fakeRootPath:a[2],uk:a[3]?parseInt(a[3],10):0,fid:a[4]?parseInt(a[4],10):0,subPath:a[6]}),i},i.prototype.getNameByFakepath=function(e,t){var a=this,i=o.getCache().sharedir,n=i.data["/"];if(a.listFetching)return void a.fetchCallback.push(t);if(n){var h,f=n.list,l=this.getFakepathInfo(e);if(l)for(var c=l.uk,d=l.fid,u=0;u<f.length;u++)if(f[u].uk===c&&f[u].fid===d){h=f[u].server_filename;break}t(h)}else a.listFetching=!0,a.fetchCallback.push(t),r.ajax({url:"/sharedir/list?method=receive",data:{start:0,limit:100}}).done(function(t){if(a.listFetching=!1,t&&0===t.errno)for(i.data["/"]={list:t.list,hasMore:!1};a.fetchCallback.length;)a.getNameByFakepath(e,a.fetchCallback.shift());else s.ui.tip({mode:"failure",msg:s.errorMsg(t.errno,"共享目录列表加载失败")}),location.href="//pan.baidu.com/disk/home#/all?path=%2F&vmode=list"}).fail(function(e){a.listFetching=!1;s.ui.tip({mode:"failure",msg:s.errorMsg(e.errno,"共享目录列表加载失败")});location.href="//pan.baidu.com/disk/home#/all?path=%2F&vmode=list"})},i.prototype.getMemberList=function(e,t){var a=this.memberListCache[e],i=this;if(a)t&&t(a);else{var s=/^<share>(\d+)-(\d+)/gi.exec(e);if(s){var n=parseInt(s[1],10),o=parseInt(s[2],10);r.ajax({url:"/sharedir/member/list",data:{uk:n,fid:o,start:0,limit:50},success:function(a){a&&0===a.errno?(i.memberListCache[e]=a.list,t&&t(i.memberListCache[e])):t&&t(!1)},error:function(){t&&t(!1)}})}}},i.prototype.getMemberByUk=function(e,t){var a=this.memberListCache[e],i=!1;if(a)for(var r=0;r<a.length;r++)if(a[r]&&a[r].uk&&a[r].uk===t){i=a[r];break}return i},i.prototype.getShowNameByUk=function(e){var t=o.getCache().sharedir,a=n.query.get("path"),i="-";if(t&&t.data&&t.data[a]&&t.data[a].names){var r=t.data[a].names;if(0===e){var s=/\d+(?=-\d+$)/;if(s.test(a)){var h=a.match(s)[0];r[h]?i=r[h]:null}}else r[e]?i=r[e]:null}return i},i.prototype.getCurrentShareMeta=function(e){var t=!1,a=this.getFakepathInfo(e?e:n.query.get("path"));return a&&(t={key:a.fakeRootPath,uk:a.uk,fid:a.fid}),t},i.prototype.checkIsShareDirByPath=function(e){return e&&"string"==typeof e?"shareHolder"===e?!0:f.test(e):!1},i.prototype.getRootSharePath=function(e){var t=e.match(f);return t&&t[1]?t[1]:""};var l=new i;a.exports=l,s.message.listen("sharedir-access-error",function(){var e=n.query.get("path"),t=l.getFakepathInfo(e);t&&t.fakeRootPath&&l.getNameByFakepath(t.fakeRootPath,function(e){s.instanceForSystem.ui.alert({title:"提示",body:"您已被移出共享文件夹"+e+"，无法继续操作",onSure:function(){var e=o.getCache().sharedir,a=e.data["/"],i=!1;if(a&&a.list&&a.list.length)for(var r=0;r<a.list.length;r++)if(-1===a.list[r].path.indexOf(t)){i=!0;break}location.href=i?"//pan.baidu.com/disk/home#/sharedir?path=%2F&vmode=list":"//pan.baidu.com/disk/home#/all?path=%2F&vmode=list"}})})})});
;define("disk-system:widget/system/baseService/payFactory/payFactory.js",function(e,s,i){var t=e("disk-system:widget/system/baseService/payFactory/service/payVip.js"),r=e("disk-system:widget/system/baseService/payFactory/service/payCapacity.js"),o=e("disk-system:widget/system/baseService/payFactory/service/payActivity.js"),a=e("disk-system:widget/system/baseService/payFactory/service/payUtil.js"),y={Mode_Vip:1,Mode_Quota:2,Mode_Activity:3};y.createPayService=function(e){if(e.isLogin===!1)return void a.toLogin();switch(e.mode){case y.Mode_Vip:if(void 0===e.isVip)throw new Error("The isVip of config is must !");if(!e.serverTime)throw new Error("The serverTime of config is must !");return new t(e);case y.Mode_Quota:return new r(e);case y.Mode_Activity:return new o(e);default:throw new Error("The mode of pay is empty ! Please check the mode !")}},i.exports=y});
;define("disk-system:widget/system/util/selection.js",function(t,e,n){n.exports.setSelectionRange=function(t,e,n){function a(){if(e===n){var a=!(!window.attachEvent||-1!==navigator.userAgent.indexOf("Opera"));a&&window.setTimeout(function(){t.blur(),window.setTimeout(function(){t.focus()},0)},0)}}if(t){if(e=0>e?0:e,n=e>n?e:n,t.setSelectionRange)return t.focus(),t.setSelectionRange(e,n),void a();if(t.createTextRange){var r=t.createTextRange();r.collapse(!0),r.moveStart("character",e),r.moveEnd("character",n-e),r.select(),a()}}},n.exports.getSelectionRange=function(t){var e={text:"",start:0,end:0};if(t.setSelectionRange)return e.start=t.selectionStart,e.end=t.selectionEnd,e.text=e.start!==e.end?t.value.substring(e.start,e.end):"",e;if(document.selection){var n,a=document.selection.createRange(),r=document.body.createTextRange();r.moveToElementText(t),e.text=a.text,e.bookmark=a.getBookmark();try{for(n=0;r.compareEndPoints("StartToStart",a)<0&&0!==a.moveStart("character",-1);n++)"\n"===t.value.charAt(n)&&n++;e.start=n,e.end=e.text.length+e.start}catch(o){var c=document.selection.createRange();c.setEndPoint("StartToStart",t.createTextRange()),e.end=c.text.length,e.start=e.end-a.text.length}}return e}});
;define("disk-system:widget/system/fileService/fileOperate/fileOperate.js",function(e,a,l){var r=e("base:widget/tools/tools.js"),d=e("system-core:context/context.js").instanceForSystem,i=d.router,m=d.pluginControl,n=m.Registry,o=m.BrokerData.getAllData().fileIcon;l.exports.getInfo=function(e,a,l,d,m){e=e||"";var t=e.substring(e.lastIndexOf("/")+1),c={fileName:t,name:r.toEntity(t)};if(d)return c.smallIcon="dir-multi-small",c.middleIcon="dir-multi-middle",c.largeIcon="dir-multi-large",c;if(a)return e.match(/^\/apps$/)?(c.smallIcon="dir-apps-small",c.largeIcon="dir-apps-large",c.middleIcon="dir-apps-middle",c.name="我的应用数据",c):e.match(/^\/百度云收藏$/)?(c.smallIcon="dir-cang-small",c.largeIcon="dir-cang-large",c.middleIcon="dir-cang-middle",c.name="我的收藏",c):e.match(/^\/来自PC的备份文件$/)?(c.smallIcon="dir-backup-small",c.largeIcon="dir-backup-large",c.middleIcon="dir-backup-middle",c):e.match(/^\/apps\//)||e.match(/^\/百度云收藏\//)||e.match(/^\/来自PC的备份文件\//)?(c.smallIcon="dir-app-small",c.largeIcon="dir-app-large",c.middleIcon="dir-app-middle",c):e.match(/^cardHolder/)?(c.smallIcon="dir-card-small",c.largeIcon="dir-card-large",c.middleIcon="dir-card-middle",c.name="我的卡包",c):e.match(/^shareHolder/)?(c.smallIcon="dir-share-small",c.largeIcon="dir-share-large",c.middleIcon="dir-share-middle",c.name="共享给我的文件夹",c):255!==window.yunData.sharedir&&m?(c.smallIcon="dir-share-small",c.largeIcon="dir-share-large",c.middleIcon="dir-share-middle",c):"sharedir"===i.currentRouteName?(c.smallIcon="dir-share-small",c.largeIcon="dir-share-large",c.middleIcon="dir-share-middle",c):(c.smallIcon="dir-small",c.largeIcon="dir-large",c.middleIcon="dir-middle",c);c.largeIcon="default-large",c.smallIcon="default-small",c.middleIcon="default-middle";var s=-1!==e.lastIndexOf(".")?r.getFileCategory(e):"*";o[s]&&(3===o[s].length?(c.smallIcon=o[s][0],c.largeIcon=o[s][1],c.middleIcon=o[s][2]):2===o[s].length?(c.smallIcon=o[s][0],c.largeIcon=o[s][1]):(c.smallIcon=o[s],c.largeIcon=o[s]));var g=n.getDefaultPluginIdByExtension(s);return!l&&g&&(g=n.getPluginById(g).name+"@"+n.getOtherInfoById(g).group),c.plugin=g,c};var t=["dir","multi","shouchang","yingyong","yingyong_child","beifen","doc","docx","xls","xlsx","ppt","pptx","pdf","txt","jpg","jpeg","gif","bmp","png","jpe","cur","svg","svgz","tif","tiff","ico","wma","wav","mp3","aac","ra","ram","mp2","ogg","aif","mpega","amr","mid","midi","m4a","wmv","rmvb","mpeg4","mpeg2","flv","avi","3gp","mpga","qt","rm","wmz","wmd","wvx","wmx","wm","swf","mpg","mp4","mkv","mpeg","mov","asf","zip","rar","torrent"];l.exports.isOpenedFile=function(e,a){return a&&"torrent"===e?!1:t.indexOf(e)>=0}});
;define("disk-system:widget/system/uiRender/menu/menu.js",function(e){e("disk-system:widget/system/uiRender/menu/listMenu.js"),e("disk-system:widget/system/uiRender/menu/contextMenu/contextMenu.js")});
;define("disk-system:widget/system/uiRender/button/button.js",function(t){var e=t("base:widget/libs/jquerypacket.js"),i=(t("base:widget/storage/storage.js"),t("disk-system:widget/system/uiRender/button/buttonBoxGuide.js")),o=t("system-core:context/context.js").instanceForSystem,s=o.Broker;s.initButtonBroker([{name:"list",config:{limit:2,container:e("<div>"),containerWidth:300,hideWhenAllButtonDisable:!0}},{name:"tools",config:{className:"tcuLAu",container:e(".DxdbeCb .yxrjD56"),alwaysShow:!0,autoWidth:!0,paddingLeft:0,limit:4}},{name:"listTools",config:{autoHide:!0,className:"QDDOQB",limit:8,outSize:36,resize:!0,container:e(".DxdbeCb .yxrjD56")},events:{filesSelect:i}}])});
;define("disk-system:widget/pageModule/toolbar/search.js",function(e){function n(e){var n=c.trim(e);return""===n?!1:(r.log.send({name:"searchValue",value:n}),void s.push({name:"search",query:{key:n}}))}function o(){s.push({name:"list",query:{key:"/"}})}var c=e("base:widget/libs/jquerypacket.js"),t=e("base:widget/libs/underscore.js"),r=e("system-core:context/context.js").instanceForSystem,s=r.router,a=c('.OFaPaO input[node-type="toye0VGk eurk8kvg"]'),i=c('.OFaPaO  span[node-type="eurk8kvg"]'),u=c('.OFaPaO  span[node-type="ltzmKN"]'),l=c('.OFaPaO  span[node-type="uajvlK"]');i.on("click",function(){return n(a.val()),!1}),a.on("keydown",t.debounce(function(e){return 13===e.keyCode?(n(a.val()),!1):void 0},300)).on("focus",function(){""===c.trim(a.val())?u.hide():l.show()}).on("input",t.debounce(function(){""===c.trim(a.val())?l.hide():l.show()},300)).on("blur",function(){setTimeout(function(){""===c.trim(a.val())&&(u.show(),l.hide())},100)}),u.on("click",function(){a.focus()}),l.on("click",function(){a.val(""),u.show(),l.hide(),o()})});
;define("disk-system:widget/pageModule/toolbar/toolbar.js",function(e){function t(){return f.getButtonBroker("tools")}function o(){return f.getButtonBroker("listTools")}function i(){a.toolbar.prevDom(!1)}var s=e("base:widget/libs/underscore.js"),n=e("base:widget/libs/jquerypacket.js"),l=e("base:widget/storage/storage.js"),d=e("system-core:context/context.js"),r=e("disk-system:widget/pageModule/toolbar/sort.js"),a=d.instanceForSystem,f=a.Broker,u=a.message,m=a.router;r.init();var c=n(".DxdbeCb"),h="list-switched-on",p="grid-switched-on",g={listGridSwitch:".juzLnk",listSwitch:".fzwd0Aga",gridSwitch:".st8R4m",prevDom:".xbalzLRy",afterDom:".hhksz653",defaultDom:".ngr021M",userDom:".cijgXy",timeLineDom:".EQBfLM",listTools:".QDDOQB",defaultListToolPos:".KPDwCE .KKtwaH",bar:".yxrjD56"};n(g.listGridSwitch).on("click","a",function(e){if(!d.getList().isLocked()){var t=n(e.currentTarget),o="grid"!==m.query.get("vmode"),i="",s=null;o?(i="grid",s=p):(i="list",s=h),t.parent().hasClass(s)||d.getList().isLocked()||(l.setItem("chooseviewtype",i),m.query.set("vmode",i))}}),u.listen("system-update-view-mode",function(e){var t=c.find(g.listGridSwitch),o=t.find(g.listSwitch),i=t.find(g.gridSwitch);"list"===e.type?(t.addClass(h).removeClass(p),o.hide(),i.show()):(t.addClass(p).removeClass(h),o.show(),i.hide())}),u.listen("system-checked-changed",function(e){var i="pic"===m.currentRouteName;i||t().filesSelect(e.data),o().filesSelect(e.data,{paddingLeft:i?100:n(".tcuLAu").width()})}),u.listen("system-change-toolbar",function(e){var o=t();o&&o.resizeButtons(e?[]:d.getList().getCheckedItems())}),u.listen("system-update-list-operate",function(){var e=d.getList().getCheckedItems();o().resizeButtons(e)}),a.router.eachLeave(i),a.router.query.watch("type",i);var v=!1,w=!1;d.extend({toolbar:{$mod:c,defaultListToolPos:g.defaultListToolPos,setToolBarMod:function(e){this.$mod=e},setListToolOperateZone:function(e){this.defaultListToolPos=e},afterDom:function(e,t){var o=this.$mod;if(e){if(w)return;t===!0&&(w=!0),o.find(g.afterDom).html("").append(e).show()}else e===!1?(o.find(g.afterDom).html(""),w=!1):o.find(g.afterDom).hide();n(window).trigger("resize")},prevDom:s.throttle(function(e,t){var o=this.$mod,i=o.find(g.prevDom),s=i.html();if(e){if(v>t)return;(t===!0||"number"==typeof t)&&(v=t>1?t:1),i.html("").append(e).show()}else{if(!s)return;e?i.hide():(i.html(""),v=!1)}n(window).trigger("resize")},500),setStyle:function(e,t){e&&(0===t?e.addClass("fwupzXr5"):1===t&&e.addClass("fwupzXr5 vchzbyG"))},setTipContent:function(e){e=n.extend({content:null,styleType:null,className:null,onClose:function(){}},e);var t=n('<div node-type="dvdm8R1w" class="global-clearfix"><a node-type="wkrd03ax" href="javascript:void(0);" class="algpz9Vd"></a></div>');return null!=e.styleType&&this.setStyle(t,e.styleType),null!=e.className&&t.addClass(e.className),null!=e.content&&t.append(e.content),"function"==typeof e.onClose&&t.find(".algpz9Vd").click(function(){e.onClose()}),t},showDefault:function(){var e=this.$mod;e.find(g.userDom).hide(),e.find(g.defaultDom).show(),e.find(g.prevDom).children().length&&e.find(g.prevDom).show(),e.find(g.afterDom).children().length&&e.find(g.afterDom).show(),e.find(g.timeLineDom).hide(),e.removeClass("fre0J7M");var o=n(this.defaultListToolPos).find(g.listTools);o.length&&o.appendTo(e.find(g.bar)),t().buttonsRender()},setDom:function(e){var t=this.$mod;t.find(g.defaultDom).hide(),t.find(g.prevDom).hide(),t.find(g.afterDom).hide(),t.find(g.timeLineDom).hide(),t.find(g.userDom).html("").append(e).show(),t.removeClass("fre0J7M"),n(window).trigger("resize")},showTimelineDom:function(){if(yunData&&yunData.sampling&&yunData.sampling.indexOf("disk_timeline")>-1){var e=this,t='<div style="text-align:left;">温馨提示：你的浏览器版本过低，无法体验图片等新功能，请升级为IE8以上浏览器</div>',o=e.setTipContent({content:t,className:"update-browser-tips",styleType:1,onClose:function(){e.prevDom(!1)}});e.prevDom(o,!0)}else c.find(g.prevDom).hide();c.find(g.defaultDom).hide(),c.find(g.afterDom).hide(),c.find(g.userDom).hide(),c.find(g.timeLineDom).show(),c.addClass("fre0J7M"),n(window).trigger("resize");var i=c.find(g.listTools);i.length&&i.appendTo(n(this.defaultListToolPos))},setSortSelect:function(e){r.setSortSelect(e)},setSortAvailable:function(e){r.setSortAvailable(e)}}})});
;define("disk-system:widget/pageModule/list/listInit.js",function(e,t,i){function r(e,t){w.push({name:e,query:t})}function s(e,t){var i=t||C.LIST;1!==e.length&&(e[0]="");var s=w.query.getAll(),a={};s.vmode&&(a.vmode=s.vmode);var n=e.join("/");/\S\/+$/.test(n)&&(n=n.replace(/\/+$/,"")),a.path=n,r(i,a)}var a=e("base:widget/libs/jquerypacket.js"),n=e("base:widget/libs/underscore.js"),o=e("base:widget/tools/tools.js"),l=e("base:widget/storage/storage.js"),c=e("system-core:context/context.js"),d=e("disk-system:widget/system/fileService/fileOperateEntry.js"),h=e("disk-system:widget/pageModule/list/dragAndSelect.js"),u=e("disk-system:widget/system/util/cache/cacheUtils.js"),g=e("disk-system:widget/pageModule/list/list-view/list-view-builder.js"),m=e("disk-system:widget/pageModule/list/grid-view/grid-view-builder.js"),f=e("disk-system:widget/pageModule/list/list-view-empty/list-view-empty.js"),y=e("disk-system:widget/pageModule/preScanGarbage/preScanGarbage.js"),v=c.instanceForSystem,p=v.message,w=v.router,S=window.yunData||{},C=w.$allPageSetType;S.ISSVIP||y.duplicateCheck(),location.search.match(/panLoginType=qrcode/)&&v.log.send({name:"login_qrcode",type:"pan_login_qrcode_success"});var I=v.ui.list(".KPDwCE",{defaultViewModle:w.query.get("vmode")||"list",historyConfig:{},listConfig:{defaultScroll:!0,listItemClass:"AuPKyz",itemActiveClass:"xz0Enz"},gridConfig:{defaultScroll:!0,columnWidth:128,gridItemClass:"cEefyz",itemActiveClass:"xz0Enz"},listViewBuilder:g,gridViewBuilder:m});c.setList(I),I.resizeScrollBar(a(window).height()-I.$container.offset().top),d.forReady(),h(),a(window).resize(n.throttle(function(){p.trigger("cancelEidtingDir"),I.resize(a(window).height()-I.$container.offset().top)},300));var k=function(e){var t=w.query.getAll(),i={};t.vmode&&(i.vmode=t.vmode),i.key=e,r(C.SEARCH,i)};p.listen("changePathHistory",s),I.getListItemDomByPostion=function(e){var t=w.query.get("vmode")||"list";return"list"===t?I.$container.find(".AuPKyz")[e]:"grid"===t?I.$container.find(".cEefyz")[e]:void 0},p.listen("system-show-view-mode",function(e,t){if(!I.isLocked()&&(e||(e=w.query.get("vmode")),e!==t)){p.trigger("system-change-view-mode-loadingtip"),I.setViewModule("grid"===e?"grid":"list");var i=w.currentRouteName,r=i&&"search"===i.name;v.toolbar.setSortAvailable(r?!1:!0),p.trigger("cancelEidtingDir"),t&&I.loadInitData()}}),p.listen("header-search",function(e){e+="",e?k(e):s(["/"])}),p.listen("system-refresh",function(e){var t=e&&e.path,i=w.currentRouteName;"undefined"!=typeof e&&e.all===!0?u.removeCacheAll():e&&e.flagChangeSuffix||("undefined"!=typeof t&&(t=t||"/",u.removeCache(t)),i===C.LIST?(t=w.query.get("path")||"/",t&&u.removeCache(t)):i===C.CATEGORY?u.removeCategoryCache():i===C.SEARCH&&u.removeSearchCache()),I.setItemsChecked(!1,!0),I.refreshList()}),I.onViewModuleChange=function(e){p.trigger("system-update-view-mode",{type:e}),I.listHeader.changeVmode({type:e})},I.onListOrderChange=function(e,t){var i="localorder_"+(S.MYNAME||"").replace(/@/g,""),r="";if(e)r=e+"_"+t,"undefined"!=typeof l&&l.setItem(i,r),v.log.send({type:"listHeaderOrder_"+e,name:"listHeaderOrder",value:e}),v.toolbar.setSortSelect({item:e,desc:t});else if("undefined"!=typeof l&&"function"==typeof l.getItem){if("3"===w.query.get("type"))return null;if(r=l.getItem(i),!r)return null;var s=r.split("_");if(2!==s.length)return null;var a=parseInt(s[1],10),n={item:s[0],desc:a};return v.toolbar.setSortSelect(n),n}},I.onCheckeChanged=function(e){var t="vs0JrK";e>1?I.$container.addClass(t):I.$container.removeClass(t)};var A=!0;I.onLoadedCallBack=function(t,i,r){if(A){var s=+new Date,n=window.alog;A=!1,setTimeout(function(){"undefined"!=typeof n&&"undefined"!=typeof n.fire&&(n("speed.set","c_pd",s),n.fire("mark"))},1500)}if(r&&r.flag===!1)return void(r&&!S.ISSVIP&&(r.data=t,y.junkFileShow(r)));var l=this.cache.cacheName;if(l===C.SEARCH_PATH&&a(I.getDomByPosition(0)).trigger("dblclick"),l===C.SEARCH_GLOBAL&&0===t.length){var c=w.query.get("key"),d=I.cache.getCache();d&&d[c]&&d[c].list.length||p.trigger("transferToSearchNormal")}if("list"===l||"sharedir"===l){v.tools.shareDirManager.initDiffAll();var d=I.cache.getCache(),h=r&&r.key;if(!h)return;var u=d[l].data[h],g="sharedir"===l&&"/"===h?"web-sharedir-enter-root":"sharedir"===l&&/<share>/.test(h)?"web-sharedir-enter-share-to-me":"list"===l&&1===+u.share?"web-sharedir-enter-my-share":null;g&&v.report(g)}p.trigger("after-list-loaded"),"132"===o.getParam("msg")&&e.async("base:widget/passAPI/passAPI.js",function(e){e.promiseForceverify.done(function(){e.passAPI.PassportForceInit.netdiskForceVerify(),e.passAPI.PassForceverify.onSubmitFailure=function(){},e.passAPI.PassForceverify.onSubmitSuccess=function(){var e=o.getParam("devuid"),t=o.getParam("version");a.getJSON("/api/report/user?action=sapi_auth&version="+t+"&devuid="+e,function(e){e&&0===e.errno?setTimeout(function(){window.location.href="/disk/home"},300):v.ui.tip({mode:"caution",msg:"验证失败，请稍后重试！"})})}})}),r&&!S.ISSVIP&&(r.data=t,y.junkFileShow(r))},I.mapFirstFileByCategory=function(e,t){var i=null;if(e.length<=0)return i;i={};var r=I.getFirstPosition();if(0>r)return i;for(var s,n,l=I.getDomByPosition(r),c=null;null!==l&&e.length>0;){if(c=I.getElementDataByPosition(r),c&&!c.isdir&&c.server_filename&&(s=o.getFileCategory(c.server_filename))&&s&&(s="."+s,!i[s]&&(n=a.inArray(s,e))>=0&&(e.splice(n,1),t.call(null,s,a(l)))))return;l=I.getDomByPosition(++r)}},I.getIndexsByFiles=function(e){return I.cache.getIndexsByFiles(e)},I.remove=function(e,t){d.removeFiles(e,t)},I.removeCacheByPath=function(e){u.removeCache(e)},I.extend({getCheckMsg:function(e){return"已选中"+e+"个文件/文件夹"},resizeScrollBar:function(e){var t=this.$container;if("number"==typeof e||"string"==typeof e?t.height(e):e=a(window).height()-t.offset().top,0===e)throw"[Error] list container's height is 0, need to set";var i=this.listHeader.hasInit===!1?0:42;"none"===t.find(".JDeHdxb").css("display")?(this.$moduleGridView.height(e-i),this.$moduleListView.height(e-i),this.$moduleGridView.find(".scrollbar-tracker").height(e-i),this.$moduleListView.find(".scrollbar-tracker").height(e-i)):(this.$moduleGridView.height(e-58),this.$moduleListView.height(e-58),this.$moduleGridView.find(".scrollbar-tracker").height(e-58),this.$moduleListView.find(".scrollbar-tracker").height(e-58))}}),I.addHistory=function(e){var t=w.currentRouteName,i=I.getHistoryIds();i=i?i.slice():[],i.push(e),t===C.SHARE_DIR?(i.shift(),s(i,t)):s(i)},I.goHistory=function(e,t){var i=w.query.getAll(),s={};i.vmode&&(s.vmode=i.vmode),t?/\S\/+$/.test(t)&&(t=t.replace(/\/+$/,"")):t="/",s.path=t,r(e,s)},I.historyChange=function(e,t){var i,r=w.currentRouteName;if(0!==e.length){i=this.currentKey,r===C.SHARE_DIR&&(e=e.slice(1),t=t.slice(1)),this.currentKey=e.join("/"),e.length>1&&(this.currentKey=this.currentKey.substring(1));var s=i!==this.currentKey||this.currentCacheName!==this.cache.cacheName;s&&("/"!==this.currentKey||""!==i||null!==this.currentCacheName&&this.currentCacheName!==this.cache.cacheName||(s=!1)),this.currentCacheName=this.cache.cacheName,s&&this.setItemsChecked(!1,!0),this.cache.updateKey(this.currentKey),this.$historyListRootPath.html(t[0]),this.loadInitData(),s&&this.onHistoryChange(e,t)}},I.listEmptyTip=function(e){var t=w.currentRouteName,i=w.query.get("path");"sharedir"===t&&"/"===i?I.updateListLoading():(I.$listHeader.hide(),e.html(f.emptyView).show())},I.getHistoryList().goToHistory=function(e){var t=w.currentRouteName;if(!(e>=this.historyList.length||0>e)){if(t===C.SEARCH)return p.trigger("header-search-val",""),void s(["/"]);var i=this.historyList.slice();i.splice(e,this.historyList.length);var r=C.LIST;t===C.SHARE_DIR&&(1===i.length&&"all"===i[0]?i[0]="/":(i.shift(),r=C.SHARE_DIR)),s(i,r)}},I.listHeader.canTriggerOrder=function(){return!d.isBlocking()},I.cancelEidtingDir=function(){p.trigger("cancelEidtingDir")},I.cancelFilesSelect=function(){I.$container.find(".AuPKyz").removeClass("xz0Enz"),I.$container.find(".cEefyz").removeClass("xz0Enz"),I.setItemsChecked(!1,!0)},i.exports=I});
;define("disk-system:widget/pageModule/aside/aside.js",function(e){function t(e,t){if(e.data("changed",!0),t.isVisible===!1?e.hide():e.show(),t.title&&e.find(u.itemTitle).text(t.title),t.iconClass&&e.find(u.imgIcon).addClass(t.iconClass),t.href&&e.find(u.itemHref).attr("href",t.href).removeAttr("cat"),t.guide){var i=t.guide;if("object"!=typeof i)throw new Error("[aside] The new nav item must has property: guide. And the guide must be an object");if(i.dom){var n=a(i.dom);i.positionX&&n.css("left",i.positionX),i.positionY&&n.css("top",i.positionY),e.find(u.itemHref).append(n)}}t.click&&"function"==typeof t.click&&e.bind("click",function(e){t.click.call(n,e)})}function i(e,t){var i,n=p.find(u.listItem),o=d.query.get("vmode");if(o||setTimeout(function(){d.query.set({name:"vmode",value:s.getItem("chooseviewtype")||"list"})},0),"category"===e)switch(t){case"4":i="doc";break;case"1":i="video";break;case"7":i="mbt";break;case"2":i="music";break;case"3":i="pic";break;case"6":i="other";break;default:i="list"}else i="list";n.removeClass("bHzsaPb");for(var a=0;a<n.length;a++)n.eq(a).data("key")===i&&n.eq(a).addClass("bHzsaPb")}function n(e){var i=a(u.listItem),n=a(l);t(n,e),e.index&&e.index<i.length?i.eq(e.index).after(n):i.last().after(n)}function o(e){var i,n=a(u.listItem);if(!(e.index&&e.index<n.length))throw new Error("[aside] The index of item which you will change must in the range of 0 ~ "+n.length);i=n.eq(e.index),t(i,e)}var a=e("base:widget/libs/jquerypacket.js"),s=e("base:widget/storage/storage.js"),c=e("system-core:context/context.js").instanceForSystem,r=c.message,d=c.router,m=c.Broker,l='<li node-type="amzmjgLy" class="iicszX45"><a node-type="aqjyNL" class="nzr0YdW" hideFocus="true" href="javascript:void(O);"><span class="text"><span node-type="epz9Gd" class="piuzmD0"></span><span node-type="dysqzlMZ"></span></span></a></li>',u={mod:".module-aside",listItem:".fOHAbxb li[data-key]",picHotIco:'em[node-type~="op0nK2"]',picItem:'a[node-type~="hkijx5e"]',itemTitle:'span[node-type~="dysqzlMZ"]',imgIcon:'span[node-type~="epz9Gd"]',itemHref:"a"},p=a(u.mod),f={list:function(){d.push({name:"list",query:{path:"/"}})},pic:function(){d.push({name:"category",query:{type:"3",vmode:"grid"}})},doc:function(){d.push({name:"category",query:{type:"4"}})},video:function(){d.push({name:"category",query:{type:"1"}})},mbt:function(){d.push({name:"category",query:{type:"7"}})},music:function(){d.push({name:"category",query:{type:"2"}})},other:function(){d.push({name:"category",query:{type:"6"}})}};d.onEnter("list",function(){i("list")}),d.onEnter("recyclebin",function(){p.find(u.listItem).removeClass("bHzsaPb"),a(".JKEQDvb").addClass("nueyjgEz")}),d.onLeave("recyclebin",function(){a(".JKEQDvb").removeClass("nueyjgEz")}),d.query.watch("type",function(e){"category"===d.currentRouteName&&i("category",e)}),r.listen("nav-add-item",n),r.listen("nav-change-item",o),function(){p.find(".FvBGOQ").prev(".he03G0").show(),p.find(".JKEQDvb").prev(".he03G0").show(),p.delegate(u.listItem,"mouseover",function(e){a(e.target).closest(u.listItem).addClass("vgKGgu")}),p.delegate(u.listItem,"mouseout",function(e){a(e.target).closest(u.listItem).removeClass("vgKGgu")}),p.delegate(u.listItem,"click",function(e){var t=a(e.target).closest(u.listItem);if(!t.data("changed")){var i=t.data("key");if(t.hasClass("bHzsaPb")&&"list"!==i)return!1;p.find(u.listItem).removeClass("bHzsaPb"),t.addClass("bHzsaPb"),f[i]&&f[i]()}}),s.getItem("redPointNotice")||a.ajax({url:"/api/image/getreddot",dataType:"json",success:function(e){if(e.isdot===!0){var t=a('li[data-key="pic"]');t.append('<div class="lwt0p28" node-type="av8NMw"></div>').one("click",function(){var e=a('div[node-type="av8NMw"]');e.length&&a(this).remove(e)}),s.setItem("redPointNotice",!0)}}}),a.browser.msie&&6==a.browser.version||a.getJSON("/api/image/getuinfo",function(e){e&&0==e.errno&&2==e.lt_flag&&o({index:1,href:"/disk/timeline"})})}(),m.initButtonBroker([{name:"aside-middle",config:{className:"mbcjyR0",container:a(".module-aside .FvBGOQ")}},{name:"aside-bottom",config:{className:"gl0YVz",container:a(".module-aside .JKEQDvb")}}])});
;define("disk-system:widget/router/initRouter.js",function(e){function t(){return h.query.get("searchpath")?void c().render():void(+yunData.ISYEARVIP?o().render():s().render())}var r=e("disk-system:widget/router/view/ListView.js").getInstance,n=e("disk-system:widget/router/view/CategoryView.js").getInstance,a=e("disk-system:widget/router/view/ShareDirView.js").getInstance,i=e("disk-system:widget/router/view/CardHolderView.js").getInstance,s=e("disk-system:widget/router/view/SearchNormalView.js").getInstance,o=e("disk-system:widget/router/view/SearchGlobalView.js").getInstance,c=e("disk-system:widget/router/view/SearchPathView.js").getInstance,d=e("disk-system:widget/router/view/RecycleBinView.js").getInstance,u=e("system-core:context/context.js").instanceForSystem,g=u.message,h=u.router,w=u.PageSet;h.use(function(e){e.prototype.$allPageSetType={LIST:"list",CATEGORY:"category",SHARE_DIR:"sharedir",SEARCH:"search",SEARCH_GLOBAL:"searchGlobal",SEARCH_PATH:"searchPath"}}),h.addRoute([{path:"/all",query:{path:{value:"/",watch:function(e,t){"list"===h.currentRouteName&&e&&t&&r().render()}},vmode:{value:"list",locked:!0,watch:function(e,t){var r=u.getList();r&&r.isLocked()||g.trigger("system-show-view-mode",e,t)}}},name:"list",isDefault:!0,render:function(){r().render()}},{path:"/category",query:{type:{watch:function(e,t){"category"===h.currentRouteName&&e&&t&&n().render()}}},name:"category",render:function(){n().render()}},{path:"/search",name:"search",query:{key:{watch:function(e,r){e&&r&&t()}}},render:t},{path:"/sharedir",name:"sharedir",query:{path:{value:"/",watch:function(e,t){"sharedir"===h.currentRouteName&&e&&t&&a().render()}}},render:function(){a().render()}},{path:"/cardHolder",name:"cardHolder",query:{path:{watch:function(e,t){"cardHolder"===h.currentRouteName&&e&&t&&i().render()}}},isPageSet:!0,render:function(){i().render()},leave:function(){w.fledIntoDarkness()}},{path:"/recyclebin",name:"recyclebin",isPageSet:!0,render:function(){d().render()},leave:function(){w.fledIntoDarkness()}}]),h.on("error",function(){h.push({name:"list",query:{path:"/",vmode:"list"}})}),h.eachEnter(function(e,t){if(e){var r=h.getRouterConfig(e);r&&(e&&t&&g.trigger("system-change-toolbar",!0),g.trigger("ViewPanelChanged",!r.isPageSet))}})});
;define("disk-system:widget/system/util/contextExtend.js",function(e){var t=e("system-core:context/context.js").instanceForSystem,i=e("disk-system:widget/data/yunData.js"),s=e("disk-system:widget/system/fileService/fileOperate/fileOperate.js"),n=e("disk-system:widget/system/fileService/fileManagerApi/fileManagerApi.js"),r=e("disk-system:widget/system/util/selection.js"),o=e("system-core:system/uiService/list/list.js"),a=e("system-core:system/uiService/dialog/dialog.js"),d=e("system-core:system/uiService/button/button.js"),g=e("disk-system:widget/system/baseService/payFactory/payFactory.js"),u=e("disk-system:widget/system/baseService/shareDir/shareDirManager.js"),c=e("disk-system:widget/system/baseService/topMountManager.js"),l=e("service-widget-1:PageSetInvoker/PageSet.js"),y=e("system-core:pluginHub/Broker/Broker.js");e("disk-system:widget/system/errorMsg/errorMsg.js");var f={buttonType:"big",buttonPadding:["50px","50px"],buttonColor:"blue"},m={paddingLeft:10,paddingRight:10,height:34};t.extend({file:{getIconAndPlugin:function(e,t,i,n){return s.getInfo(e,t,!1,i,n)},isOpenedFile:function(e,t){return s.isOpenedFile(e,t)},getFileInfo:function(e,t,i,n,r){return s.getInfo(e,t,i,n,r)},createAndMoveTo:function(e,t,i,s){n.sendCreateNewFileApi(e,"",1,null,function(){setTimeout(function(){n.sendFileMoveCopyApi(n.COPY+i,t,e,s)},1e3)})}},data:{user:i.get(),quota:{get:function(){return[100,1e10]},update:function(e){e(100,1e10)},hasEnoughSpacing:function(){return window.yunData&&window.yunData.QUOTAINFOS?window.yunData.QUOTAINFOS.used<window.yunData.QUOTAINFOS.total:!0}}},ui:{treeDialog:function(i){e.async("disk-system:widget/system/uiService/fileTreeDialog/fileTreeDialog.js",function(e){i===!1?e.hide():e.show(i)}),t.message.trigger("addIcon")},list:function(e,t){var i=new o(e,t);return i.extend({resizeScrollBar:function(e){var t=this.$container;if("number"==typeof e||"string"==typeof e?t.height(e):e=t.height(),0===e)throw"[Error] list container's height is 0, need to set";t.height(e);var i=this.listHeader.hasInit===!1?0:52,s=t.find(".NHcGw"),n=t.find(".BNfIyPb"),r=s.add(n);"none"===t.find(".JDeHdxb").css("display")?r.height(e-i).find(".scrollbar-tracker").height(e-i-2):r.height(e-73).find(".scrollbar-tracker").height(e-73)}}),i},window:function(e){var i=new a(e);return t.message.trigger("addIcon"),i},confirm:function(e,i,s,n,r){var o=a.confirm(e,i,s,n,r,f);return t.message.trigger("addIcon"),o},alert:function(e,i){var s=a.alert(e,i,f);return t.message.trigger("addIcon"),s},verify:function(e,i,s,n,r){var o=a.verify(e,i,s,n,r,f);return t.message.trigger("addIcon"),o},button:function(e){return e.buttonDefaultConfig=m,new d(e)},Selection:r},tools:{payFactory:g,shareDirManager:u,topMountManager:c},PageSet:l,Broker:y})});
;define("disk-system:widget/system/uiRender/header/header.js",function(e){var d=e("base:widget/libs/jquerypacket.js"),o=e("system-core:context/context.js"),a=o.instanceForSystem,n={mod:".module-header",wrapper:'div[node-type~="module-header-wrapper"]'};return"hao123-iframe"===a.tools.baseService.getParam("frm")?void d(n.mod).hide():(window.$=window.jQuery=d,void d.ajax({url:"/box-static/disk-header/disk.header.js",dataType:"script",cache:!0}).done(function(){o.prototype.addIconFont=window.yunHeader.fontIe.api.addIconFont,a.message.listen("addIcon",function(e){a.addIconFont&&window.yunHeader.emit("addicon",e)})}))});
;define("disk-system:widget/start/start.js",function(e){e("disk-system:widget/data/yunData.js"),e("disk-system:widget/system/uiRender/header/header.js"),e("disk-system:widget/system/util/contextExtend.js"),e("disk-system:widget/router/initRouter.js"),e("disk-system:widget/pageModule/aside/aside.js"),e("disk-system:widget/system/fileService/fileOperateEntry.js"),e("service-widget-1:PageSetInvoker/main.js");var s=e("system-core:context/context.js").instanceForSystem;s.message.listen("ViewPanelChanged",function(s){var t=document.getElementById("layoutMain"),i=document.getElementById("layoutServiceHolder");s?(i.style.display="none",t.style.display="block",e("disk-system:widget/pageModule/list/listInit.js"),e("disk-system:widget/pageModule/toolbar/toolbar.js"),e("disk-system:widget/pageModule/toolbar/search.js"),e("disk-system:widget/system/uiRender/button/button.js"),e("disk-system:widget/system/uiRender/menu/menu.js")):(t.style.display="none",i.style.display="block")}),s.router.init()});