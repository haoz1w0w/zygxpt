window.theme={tools:{},ui:{AlertDialog:{},Slide:{},Panel:{},themeList:{},themePreview:{},canvas:{}},ark:{},themePanel:{},log:{},offline:{},start:{}};
;window.theme.tools={template:function(e,t){var n=function(){return e.replace(/\${(.*?)}/g,function(e,n){var i=n.indexOf("=")>-1;return i||"undefined"!=typeof t[n]?i?t[n.replace(/=/g,"")]||"":theme.tools.escapeHTML(t[n]):""})},i=function(){"undefined"==typeof t.classInclude||t.classInclude.test(location.href)||(t["class"]="")};return"undefined"!=typeof t&&"[object Object]"===Object.prototype.toString.call(t)&&("undefined"==typeof t.include||"undefined"!=typeof t.include&&t.include.test(location.href))?("undefined"!=typeof t["class"]&&i(),n()):""},escapeHTML:function(e){var t={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"};return e.replace(/&(?![\w#]+;)|[<>"']/g,function(e){return t[e]})},checkjQueryLib:function(e){var t=10,n=null,i=null,a=function(){n=window.$,i=window.jQuery,i&&n&&i===n?e(n):(t--,t>=0&&setTimeout(function(){a()},300))};a()},parseDateByStamp:function(e){for(var t=new Date(1e3*e),n=[t.getFullYear(),t.getMonth()+1,t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds()],i=0;i<n.length;i++){var a=n[i];9>=a&&(n[i]="0"+a)}return n=n.slice(0,3).join("-")},getDataValue:function(e){var t={yunData:["MYNAME","MYAVATAR","LOGINSTATUS","ISSVIP","ISVIP","VIPENDTIME","SERVERTIME"],FileUtils:["sysUserName","sysUserPhoto","loginState","is_svip","is_vip","systemTimestamp","timestamp"]},n="";if("undefined"!=typeof window.yunData)n=window.yunData[e];else if("undefined"!=typeof window.FileUtils)for(var i=0;i<t.yunData.length;i++){var a=t.yunData[i];if(a===e){n=window.FileUtils[t.FileUtils[i]]||"";break}}return n},createThemeLink:function(e){var t=document.createElement("link");t.rel="stylesheet",t.type="text/css",t.href="/box-static/disk-theme/disk.theme.css?t=1493778166132",t.onload=function(){e()},document.getElementsByTagName("head")[0].appendChild(t)},uniqueId:function(e){var t=0,n=++t+"";return e?e+n:n},getParam:function(e,t){e=e||location.search;var n=e.match(new RegExp(t+"=([^&]*)(&|$)"));return n&&n[1]?n[1]:""}};
;!function(){var i=function(i){this._mUI=i,this._mPrivateFlags=0,this._mCoor=[]};i.VISIBLE=1,i.TOP=4096,i.RIGHT=8192,i.BOTTOM=16384,i.LEFT=32768,i.CENTER=65536,i.prototype={setVisible:function(i){var t=(this._mPrivateFlags&window.theme.ui.Panel.VISIBLE)==window.theme.ui.Panel.VISIBLE;i!==t&&(i?(this._mPrivateFlags|=window.theme.ui.Panel.VISIBLE,this._mUI.pane.style.display="block"):(this._mPrivateFlags&=~window.theme.ui.Panel.VISIBLE,this._mUI.pane.style.display="none"),this.onVisibilityChange(i))},setVisibleAnimation:function(i,t){var e=(this._mPrivateFlags&window.theme.ui.Panel.VISIBLE)==window.theme.ui.Panel.VISIBLE;i!==e&&(i?(this._mPrivateFlags|=window.theme.ui.Panel.VISIBLE,$(this._mUI.pane).css({display:"block",opacity:0}).animate({opacity:t},500)):(this._mPrivateFlags&=~window.theme.ui.Panel.VISIBLE,$(this._mUI.pane).hide().css("opacity",0)),this.onVisibilityChange(i))},isVisible:function(){return(this._mPrivateFlags&window.theme.ui.Panel.VISIBLE)==window.theme.ui.Panel.VISIBLE},setSize:function(i,t){this._mUI.pane.style.width=i+"px",this._mUI.pane.style.height=t+"px"},setLocation:function(i,t){t=Math.max(0,t),this._mUI.pane.style.left=i+"px",this._mUI.pane.style.top=t+"px",this._mCoor[0]=i,this._mCoor[1]=t},getLocation:function(){return this._mCoor},setGravity:function(t){switch(t){case i.LEFT:this.setLocation(0,0);break;case i.CENTER:this.setLocation(($(window).width()-this._mUI.pane.offsetWidth)/2,($(window).height()-this._mUI.pane.offsetHeight)/2+$(window).scrollTop());break;case i.BOTTOM:this.setLocation(($(window).width()-this._mUI.pane.offsetWidth)/2,$(window).height()-this._mUI.pane.offsetHeight+$(window).scrollTop());break;case i.TOP:this.setLocation(($(window).width()-this._mUI.pane.offsetWidth)/2,65)}},onVisibilityChange:function(){},getPanelUI:function(){return this._mUI}},window.theme.ui.Panel=i}();
;var theme=window.theme||{};!function(){var t=function(t){var t=t||{};this._mTitleId=disk.obtainId(),this._mMsgContentId=disk.obtainId(),this._mCloseId=disk.obtainId(),this._mSubmitId=disk.obtainId(),this._mCancelId=disk.obtainId(),this._mOneButtonId=disk.obtainId(),this._mPosition="",this._withCanvas=t.withCanvas,this._canvasObj=null,theme.ui.Panel.call(this,this._prebuild(this._mTitleId,this._mMsgContentId,this._mCloseId,this._mSubmitId,this._mCancelId,this._mOneButtonId)),this._mOnConsent=null,this._mOnCancel=null,this.build()};t.prototype=new theme.ui.Panel,t.prototype._prebuild=function(t,e,i,n,s,a){var l=document.createElement("div");return l.className="b-panel theme-b-dialog theme-alert-dialog header-theme-alert-dialog",document.body.appendChild(l),l.innerHTML='<div class="dlg-hd b-rlv"><div title="\u5173\u95ed" id="'+i+'" class="dlg-cnr dlg-cnr-r icon icon-close"></div><h3 id="'+t+'">\u786e\u8ba4\u64cd\u4f5c</h3></div><div class="dlg-bd"><div id="'+e+'" class="theme-alert-dialog-msg center"></div></div><div class="dlg-ft b-rlv"><div class="theme-alert-dialog-commands clearfix center"><a href="javascript:;" id="'+n+'" class="sbtn okay"><b>\u786e\u5b9a</b></a><a href="javascript:;" id="'+s+'" class="dbtn cancel"><b>\u53d6\u6d88</b></a></div><div class="clearfix theme-alert-dialog-commands-plus" ><a id="'+a+'" href="javascript:;" class="dbtn okay"><b>\u5173\u95ed</b></a></div></div>',{pane:l}},t.prototype.setVisible=function(t,e,i,n){n?this.setCss3Animate(n,t):theme.ui.Panel.prototype.setVisible.call(this,t),t&&(e&&"string"==typeof e?$(this._mUI.pane).hasClass("share_update_dialog")===!1&&$(this._mUI.pane).addClass("share_update_dialog"):$(this._mUI.pane).hasClass("share_update_dialog")&&$(this._mUI.pane).removeClass("share_update_dialog"),this._mPosition=i,this.setGravity(i||theme.ui.Panel.CENTER))},t.prototype.setCss3Animate=function(t,e){var i=this;e&&theme.ui.Panel.prototype.setVisible.call(this,e);var n=$(this._mUI.pane);n.addClass(t+" theme-animated");var s=function(){for(var t,e=document.createElement("div").style,i=["a","webkitA","MozA","OA","msA"],n=["animationend","webkitAnimationEnd","animationend","oAnimationEnd","MSAnimationEnd"],s=0,a=i.length;a>s;s++)if(t=i[s]+"nimation",t in e)return n[s];return"animationend"}(),a=function(){n.get(0).removeEventListener(s,a,!1),n.removeClass(t+" theme-animated"),e||theme.ui.Panel.prototype.setVisible.call(i,e)};this.supportCss3("animation")?n.get(0).addEventListener(s,a,!1):theme.ui.Panel.prototype.setVisible.call(this,e)},t.prototype.supportCss3=function(t){var e=["webkit","Moz","ms","o"],i=[],n=document.documentElement.style,s=function(t){return t.replace(/-(\w)/g,function(t,e){return e.toUpperCase()})};i.push(s(t));for(var a=e.length,l=0;a>l;l++)i.push(s(e[l]+"-"+t));for(var o=0;o<i.length;o++)if(i[o]in n)return!0;return!1},t.prototype.setHeaderShow=function(t){t?$(this._mUI.pane).find(".dlg-hd").show():$(this._mUI.pane).find(".dlg-hd").hide()},t.prototype.addClassName=function(t){var e=$(this._mUI.pane).attr("class");t&&e.indexOf(t)<0&&$(this._mUI.pane).addClass(t)},t.prototype.onVisibilityChange=function(t){this._withCanvas!==!1&&(null==this._canvasObj&&(this._canvasObj=new theme.ui.canvas),this._canvasObj.setVisible(t))},t.prototype.setMessage=function(t,e,i,n,s,a,l){return this._mOnConsent=i||null,this._mOnCancel=n||null,$("#"+this._mTitleId).html(t),$("#"+this._mMsgContentId).html(e),s&&$("#"+this._mSubmitId).find("b").html(s),a&&$("#"+this._mCancelId).find("b").html(a),l&&$("#"+this._mOneButtonId).find("b").html(l),this.setGravity(theme.ui.Panel.CENTER),this},t.prototype.build=function(){var t=this;$(window).bind("resize",function(){t.setGravity(t._mPosition||theme.ui.Panel.CENTER)}),$(".okay",this._mUI.pane).click(function(){return null==t._mOnConsent?t.setVisible(!1):t._mOnConsent.call(t),!1}),$(".cancel, #"+this._mCloseId,this._mUI.pane).click(function(){return t.setVisible(!1),"function"==typeof t._mOnCancel&&t._mOnCancel.call(t),!1})},theme.ui.AlertDialog=t}();
;!function(){var t=function(){theme.ui.Panel.call(this,this._prebuild()),this._init(),this._mCallReferCount=0,this._mBlurCallback=null};t.prototype=new theme.ui.Panel,t.prototype._prebuild=function(){var t=document.createElement("div");return t.className="b-panel theme-b-canvas",document.body.appendChild(t),{pane:t}},t.prototype._checkCallReferCount=function(t){return t?this._mCallReferCount++:this._mCallReferCount--,t===!0?!0:this._mCallReferCount<=0},t.prototype.setVisible=function(t){this._checkCallReferCount(t)&&(this.setGravity(theme.ui.Panel.LEFT),this._size(),theme.ui.Panel.prototype.setVisible.call(this,t))},t.prototype.setVisibleAnimation=function(t,e){this._checkCallReferCount(t)&&(this.setGravity(theme.ui.Panel.LEFT),this._size(),theme.ui.Panel.prototype.setVisibleAnimation.call(this,t,e))},t.prototype._size=function(){this.setSize(0,0);{var t="CSS1Compat"!=document.compatMode||$.browser.safari?document.body.scrollWidth:document.documentElement.scrollWidth;Math.max(t,$(window).width())}this.setSize(t,$(document).height())},t.prototype.setOnBlurCallback=function(t){this._mBlurCallback=t},t.prototype._init=function(){var t=this;$(window).bind("resize",function(){t.isVisible()&&t._size()}),this._mUI.pane.onclick=function(){null!=t._mBlurCallback&&t._mBlurCallback.call(t)}},window.theme.ui.canvas=t}();
;!function(t){var e=t,n=[],r={},o={},i={},a=null,s=0,l=null,c=1e4,h=50,u=10,m="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),f="__inline__dummy_name__",_=/(loaded|complete)/gi;if("undefined"!=typeof e.themeArk)throw new Error("the ark package was shadowed by global variable of ark");var d=function(t){return"object"==typeof t&&"undefined"!=typeof t.length&&"function"==typeof t.splice},g=function(t){return"object"==typeof t&&null!=t&&!("splice"in t)},p=function(t){if(d(t))for(var e=t.length,n=0,r=null,o=0,i=0;e>n;){if(r=t[n],i=1,d(r)&&(o=r.length,r.unshift(n,1),Array.prototype.splice.apply(t,r),0==o&&(i=0),e=t.length,r=t[n]),g(r)&&d(r.url)){for(var a=r.url,s=null,l=null,c=0,h=a.length;h>c;c++){if(s=a[c],"string"!=typeof s)throw new Error("not supporting embed declaration of sophiscated inline url array");l={};for(var u in r)r.hasOwnProperty(u)&&"url"!=u&&(l[u]=r[u]);l.url=s,a[c]=l}0==a.length&&(i=0),a.unshift(n,1),Array.prototype.splice.apply(t,a),e=t.length}n+=i}return t},y=function(){var t=navigator.userAgent,e={};return m?(e.opera=1,/Opera\/([\d\.]+)/gi.test(t)&&(e.opera=parseFloat(RegExp.$1))):/AppleWebKit\/([\d\.]+)/gi.test(t)?(e.webkit=parseFloat(RegExp.$1),/Chrome\/([\d\.]+)/gi.test(t)&&(e.chrome=parseFloat(RegExp.$1))):/MSIE ([\d\.]+)/gi.test(t)?e.ie=parseFloat(RegExp.$1):/Gecko\/[^\s]*/gi.test(t)&&(e.gecko=1,/rv:([^\s\)]*)/.test(t)&&(e.gecko=parseFloat(RegExp.$1))),e}();e.themeArk={DEBUG:!1,GLOBAL_CALLBACK:null,setDebugEnabled:function(t){this.DEBUG=t},id:function(){return++s},conf:function(t){if(i=t||{},"undefined"!=typeof i.view){var n=e.themeArk;delete e.themeArk,e=i.view,e.themeArk=n}},getLooper:function(){return l},hasError:function(){var t=arguments.callee.caller.arguments.length;return a.log("testing callee argument length "+t),0==t},log:"undefined"!=typeof console?function(t){this.DEBUG&&console.log("[ArkDebugLog] ",t)}:function(){},error:"undefined"!=typeof console?function(t){this.DEBUG&&console.error("[ArkDebugLog] ",t)}:function(){},debug:function(){a.log("queue:"+n),a.log("_cache: "+r);for(var t in r)r.hasOwnProperty(t)&&a.log("_cache entity=>"+t+":"+r[t]);for(var e in y)y.hasOwnProperty(e)&&a.log("env "+e+":"+y[e]);a.log("has css load feature=>"+a.CSSLoader.hasCSSLoadFeature()),a.log("exports bridge: "+i.exports)},packageCached:function(t){return this.cached(a.MessageLooper.toCacheKey(t))},cached:function(t){return"undefined"!=typeof r[t]},cache:function(t,e){a.log("cache "+t+" with value "+e),r[t]=e},assert:function(t,e){if("boolean"==typeof t&&!t)throw this.log(e),new Error("assert failure:"+e)},exports:function(t,n,r){if(i.exports){var o=t.split(".");o[0]!=i.exports&&o.unshift(i.exports),o.pop();for(var a=e,s=null;o.length>0;)s=o.shift(),a[s]||(a[s]={}),a=a[s];a[n]=r}}},a=e.themeArk,a.each="undefined"!=typeof Array.prototype.forEach?function(t,e){Array.prototype.forEach.call(t,e)}:function(t,e){if("undefined"==typeof item||"undefined"==typeof item.length||"function"!=typeof e)throw new Error("argument error");for(var n=0,r=t.length;r>n;n++)e.call(t,t[n],n)};var v=function(){this._mPrivateFlags=0,this._mCallback=null,this._mIOConf=null,this._mNode=null};v._sInstance=null,v.SUCCESS=0,v.FAILURE=1,v.LOADING=2,v.getInstance=function(){return v._sInstance?v._sInstance:v._sInstance=new v},v.prototype={constuctor:v,load:function(t,e){this._mCallback=e,this._mIOConf=t;var n=this._build(),r=!1;if(document){var o=document.getElementsByTagName("head");o&&(o[0].appendChild(n),r=!0)}r||(a.log("insert failed, document was not ready"),"function"==typeof e&&e.call(this,v.FAILURE)),this._mNode=n},_remove0:function(){if(this._mNode){var t=this._mNode.getAttribute("_install");"0"===t?(this._mNode.detachEvent("onreadystatechange",this._mInnerSucc),this._mNode.detachEvent("onerror",this._mInnerFail)):"1"===t&&(this._mNode.removeEventListener("load",this._mInnerSucc),this._mNode.removeEventListener("error",this._mInnerFail)),this._mNode=null}},_handleLoad:function(t){_.lastIndex=0,a.log("load complete "+this._mIOConf.url),("load"==t.type||_.test((t.currentTarget||t.srcElement).readyState))&&(a.log("load complete with url "+this._mIOConf.url),"function"==typeof this._mCallback&&this._mCallback.call(this,v.SUCCESS),this._remove0())},_handleError:function(){a.log("load failure "+this._mIOConf.url),"function"==typeof this._mCallback&&this._mCallback.call(this,v.FAILURE),this._remove0()},_build:function(){var t=i.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");t.type=this._mIOConf.scriptType||i.scriptType||"text/javascript",t.charset=this._mIOConf.charset||i.charset||"utf-8",t.async=!0;var e=this,n=function(t){a.log(arguments,"<===succ"),e._handleLoad(t)},r=function(t){a.log(arguments,"<===error"),e._handleError(t)};this._mInnerSucc||(this._mInnerSucc=n,this._mInnerFail=r),!t.attachEvent||t.attachEvent.toString&&t.attachEvent.toString().indexOf("[native code")<0||m?(t.addEventListener("load",n),t.addEventListener("error",r),t.setAttribute("_install","1")):(t.attachEvent("onreadystatechange",n),t.attachEvent("onerror",r),t.setAttribute("_install","0"));var o=a.MessageLooper.normalize(this._mIOConf.url,this._mIOConf.timestamp||i.timestamp||Math.random());return t.src=o,t}},a.ScriptLoader=v;var E=function(){this._mPrivateFlags=0,this._mCallback=null,this._mIOConf=null,this._mNode=null,this._mHasCSSLoad=a.CSSLoader.hasCSSLoadFeature(),this._mPollingTimer=null,this._mPollingStart=0,this._mStylesheets=0};E._sInstance=null,E.SUCCESS=0,E.FAILURE=1,E.LOADING=2,E.LOADING=1,E.getInstance=function(){return E._sInstance?E._sInstance:E._sInstance=new E},E.hasCSSLoadFeature=function(){return y.ie?!0:y.chrome?y.chrome>18:y.opera>0||y.gecko&&y.gecko>=9||y.webkit&&y.webkit>535.24},E.prototype={constructor:E,load:function(t,e){if(this._mIOConf=t||{},this._mCallback=e,!this._mIOConf.url)throw new Error("url required to load css");var n=this._build(),r=!1,o=E.LOADING;if((this._mPrivateFlags&o)==o)return void a.log("CSSLoader still working, may supporting parral loading in the coming future");if(this._mPrivateFlags|=o,document){var i=document.getElementsByTagName("head");i&&(i[0].appendChild(n),r=!0)}r||(a.log("insert failed, document was not ready"),"function"==typeof e&&e.call(this,E.FAILURE)),this._mNode=n},_remove0:function(){if(this._mNode){var t=this._mNode.getAttribute("_install");"0"===t?(this._mNode.detachEvent("onreadystatechange",this._mInnerSucc),this._mNode.detachEvent("onerror",this._mInnerFail)):"1"===t&&(this._mNode.removeEventListener("load",this._mInnerSucc),this._mNode.removeEventListener("error",this._mInnerFail)),this._mNode=null}},_handleLoad:function(t){var e=E.LOADING;this._mPrivateFlags&=~e,_.lastIndex=0,("load"==t.type||_.test((t.currentTarget||t.srcElement).readyState))&&(a.log("load css complete "+this._mIOConf.url),"function"==typeof this._mCallback&&this._mCallback.call(this,E.SUCCESS),this._remove0())},_handleError:function(){a.log("load css failure "+this._mIOConf.url);var t=E.LOADING;this._mPrivateFlags&=~t,this._remove0(),"function"==typeof this._mCallback&&this._mCallback.call(this,E.FAILURE)},_checkAvailable:function(){if(!y.gecko)return a.log("check stylesheet length=>"+document.styleSheets.length+":"+this._mStylesheets),document.styleSheets.length>this._mStylesheets&&this._mNode.sheet.cssRules.length>0;var t=this._mNode.sheet;try{return t&&t.cssRules&&t.cssRules.length}catch(e){return!1}},_buildNode:function(){var t=i.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:link"):document.createElement("link");return t.rel="stylesheet",t.type="text/css",t},_stop0:function(){clearInterval(this._mPollingTimer),this._mPollingTimer=null,this._mPollingStart=0,this._mStylesheets=0},_polling:function(){a.log("polling for css "+this._mIOConf.url);var t=E.LOADING,e=(this._mPrivateFlags&t)==t;if(!e&&this._mPollingTimer)clearInterval(this._mPollingTimer),this._mPollingTimer=null;else if(this._checkAvailable())this._stop0(),this._handleLoad({type:"load"});else{var n=(new Date).getTime();n-this._mPollingStart>(this._mIOConf.timeout||c)&&(this._stop0(),this._handleError())}},_build:function(){var t=this,e=function(e){t._handleLoad(e)},n=function(e){t._handleError(e)};this._mInnerSucc||(this._mInnerSucc=e,this._mInnerFail=n);var r=this._mHasCSSLoad,o=a.MessageLooper.normalize(this._mIOConf.url,this._mIOConf.timestamp||i.timestamp||Math.random()),s=null;return r?(s=this._buildNode(),!s.attachEvent||s.attachEvent.toString&&s.attachEvent.toString().indexOf("[native code")<0||m?(s.addEventListener("load",e),s.addEventListener("error",n),s.setAttribute("_install","1")):(s.attachEvent("onreadystatechange",e),s.attachEvent("onerror",n),s.setAttribute("_install","0")),s.href=o):(y.gecko?(s=i.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:style"):document.createElement("style"),s.type="text/css",s.innerHTML=(this._mIOConf.charset?'@charset "'+this._mIOConf.charset+'";':"")+'@import "'+this._mIOConf.url+'";'):(s=this._buildNode(),s.href=o),this._mPollingTimer=setInterval(function(){t._polling()},h),this._mPollingStart=(new Date).getTime(),this._mStylesheets=document.styleSheets.length),s}},a.CSSLoader=E;var T=function(){this._mPrivateFlags=0,this._mTransactions=[],this._mTransaction=null,this._mPollingTimer=null,this._mInterruptCounter=0,this._mStart=0};T.PATTERN_PACK=/\./gi,T.PATTERN_CACHE_KEY=/[\.\/\\]+/gi,T.LOADING=1,T.LOOPING=2,T.FETAL=4,T.POLLING_INTERVAL=32,T.INTERRUPT_THRESHOLD=10,T.MAX_RETRY=1,T.TYPE_CSS="css",T.TYPE_JS="js",T.PATTERN_TYPE=/\.(js|css)$/gi,T.PATTERN_EXT=/\.\w+$/gi,T.SCHEMA=/^\w+:\/\//gi,T.PATTERN_PACKAGE=/^\w+(?:\.\w+)+$/gi,T.normalize=function(t,e){if("undefined"==typeof e||null==e)return t;var n=-1!=t.indexOf("?"),r=t.substring(t.length-1);return"&"==r?t+"t="+e:n?t+"&t="+e:t+"?t="+e},T.translate=function(t){return t.replace(T.PATTERN_PACK,"/")},T.toCacheKey=function(t){return t.replace(T.PATTERN_CACHE_KEY,"_").toLowerCase()},T.PATTERN_TRIM=/^\s+|\s+$/gi,T.trim=function(t){return t.replace(T.PATTERN_TRIM,"")},T.prototype={constructor:T,scheduled:function(t,e,n){var r=null;if(r=this._mTransaction,null!=r&&this._isItemMatch(t,e,n,r))return!0;for(var o=0,i=this._mTransactions.length;i>o;o++)if(r=this._mTransactions[o],this._isItemMatch(t,e,n,r))return!0;return!1},_isItemMatch:function(t,e,n,r){if(t!=f&&r.getPack()!=t)return!1;if(this._isRequirementMatch(r,n)){if(t==f&&e.toString()==r.getFn().toString())return!0;if(t!=f&&r.getPack()==t)return!0}return!1},_isRequirementMatch:function(t,e){var n=t.getRequirements(),r=n.length,o=null,i=null;if(r!=e.length)return!1;if(0==r)return!0;for(var a=0;r>a;a++)if(o="string"==typeof n[a]?n[a]:n[a].url,i="string"==typeof e[a]?e[a]:e.url,o!=i)return!1;return!0},enqueue:function(t,e,r){var o=T.FETAL;if((this._mPrivateFlags&o)!=o||!a.DEBUG){if(this.scheduled(t,e,r))return void a.log(t+" scheduled already<"+r.join(", >"));null!=this._mTransaction&&(this._mTransaction.loadedOver()||(a.log("push back "+this._mTransaction.getPack()),n.unshift(this._mTransaction))),this._mTransaction=null,n.unshift(new C(t,e,r)),this._start0()}},_start0:function(){var t=T.LOOPING,e=this;(this._mPrivateFlags&t)!=t&&(a.log("message looper polling timer start..."),this._mPollingTimer=setInterval(function(){e._loop()},T.POLLING_INTERVAL),this._mInterruptCounter=0,this._mPrivateFlags|=t,this._mStart=(new Date).getTime())},_stop0:function(){clearInterval(this._mPollingTimer),this._mPollingTimer=null,this._mPrivateFlags&=~T.LOOPING,this._mInterruptCounter=0},parseTypeof:function(t){var e=null,n=null;if("string"==typeof t)e=this.parseTypeFromUrl(t),n={type:e,url:t};else{if("undefined"==typeof t.url)throw new Error("the arguments in {use} is required carrying url info");e=t.type==T.TYPE_JS||t.type==T.TYPE_CSS?t.type:this.parseTypeFromUrl(t.url),n=t,n.type=e}return n.bundle=n.url,"undefined"==typeof n.noDependency&&(n.noDependency=n.type==T.TYPE_CSS),n.enforceUrl===!0||this.normalizeUrl(n),n},_quickNormalizeUrl:function(t){return"string"==typeof t?t:(t.bundle=t.url,t)},normalizeUrl:function(t){var e=t.url;if(e.indexOf("/")>-1)T.PATTERN_EXT.lastIndex=0,T.PATTERN_EXT.test(e)||(e+="."+t.type);else if(T.PATTERN_TYPE.lastIndex=0,T.PATTERN_TYPE.test(e)){var n="."+RegExp.$1;e=e.replace(T.PATTERN_TYPE,function(){return""}),e=T.translate(e),e+=n}else e=T.translate(e),e+="."+t.type;T.PATTERN_PACKAGE.lastIndex=0,i.exports&&T.PATTERN_PACKAGE.test(t.bundle)&&0==e.indexOf(i.exports+"/")&&(e=e.substring(i.exports.length+1)),T.SCHEMA.lastIndex=0;var r=T.SCHEMA.test(e);if(r&&t.type==T.TYPE_JS&&(t.noDependency=!0),!r&&"undefined"!=typeof i.baseUrl){var o=t.type==T.TYPE_JS?i.baseUrl[0]:i.baseUrl[1],a=o.lastIndexOf("/"),s=e.indexOf("/");a==o.length-1&&0==s?e=e.substring(1):a!=o.length-1&&0!=s&&(e="/"+e),e=o+e}t.url=e},parseTypeFromUrl:function(t){return t=T.trim(t),T.PATTERN_TYPE.lastIndex=0,T.PATTERN_TYPE.test(t)?RegExp.$1:T.TYPE_JS},_load:function(t){var e=T.LOADING,n=this,r=this.parseTypeof(t);this._mPrivateFlags|=e,r.type==T.TYPE_CSS?("function"==typeof i.callback&&i.callback.call(a,a.CSSLoader.LOADING),a.CSSLoader.getInstance().load(r,function(t){if(a.log("****CSS:loading status of url "+this._mIOConf.url+"========="+(t==E.SUCCESS)),n._mPrivateFlags&=~e,"function"==typeof i.callback&&i.callback.call(a,t),t==E.SUCCESS){var o=T.toCacheKey(r.bundle);a.cache(o,!0)}})):("function"==typeof i.callback&&i.callback.call(a,a.ScriptLoader.LOADING),a.ScriptLoader.getInstance().load(r,function(t){if(a.log("****JS:loading status of url "+this._mIOConf.url+"========="+(t==v.SUCCESS)),n._mPrivateFlags&=~e,"function"==typeof i.callback&&i.callback.call(a,t),T.SCHEMA.lastIndex=0,r.noDependency||T.SCHEMA.test(r.url)){var o=T.toCacheKey(r.bundle);a.cache(o,!0),a.log("encounter an no dependency script")}}))},_loop:function(){var t=T.LOADING,e=null;if((this._mPrivateFlags&t)==t)return void a.log("still loading...");if(a.log("looping now"),null!=this._mTransaction)if(this._mTransaction.hasRequirement()){for(var i=null;null!=(i=this._mTransaction.next());){e=T.toCacheKey("string"==typeof i?i:i.url);{if(!a.cached(e)){this._load(i);break}this._quickNormalizeUrl(i)}}if(null==i){var s=[],l=null,c=!1,h=this;if(a.log("resolve requirements of "+this._mTransaction.getPack()),a.each(this._mTransaction.getRequirements(),function(t,n){e=T.toCacheKey("string"==typeof t?t:t.bundle),a.cached(e)?(l=r[e],s[n]="boolean"==typeof l?null:l):(a.log("error in "+h._mTransaction.getPack()),c=!0)}),e=T.toCacheKey(this._mTransaction.getPack()),!c){var u=null;try{u=this._mTransaction.getFn().apply(a,s)}catch(m){if(a.error("the callback of module "+this._mTransaction.getPack()+" is supposed to have error"),a.error("error: "+m.message),a.DEBUG)throw this._stop0(),this._mPrivateFlags|=T.FETAL,m;u=!0}e!=f&&(a.cache(e,u),delete o[e])}if(e==f&&c){a.log("report root failure");var _=o[this._mTransaction.getId()];if("undefined"==typeof _?_=0:_++,o[this._mTransaction.getId()]=_,_<T.MAX_RETRY-1)a.log("guys, retry to figure out dependency chain at "+_),this._mTransaction.loadOver();else{delete o[this._mTransaction.getId()];try{this._mTransaction.getFn().apply(a)}catch(m){if(a.error("the top callback is supposed to have error"),a.error("error: "+m.message),a.DEBUG)throw this._stop0(),this._mPrivateFlags|=T.FETAL,m}this._mTransaction=null}}else this._mTransaction=null}}else{if(e=T.toCacheKey(this._mTransaction.getPack()),!a.cached(e)){var u=null;try{u=this._mTransaction.getFn().apply(a,this._mTransaction.getRequirements())}catch(m){if(a.error("the callback of module "+this._mTransaction.getPack()+" is supposed to have error"),a.error("error: "+m.message),a.DEBUG)throw this._stop0(),this._mPrivateFlags|=T.FETAL,m;u=!0}e!=f&&(a.cache(e,u),a.log("start cache no dependency item "+e))}this._mTransaction=null}else if(0==n.length){if(this._mInterruptCounter++,this._mInterruptCounter>T.INTERRUPT_THRESHOLD){a.log("looper idle, is about to shutting down"),this._stop0();var d=(new Date).getTime();a.log("cost "+(d-this._mStart)/1e3+"s to complete the session, hm, you should minus "+T.POLLING_INTERVAL*T.INTERRUPT_THRESHOLD+"ms idle")}}else this._mTransaction=n.shift(),a.log("take=>"+this._mTransaction.getPack())}},a.MessageLooper=T,l=new T,a.parseTypeFromUrl=l.constructor.prototype.parseTypeFromUrl,a.parseTypeof=l.constructor.prototype.parseTypeof,a.normalizeUrl=l.constructor.prototype.normalizeUrl;var C=function(t,e,n){this._mPack=t,this._mFn=e,this._mReq=n,this._mCursor=-1,this._mId=a.id()};C.prototype={constuctor:C,next:function(){return this._mCursor<this._mReq.length&&this._mCursor++,this._mCursor>this._mReq.length-1?null:this._mReq[this._mCursor]},getId:function(){return this._mId},prev:function(){return this._mCursor>-1&&this._mCursor--,this._mCursor<0?null:this._mReq[this._mCursor]},hasRequirement:function(){return this._mReq.length>0},getFn:function(){return this._mFn},getPack:function(){return this._mPack},getRequirements:function(){return this._mReq},loadedOver:function(){return 0==this._mReq.length||this._mCursor>this._mReq.length-1},loadOver:function(){this._mCursor=-1}};var I=function(t,e,n){var o=null;if(n.length>0){for(var i=!0,s=[],l=0,c=n.length;c>l;l++)o=a.MessageLooper.toCacheKey("string"==typeof n[l]?n[l]:n[l].url),a.cached(o)?s.push(r[o]):i=!1;return t==f||(o=a.MessageLooper.toCacheKey(t),i=i&&a.cached(o)),i&&e.apply(a,s),i}return t==f?(e.call(a),!0):(o=a.MessageLooper.toCacheKey(t),a.cached(o)?(e.call(a,"boolean"==typeof r[o]?null:r[o]),!0):!1)};a.match=I;var S=function(){a.log("before add in queue "+arguments[0]);var t=arguments;if(t.length<2)throw new Error("require one param at least");var e=[],n=t[t.length-1],r=t[0];if("function"!=typeof n)throw new Error("the trailing argument should be a callback function");if("string"!=typeof r||0==r.length)throw new Error("the leading argument should be a legal name");if(t.length>2&&(e=Array.prototype.slice.call(t,1,t.length-1)),e=p(e),e.length>(i.maxInlineDependency||u))throw new Error("too many dependency request, why would you think about combining some of them together to reduce amount");return a.match(r,n,e)?void a.log("{matching a cache for '"+r+" request "+e.join(", ")+"'}"):void l.enqueue(r,n,e)};a.add=S;var P=function(t){var e="string"==typeof t?{url:t}:t;e.noDependency=!0,a.use.call(a.use,e,function(){})};a.addCacheHint=P;var A=function(){var t=Array.prototype.slice.call(arguments,0);S.apply(S,[f].concat(t))};e.theme.ark.use=A}(window);
;var theme=window.theme||{};theme.themePanel.conf={},theme.themePanel.init=function(e){var t={q:{panel:".theme-panel",close:".dialog-control .close",themePanelContentLeft:".theme-panel-content-left",themePanelContentRight:".theme-panel-content-right"},conf:{panel:theme.themePanel.conf.themePanelObj},cb:e,init:function(){var e=function(){return $(t.q.panel).length>0&&!$(t.q.panel).is(":hidden")?!1:(t.conf.panel?t.util.getTheme(function(e){t.util.openPanel(e)}):(t.util.loadCss(),t.util.getTheme(function(e){t.util.openPanel(e),t.util.bindEvents()})),void t.util.setDefaultTheme())},n=function(){window.theme.ark.use({url:["/box-static/disk-theme/js/libs/underscore.js?t=1493778166132"],noDependency:!0},function(){e()})};window.theme.ark?n():window.yunHeader.tools.ui.tip.show({msg:"\u5207\u6362\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\uff01",type:"failure"})},util:{loadCss:function(e){theme.tools.createThemeLink(function(){$.isFunction(e)&&e()})},getTheme:function(e){$.ajax({type:"GET",url:"/disk/cmsdata/skin?do=skinList&time="+(new Date).getTime(),data:{},dataType:"json",success:function(t){var n={list:[]},a=t.content[0].skins,i=0;for(var l in a)n.list.push(a[l]),a[l].name===(theme.themePanel.conf.defaultThemeName||window.yunData.skinName)&&(a[l].isChecked=!0,theme.themePanel.conf.checkIndex=i),i++;$.isFunction(e)&&e(n)}})},openPanel:function(e){t.conf.panel||(t.conf.panel=theme.themePanel.conf.themePanelObj=new theme.ui.AlertDialog({withCanvas:!1})),t.conf.panel.setMessage("\u5207\u6362\u4e3b\u9898",_.template(theme.themePanel.tpl.backgroundDiv)({})+_.template(theme.themePanel.tpl.header)({})+theme.themePanel.tpl.content,function(){t.util.confirm()},function(){t.util.cancel()}),t.conf.panel.setHeaderShow(!1),t.conf.panel.addClassName("theme-panel");var n=new theme.ui.Slide({parent:$(t.q.panel).find(t.q.themePanelContentLeft),data:e});n.setPageByCheckIndex(theme.themePanel.conf.checkIndex),t.util.showDefaultPreview(e),setTimeout(function(){t.conf.panel.setVisible(!0,"",theme.ui.Panel.BOTTOM,"fadeInUp")},100),window.theme.log.send("","openThemePanel")},closePanel:function(){t.conf.panel.setVisible(!1,"","","fadeOutDown"),$.isFunction(t.cb)&&t.cb()},confirm:function(){t.util.saveTheme(),$.isFunction(t.cb)&&t.cb()},cancel:function(){var e=theme.themePanel.conf.checkedTheme,n=theme.themePanel.conf.defaultThemeName;e&&e!==n?(t.util.notSaveConfirm(),t.conf.panel.setVisible(!0,"",theme.ui.Panel.BOTTOM)):(t.conf.panel.setVisible(!0,"",theme.ui.Panel.BOTTOM),t.util.closePanel())},showDefaultPreview:function(e){{var n=theme.themePanel.conf.checkIndex||0;theme.ui.themePreview.init({parent:$(t.q.themePanelContentRight),previewImg:e.list[n].preview})}},backToSelfTheme:function(){var e=theme.themePanel.conf.checkedTheme=theme.themePanel.conf.defaultThemeName||"white",t=$('link[node-type="theme-link"]'),n=t.attr("href"),a=n.replace(/\/theme\/(.*)\//,"/theme/"+e+"/");t.attr({href:a})},saveTheme:function(e){t.util.setUserTheme(function(n){0===n.errno?(t.util.closePanel(),t.util.setDefaultTheme(n.value),window.yunHeader.tools.ui.tip.show({msg:"\u76ae\u80a4\u5e94\u7528\u6210\u529f\uff01",type:"success"})):2===n.errno?t.util.themeOfflineAlert():(window.yunHeader.tools.ui.tip.show({msg:"\u76ae\u80a4\u5e94\u7528\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\uff01",type:"failure"}),$.isFunction(e)&&e(n))})},setUserTheme:function(e){var n=theme.themePanel.conf.checkedTheme,a=theme.themePanel.conf.defaultThemeName;return n&&n!==a?($.ajax({type:"GET",url:"/api/userstorage/set",data:{key:"SKIN_WEB",value:n},dataType:"json",success:function(t){$.isFunction(e)&&(t.value=n,e(t))}}),void window.theme.log.send("","confirmTheme",n)):(t.util.closePanel(),!1)},setDefaultTheme:function(e){theme.themePanel.conf.defaultThemeName=e||theme.themePanel.conf.defaultThemeName?e||theme.themePanel.conf.defaultThemeName:window.yunData.skinName},notSaveConfirm:function(){var e;theme.themePanel.conf.notSaveConfirm||(theme.themePanel.conf.notSaveConfirm=new theme.ui.AlertDialog),e=theme.themePanel.conf.notSaveConfirm,e.setMessage("\u63d0\u793a","\u662f\u5426\u4f7f\u7528\u9009\u62e9\u7684\u76ae\u80a4\uff1f",function(){t.util.closePanel(),e.setVisible(!1),t.util.saveTheme(function(){t.util.backToSelfTheme()})},function(){t.util.backToSelfTheme(),t.util.closePanel(),e.setVisible(!1)},"\u662f","\u5426"),e.addClassName("not-save-dialog"),e.setVisible(!0)},themeOfflineAlert:function(){var e;theme.themePanel.conf.themeOfflineAlert||(theme.themePanel.conf.themeOfflineAlert=new theme.ui.AlertDialog),e=theme.themePanel.conf.themeOfflineAlert,e.setMessage("\u63d0\u793a","\u554a\u54e6\uff0c\u60a8\u9009\u62e9\u7684\u76ae\u80a4\u5df2\u4e0b\u7ebf\uff0c\u8bf7\u53bb\u6311\u9009\u5176\u4ed6\u76ae\u80a4\u5427\uff1f",function(){theme.ui.themeList.checkByName(theme.themePanel.conf.defaultThemeName),e.setVisible(!1,"","","fadeOutDown")}),e.addClassName("not-save-dialog"),e.setVisible(!0,"onebutton")},bindEvents:function(){$(t.q.panel).on("click",t.q.close,function(){t.util.cancel()})}}};t.init(e)};
;var theme=window.theme||{};theme.themePanel.tpl={header:['<div class="theme-panel-header">','<div class="theme-panel-header-m">','<div class="theme-panel-type">',"<ul>","<li>\u9009\u62e9\u76ae\u80a4</li>","</ul>","</div>",'<div class="dialog-control"><span class="icon close">&#xe92b;</span></div>',"</div>","</div>"].join(""),content:['<div class="theme-panel-content">','<div class="theme-panel-content-m">','<div class="theme-panel-content-left"></div>','<div class="theme-panel-content-right"></div>','<div class="cb"></div>',"</div>","</div>"].join(""),backgroundDiv:['<div class="theme-panel-bg"></div>'].join("")};
;var theme=window.theme||{};!function(){var t=function(t){var t=t||{};this.nextCallBack=t.nextCallBack||function(){},this.prevCallBack=t.prevCallBack||function(){},this.firstCallback=t.firstCallback||function(){},this.lastCallBack=t.lastCallBack||function(){},this.pageCallBack=t.pageCallBack||function(){},this.animateTime=t.animateTime||300,this.$parent=t.parent,this.data=t.data||{},this.perPageNum=100,this.pageNumber=Math.ceil(this.data.list.length/this.perPageNum),this.currenPage=0,this.q={slideUl:t.slideUl||".theme-slide .slide-ul",content:".theme-slide .slide-ul ul",contentLi:".theme-slide .slide-ul ul li",prev:".theme-slide .prev",next:".theme-slide .next",current:".theme-slide .slide-current em",currentList:".theme-slide .slide-current .list"},this.liWidth=0,this.init()};t.prototype.bindEvent=function(){var t=this;$(t.q.next).on("click",function(){t.currenPage++,t.setIndex(t.currenPage)}),$(t.q.prev).on("click",function(){t.currenPage--,t.setIndex(t.currenPage)}),$(t.q.current).on("click",function(){var e=$(this).index();t.setIndex(e)})},t.prototype.slideCallBack=function(t){this.pageCallBack(t),this.setCurrent(t)},t.prototype.setCurrent=function(t){this.pageNumber<=1&&$(this.q.currentList).hide(),$(this.q.current).removeClass("current"),$(this.q.current).eq(t).addClass("current")},t.prototype.setContent=function(){var t=_.template(theme.ui.Slide.tpl)({slideContent:"",currentNum:Math.ceil(this.data.list.length/this.perPageNum)});this.$parent.append(t);theme.ui.themeList.init({data:this.data,parent:$(this.q.slideUl),perPageNum:this.perPageNum});this.liWidth=$(this.q.contentLi).width()},t.prototype.setIndex=function(t,e){return this.currenPage=t,e?this.animateToNumber(t,e):this.animateToNumber(t),this.setCurrent(t),1===this.pageNumber?($(this.q.prev).css("visibility","hidden"),void $(this.q.next).css("visibility","hidden")):void(0===t?($(this.q.prev).css("visibility","hidden"),$(this.q.next).css("visibility","visible"),this.firstCallback()):t===this.pageNumber-1?($(this.q.prev).css("visibility","visible"),$(this.q.next).css("visibility","hidden"),this.lastCallBack()):($(this.q.next).css("visibility","visible"),$(this.q.prev).css("visibility","visible"),this.slideCallBack(t)))},t.prototype.animateToNumber=function(t,e){var i=e?0:this.animateTime;$(this.q.content).animate({left:-this.liWidth*t},i)},t.prototype.setPage=function(t){this.setIndex(t||0,!0)},t.prototype.setPageByCheckIndex=function(t){var e=Math.floor((t||0)/this.perPageNum);this.setIndex(e,!0)},t.prototype.init=function(){this.setContent(),this.setIndex(0),this.bindEvent()},theme.ui.Slide=t}();
;var theme=window.theme||{};!function(){theme.ui.Slide.tpl=['<div class="theme-slide">','<div class="slide-box">','<div class="slide-ul">',"<%- slideContent %>","</div>","</div>",'<div class="slide-current">','<a class="prev" href="javascript:void(0);"></a>','<div class="list">',"<% for (var i = 0; i < currentNum; i++) { %>","<em><%= i %></em>","<% } %>","</div>",'<a class="next" href="javascript:void(0);"></a>',"</div>","</div>"].join("")}();
;var theme=window.theme||{};theme.ui.themeList.init=function(e){var e=e||{},t={conf:{$parent:e.parent,data:e.data||{},perPageNum:e.perPageNum||10,defaultThemeLinkUrl:""},q:{themeListInfo:".theme-list-info",item:".theme-div a",itemBox:".theme-div"},util:{dataHandling:function(e){for(var i=e.length,n=[],a=0;i>a;a++){var h=Math.floor(a/t.conf.perPageNum);n[h]||(n[h]=[]),n[h].push(e[a])}return n},bindEvent:function(){$(t.q.themeListInfo).on("mouseenter",t.q.itemBox,function(){var e=$(this).find("a").attr("preview-img");theme.ui.themePreview.init({previewImg:e,type:"change"})}).on("mouseleave",t.q.itemBox,function(){theme.ui.themePreview.init({type:"backDefault"})}),$(t.q.itemBox).hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")}),$(t.q.themeListInfo).on("click",t.q.itemBox,function(){$(this).parents(".theme-list-info").find(".theme-div").removeClass("active"),$(this).addClass("active");var e=$(this).find("a").attr("theme-name"),t=$(this).find("a").attr("preview-img"),i=$('link[node-type="theme-link"]'),n=i.attr("href"),a=n.replace(/\/theme\/(.*)\//,"/theme/"+e+"/");i.attr({href:a}),theme.themePanel.conf.checkedTheme=e,theme.ui.themePreview.init({type:"setDefault",previewImg:t}),window.theme.log.send("","previewTheme",e)}),$(t.q.themeListInfo).find("li").scroll(function(){var e=$(this).height(),t=$(this)[0].scrollHeight,i=$(this).scrollTop();e+i===t?$(this).parents(".theme-list-info").addClass("is_bottom"):$(this).parents(".theme-list-info").removeClass("is_bottom")})}},checkByName:function(e){var i=$(t.q.themeListInfo).find(t.q.itemBox);i.removeClass("active");for(var n=0;n<i.length;n++)i.eq(n).find(">a").attr("theme-name")===e&&i.eq(n).trigger("click")},init:function(){t.conf.defaultThemeLinkUrl=$('link[node-type="theme-link"]').attr("href");var e=t.conf.data.list||[],i=t.util.dataHandling(e),n=_.template(theme.ui.themeList.tpl)({list:i});t.conf.$parent.append(n),t.util.bindEvent(i)}};t.init(),theme.ui.themeList.checkByName=t.checkByName};
;var theme=window.theme||{};theme.ui.themeList.tpl=['<ul class="theme-list-info">',"<% for (var i = 0; i < list.length; i++) { %>","<li>","<% for (var j = 0; j < list[i].length; j++) { %>","<%if(list[i][j].vipType<99){%> ",'<div class="theme-div ',"<%if(list[i][j].isChecked==true){%> ","active","<%}%>",'">','<a preview-img="<%= list[i][j].preview %>" ','theme-name="<%= list[i][j].name %>" href="javascript:void(0);">','<img src="<%= list[i][j].previewSmall %>?t='+Math.floor((new Date).getTime()/36e5)+'"/>',"</a>","<%if(list[i][j].recommend==true){%> ",'<div class="recommend">\u63a8\u8350</div>',"<%}%>",'<%if(list[i][j]["hot"]==true){%> ','<div class="hot">\u70ed\u95e8</div>',"<%}%>",'<%if(list[i][j]["default"]==true){%> ','<div class="default">\u9ed8\u8ba4</div>',"<%}%>",'<div class="theme-preview-hover"></div>','<p class="theme-name">','<%= list[i][j]["chineseName"]%>',"</p>",'<span class="ok-icon"></span>',"</div>","<% } %>","<% } %>","</li>","<% } %>","</ul>"].join("");
;var theme=window.theme||{};theme.ui.themePreview.conf={},theme.ui.themePreview.init=function(e){var e=e||{},t={conf:{$parent:e.parent,previewImg:e.previewImg,type:e.type},q:{themePreviewImg:".theme-preview-img img"},util:{setPreviewImg:function(e){var i=_.template(theme.ui.themePreview.tpl)({previewImgUrl:e});t.conf.$parent.html(i),theme.ui.themePreview.conf.defaultPreview=e},changePreview:function(e){$(t.q.themePreviewImg).attr({src:e})},setDefaultPreview:function(e){$(t.q.themePreviewImg).attr({src:e}),theme.ui.themePreview.conf.defaultPreview=e},backDefaultPreview:function(){var e=theme.ui.themePreview.conf.defaultPreview;$(t.q.themePreviewImg).attr({src:e})}},init:function(){var i=t.conf.previewImg+"?t="+Math.floor((new Date).getTime()/36e5);"change"===e.type?t.util.changePreview(i):"setDefault"===e.type?t.util.setDefaultPreview(i):"backDefault"===e.type?t.util.backDefaultPreview():t.util.setPreviewImg(i)}};t.init()};
;window.theme.ui.themePreview.tpl=['<div class="theme-preview">','<div class="theme-preview-img">','<img src="<%- previewImgUrl %>" width="100%"/>',"</div>","</div>"].join("");
;var theme=window.theme||{};theme.offline.check=function(){var e={conf:{dialog:null},setTheme:function(e,n){$.ajax({type:"GET",url:"/api/userstorage/set",data:{key:"SKIN_WEB",value:e},dataType:"json",success:function(e){$.isFunction(n)&&n(e)}})},offlineConfirm:function(n){var i;e.conf.dialog||(e.conf.dialog=new theme.ui.AlertDialog),i=e.conf.dialog,i.setMessage("\u63d0\u793a",n,function(){i.setVisible(!1),e.setTheme("white")},function(){},"","","\u77e5\u9053\u4e86"),i.addClassName("not-save-dialog"),i.setVisible(!0,"onebutton")},loadCss:function(e){theme.tools.createThemeLink(function(){$.isFunction(e)&&e()})},init:function(){var n=window.yunData.skinName;"-INVALID-"===n&&e.loadCss(function(){e.offlineConfirm("\u60a8\u4f7f\u7528\u7684\u9650\u65f6\u4e3b\u9898\u5230\u671f\u5566\uff0c\u4e3a\u60a8\u6062\u590d\u7ecf\u5178\u4e3b\u9898")})}};e.init()};
;var pri={imgLog:function(e,n){for(var o in n)e+=(e.match(/\?/)?"&":"?")+encodeURIComponent(o)+"="+encodeURIComponent(""+n[o]);e+=(e.match(/\?/)?"&":"?")+"t="+ +new Date;var a=new Image;a.src=e}};window.theme.log={send:function(e,n,o){pri.imgLog("//pan.baidu.com/api/analytics",{type:"web_theme_"+("undefined"!==n?n:"unknow"),value:o,clienttype:0,version:"v5",currentUrl:window.location.href}),e&&pri.imgLog("//pan.baidu.com/rest/2.0/pcs/adx?m=callback",{h:0,w:0,p:"web-text",s:e})}};
;var theme=window.theme||{};theme.start={ready:0},function(){var e={ready:!1,init:function(){theme.tools.checkjQueryLib(function(e){theme.$=e,theme.start.ready+=1,window.theme.offline.check()})}};e.init()}();