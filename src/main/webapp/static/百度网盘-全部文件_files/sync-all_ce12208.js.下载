define("function-widget-1:puzzle/context.js",function(t,n,e){var o={context:null};e.exports={getContext:function(){return o.context},setContext:function(t){o.context=t}}});
;define("function-widget-1:puzzle/fileMeitu.js",function(e,t,n){function o(e,t,n){var o=new RegExp("(?:^|\\?|#|&)"+e+"=([^&#]*)(?:$|&|#)","i"),i=o.exec(n||location.href);return null!=i?n.replace(i[1],t):null}function i(){if(!u||10.2>u){var e=r().ui.confirm({title:"友好提示",body:"要使用图片在线编辑功能，您需要安装Flash播放器10.2.0 或更高的版本。",sureText:"安装",canceText:"取消",content:null,onSure:function(){e.hide(),window.open("http://get.adobe.com/cn/flashplayer","_blank")},onCancel:function(){e.hide()}});return e.show(),!1}return!0}var c=e("base:widget/libs/underscore.js"),r=(e("base:widget/libs/jquerypacket.js"),e("function-widget-1:puzzle/context.js").getContext),s=e("base:widget/storage/storage.js"),a=e("base:widget/tools/service/tools.flash.js"),u=a.getFlashVersion();n.exports=function(e,t){var n=i();if(!n)return!1;var r=e,a=encodeURIComponent(1===r.length?r[0].path:""),u=c.map(r,function(e){var t=e.thumb||e.thumbs.url3;return encodeURIComponent(o("size","c850_u580",t))});s.setItem("picArray",u),s.setItem("picPath",a),"object"==typeof window._hmt&&window._hmt.push(["_trackEvent","图片在线编辑","单张页点击美化入口的次数"]),"object"==typeof t&&t(),window.open(location.protocol+"//"+window.location.host+"/disk/editpic","_blank")}});
;define("function-widget-1:puzzle/start.js",function(t,e,i){var s=t("function-widget-1:puzzle/fileMeitu.js"),n=t("function-widget-1:puzzle/context.js");i.exports.start=function(t,e){var i;n.setContext(t),i="object"==typeof e&&e.filesList?e.filesList.length>0?e.filesList:[e.filesList]:t.list.getSelected(),s(i,e.callback)}});
;define("function-widget-1:log/start.js",function(o,t,i){for(var n=["linux","windows","win","mac","ipad"],a=navigator.platform.toLowerCase(),e=!0,r=0;r<n.length;r++)if(a.indexOf(n[r])>-1){e=!1;break}i.exports.start=function(o){e&&setTimeout(function(){o.updateLog.setLocalLog({product:"pan",op:"guardian",from:"browserPlugin",type:"modifyPlatform",detailKey:a})},500)}});
;define("function-widget-1:guide/context.js",function(e,t,n){function i(e){var t=e.y,n=e.m,i=e.d;e.timestamp&&(t=new Date(e.timestamp).getFullYear(),n=new Date(e.timestamp).getMonth()+1,i=new Date(e.timestamp).getDate());var a=new Date(t,n-1,i),o=new Date(t,0,1),r=Math.round((a.getTime()-o.getTime())/864e5);return Math.ceil((r+o.getDay())/7)}var a=e("base:widget/storage/storage.js"),o=e("function-widget-1:guide/log.js"),r=null;n.exports={getContext:function(){return r},setContext:function(e){r=e,r.log&&r.log.define&&r.log.define(o)},getYearWeek:i,getTipShowStatusForLocal:function(){var e="enterpriseTip_"+(window.yunData.MYUK||""),t=+new Date;if(a.getItem(e)){var n=a.getItem(e).split("_"),o=+n[0],r=+n[1],g=864e5;if(+r){var u=i({timestamp:t}),m=i({timestamp:o});if(t-o>g&&u===m)return!1}}return!0}}});
;define("function-widget-1:guide/log.js",function(o,e,c){var i={mix:{show_welcome_guide:{logType:"count",description:"显示新版欢迎引导"},welcome_guide_begin:{logType:"count",description:"体验引导，点击立即体验按钮"},welcome_guide_close:{logType:"count",description:"体验引导，点击关闭按钮"},disk_home_coupon_banner_display:{logType:"count",description:"网盘优惠券广告位展现"},coupon_consume_active_banner_click:{logType:"count",description:"网盘优惠券广告位点击"},coupon_consume_active_banner_close:{logType:"count",description:"网盘优惠券广告位关闭"},disk_home_dialog_consume_coupon_click:{logType:"count",description:"网盘优惠券领取成功"},disk_home_gift_banner_display:{logType:"count",description:"网盘满赠广告位展现"},show_picNew_guide:{logType:"count",description:"显示图片分类引导"},picNew_guide_close:{logType:"count",description:"关闭图片分类引导，点击[去看看]"},cardHolder_activity_show:{logType:"count",description:"卡包活动引导"},cardHolder_activity_close:{logType:"count",description:"卡包活动引导关闭"},cardHolder_activity_addBtn_enter_cardholder:{logType:"count",description:"卡包活动引导点击立即添加进入卡包"},cardHolder_activity_addBtn_click:{logType:"count",description:"卡包活动引导点击立即添加"},cardHolder_importDialog_show:{logType:"count",description:"卡包一键导入"},cardHolder_import_close:{logType:"count",description:"卡包一键导入引导关闭"},cardHolder_import_recognition_click:{logType:"count",description:"卡包一键导入引导点击立即识别"},cardHolder_import_recognition_success:{logType:"count",description:"卡包一键导入引导识别成功"},cardHolder_import_keyimport_click:{logType:"count",description:"卡包一键导入引导点击一键导入"},cardHolder_import_enter_cardholder:{logType:"count",description:"卡包一键导入引导进入到卡包"},cardHolder_import_keyimport_success:{logType:"count",description:"卡包一键导入导入成功"}," cardHolder_import_keyimport_fail":{logType:"count",description:"卡包一键导入导入失败"}}};c.exports=i});
;define("function-widget-1:guide/guideQueue.js",function(e,t,i){function s(e){return this instanceof s?(this.hasInited=!1,this.params=e||null,this._watch=null,this.list=[],this.hashChangeList=[],void(this.selectChangeList=[])):new s(e)}var n=e("base:widget/libs/underscore.js"),a=e("base:widget/libs/jquerypacket.js"),h=e("function-widget-1:guide/context.js").getContext,r=e("base:widget/storage/storage.js"),o=e("base:widget/tools/service/tools.url.js"),u=1,c=2,l=3;s.prototype.init=function(){this.hasInited||(this.listenHashChange(),this.listenSelectChange(),this.hasInited=!0)},s.prototype.setParams=function(e){this.params=e},s.prototype.enqueue=function(e){n.isArray(e)?[].push.apply(this.list,e):this.list.push(e),this.handleChangeQueue()},s.prototype.handleChangeQueue=function(){for(var e,t=[],i=[],s=[],n=0;n<this.list.length;n++)e=this.list[n],e.__index__=n,e.hashChange?(t.push(e),i.push(e)):e.selectChange?s.push(e):t.push(e);this.list=t,this.hashChangeList=i,this.selectChangeList=s},s.prototype.listenHashChange=function(){var e=this,t=h().router,i=this._watch=n.debounce(function(){if(e.hasInited){var t=e.hashChangeList;if(0!==t.length){for(var i=[],s=0;s<t.length;s++)i.push(a.extend(!0,{},t[s]));i.length>0&&(e.list=i,e._dequeue())}}},500);t.eachEnter(i),t.query.watch("vmode",i),t.query.watch("type",i),t.query.watch("path",i),t.query.watch("key",i)},s.prototype.listenSelectChange=function(){function e(){if(t.hasInited){var e=t.selectChangeList;if(0!==e.length){var i=h().getList().getCheckedItems();if(0!==i.length){for(var s,n=[],r=0;r<e.length;r++){s=a.extend(!0,{},e[r]);var o=s.selectChange;if(o!==!0){if("object"==typeof o){var u=!0,c=o.filesLimit;c&&(/^\d+$/.test(c)?u=i.length===+c:/^<\d+$/.test(c)?u=i.length<c.substring(1):/^>\d+$/.test(c)&&(u=i.length>c.substring(1)));var l=o.type;if(l&&"*"!==l)for(var d=0;d<i.length;d++)if("dir"===l&&0===+i[d].isdir)u=!1;else if("dir"!==l){var g=i[d].server_filename.split("."),f=g[g.length-1];u=l===f}u&&n.push(s)}}else n.push(s)}n.length>0&&(t.list=n,t._dequeue())}}}}var t=this;h().message.instanceForSystem.listen("system-checked-changed",n.debounce(e,500))},s.prototype.dequeue=function(){this._dequeue()},s.prototype.preHandle=function(){var e=this.list.shift();if(!e)return u;var t=e.key?r.getItem(e.key):"",i=e.pageType?e.pageType:"",s=e.pageFrom?e.pageFrom:"",a=e.period?e.period.start:"",c=e.period?e.period.termination:"",d=(new Date).getTime(),g=!!t,f=h().router.currentRouteName,p=!0,y=!0;if(n.isFunction(e.checkStorageItem)&&(g=e.checkStorageItem(t)),a&&c&&(y=!(a>d||d>c)),i&&i.length>0&&(p=!(-1===i.indexOf(f)||!f)),s&&s.length>0){var v=o.getParam("jumpFrom");if(-1!==s.indexOf(v))return!e.ignore&&y&&p?e:l}return!e.ignore&&y&&!g&&p?e:l},s.prototype._dequeue=function(e,t){var i;if(void 0===e){var s=this.preHandle();if(n.isObject(s))i=s;else{if(s!==l)return;this._dequeue()}}else{if(!e)return this.list.shift(),void this._dequeue();i=this.list.shift(),t&&(i.data=t)}if(n.isObject(i))if(i.asyncCanShow!==!0){var a=this._guideHandle(i);a===l&&this._dequeue()}else{if(!n.isFunction(i.canShow))throw new Error("If the asyncCanShow has been set true,and the canShow was must be a function.");var h=i.canShow;i.asyncCanShow=void 0,i.canShow=void 0,this.list.unshift(i),h(this.params)}},s.prototype.goAhead=function(e,t){var i=this.list[0];if(i){if(i.canShow=e,e){var s="";i.hashChange?s="hashChangeList":i.selectChange&&(s="selectChangeList"),s&&(this[s]=this[s].filter(function(e){return e.__index__!==i.__index__}))}this._dequeue(e,t)}},s.prototype._guideHandle=function(t){if(n.isFunction(t))t();else{var i=this.params,s=n.isFunction(t.canShow)?t.canShow(i):t.canShow;if(void 0===s&&(s=!0),!s)return l;if(t.path&&(t.delay?setTimeout(function(){e.async(t.path,function(e){e.show(i,t.data)})},t.delay):e.async(t.path,function(e){e.show(i,t.data)})),!t.ManualKeyOperate&&t.key&&r.setItem(t.key,!0),t.goNext===!1)return c}return l},i.exports=s});
;define("function-widget-1:guide/start.js",function(e,i,t){function a(){s().message.listenSystem("after-share-dir-root-diffall",function(i){n.isArray(i)&&i.length&&e.async("function-widget-1:guide/util/shareDirTip/shareDirRootChange.js",function(e){e.show({},i)})},!0),a=function(){}}var n=e("base:widget/libs/underscore.js"),o=e("base:widget/libs/jquerypacket.js"),r=e("function-widget-1:guide/context.js"),s=r.getContext,u=e("function-widget-1:guide/guideQueue.js"),c=e("base:widget/storage/storage.js"),d=u(),g=window.yunData;d.enqueue([{hashChange:!0,asyncCanShow:!0,pageType:"sharedir",canShow:function(){function e(){var e=a.diffAll,i=e.shareDirRootChangeList;i.length?(a.diffAll.removeDiffMsg("shareDirRoot"),d.goAhead(!0,i)):d.goAhead(!1)}var i=s(),t=i.router.query.get("path");if("/"!==t)return void d.goAhead(!1);var a=s().tools.shareDirManager,n=a.diffAll;n&&n.shareDirRootChangeList?e():i.message.listenSystem("after-share-dir-root-diffall",function(){e()},!0)},path:"function-widget-1:guide/util/shareDirTip/shareDirRootChange.js",goNext:!1},{hashChange:!0,pageType:"list",asyncCanShow:!0,canShow:function(){function e(){for(var e=i.tools.shareDirManager,a=e.diffAll,n=a.dismissMsgList,o=0;o<n.length;o++)if(n[o].path===t)return e.diffAll.removeDiffMsg("dismiss",t),void d.goAhead(!0);d.goAhead(!1)}var i=s(),t=i.router.query.get("path"),a=i.tools.shareDirManager,n=a.diffAll;n&&n.dismissMsgList?e():i.message.listenSystem("after-share-dir-root-diffall",function(){e()},!0)},path:"function-widget-1:guide/util/shareDirTip/setShareDismiss.js",goNext:!1},{ignore:!0,key:"christmas_2017_uk_"+g.MYUK,ManualKeyOperate:!0,pageFrom:["buycenter"],period:{start:new Date(2017,11,11,9,0,0).getTime(),termination:new Date(2017,11,20,23,59,59).getTime()},canShow:function(){return 1===+g.LOGINSTATUS},path:"function-widget-1:guide/util/promo/promo.js",goNext:!1},{key:"showAblity_uk_"+g.MYUK,asyncCanShow:!0,pageType:"list",canShow:function(){o.ajax({url:"/api/account/rookie?type=8",dataType:"json",success:function(e){d.goAhead(0===e.errno&&e.list&&0===+e.list[8])},error:function(){d.goAhead(!1)}})},path:"function-widget-1:guide/util/ablityShow/ablityShow.js",goNext:!1},{asyncCanShow:!0,pageType:"list",key:g.MYUK+"_card_space",checkStorageItem:function(e){return e&&"true"===e},canShow:function(){o.ajax({url:"/aipic/cardcatalog/addvolume?isadd=0",dataType:"json",success:function(e){d.goAhead(0===e.errno&&0===e.status&&"undefined"!=typeof e.msg,e.msg)},error:function(){d.goAhead(!1)}})},path:"function-widget-1:guide/util/cardHolder/cardHolderGiveSpace/cardHolderGiveSpace.js",goNext:!1},{asyncCanShow:!0,pageType:"list",key:g.MYUK+"_card_import",checkStorageItem:function(e){if(!e||"false"===e)return!1;if(e.indexOf("_")>-1){var i=e.split("_");if("true"===i[0])return!0;var t=+new Date-parseInt(i[1],10);return!(t>864e5)}return!1},canShow:function(){o.ajax({url:"/aipic/cardcatalog/importable",dataType:"json",success:function(e){d.goAhead(0===e.errno&&e.importable,e)},error:function(){d.goAhead(!1)}})},path:"function-widget-1:guide/util/cardHolder/cardHolderKeyImport/cardHolderKeyImport.js",goNext:!1},{asyncCanShow:!0,pageType:"list",key:g.MYUK+"_card_tip",canShow:function(){o.ajax({url:"/aipic/cardcatalog/newuser",dataType:"json",success:function(e){d.goAhead(0===e.errno&&e.newuser)},error:function(){d.goAhead(!1)}})},path:"function-widget-1:guide/util/cardHolder/cardHolderTip/cardHolderTip.js",goNext:!1},{key:"guideShareDirTip_"+g.MYUK,pageType:"list",path:"function-widget-1:guide/util/shareDirTip/shareDirTip.js",goNext:!1},{ignore:!0,asyncCanShow:!0,key:"picNewNotice",pageType:"list",canShow:function(){o.ajax({url:"/api/categorylist",dataType:"json",data:{category:3},success:function(e){e&&0===e.errno&&e.info&&e.info.length>0&&o.ajax({url:"/api/account/rookie?type=16",dataType:"json",success:function(e){d.goAhead(0===e.errno&&e.list&&0===+e.list[16]),c.setItem("picNewNotice",!0),s().log.send({type:"show_picNew_guide"})},error:function(){d.goAhead(!1)}})},error:function(){d.goAhead(!1)}})},path:"function-widget-1:guide/util/picNewTip/picNewTip.js",goNext:!1},{ignore:!0,key:g.MYNAME+"classifyTip",canShow:function(){return window.location.href.indexOf("timeline")>-1},path:"function-widget-1:guide/util/classifyTip/classifyTip.js",goNext:!1},{canShow:function(e){return!!e.isVip},path:"function-widget-1:guide/util/trialVipTip/trialVipTip.js"},{asyncCanShow:!0,canShow:function(){o.ajax({url:"/enterprise/user/check",dataType:"json",success:function(e){d.goAhead(1===+e.result?!1:r.getTipShowStatusForLocal())},error:function(){d.goAhead(!1)}})},path:"function-widget-1:guide/util/enterpriseTip/enterpriseTip.js"},{key:g.MYNAME+"_director_guide",path:"function-widget-1:guide/util/directorTip/directorTip.js"},{delay:2e3,ManualKeyOperate:!0,canShow:function(){return!!s().getList()},path:"function-widget-1:guide/util/openFileTip/openFileTip.js"}]),t.exports.start=function(e,i){if(r.setContext(e),"pan"===e.pageInfo.currentProduct){if(i&&i.message)return void e.message.trigger(i.message);a(),d.init(),d.setParams(i),d.dequeue()}}});
;define("function-widget-1:download/util/context.js",function(t,n,e){var o=t("function-widget-1:download/log.js"),i=/\.(\w+)$/,u=null;e.exports={getContext:function(){return u},setContext:function(t){u||(u=t,t&&t.log&&t.log.define(o))},getExtName:function(t){if("string"!=typeof t)return"";var n=i.exec(t);return n[1]?n[1]:""}}});
;define("function-widget-1:download/service/dlinkService.js",function(t,r,e){var a=t("base:widget/libs/jquerypacket.js"),o=t("base:widget/libs/underscore.js"),i=t("function-widget-1:download/util/context.js").getContext,n=t("base:widget/tools/service/tools.cookie.js").getCookie,s=window.yunData,d={PRODUCT_PAN:"pan",PRODUCT_MBOX:"mbox",PRODUCT_SHARE:"share",currentProduct:null,dialog:null,sign:null,setCurrentProduct:function(t){this.currentProduct=t},getCurrentProduct:function(){return this.currentProduct},URL_DLINK_PAN:"/api/download",URL_DLINK_SHARE:"/api/sharedownload",_doError:function(t){var r="",e=this,a=i().accountBan(t);return a.isBan?!1:(2==t&&(r="下载失败，请稍候重试"),116===t&&(r="该分享不存在！"),-1===t&&(r="您下载的内容中包含违规信息！"),118===t&&(r="没有下载权限！"),(113===t||112===t)&&(r='页面已过期，请<a href="javascript:window.location.reload();">刷新</a>后重试'),-20===t?void e._showVerifyDialog():(121===t&&(r="你选择操作的文件过多，减点试试吧。"),r=r||"网络错误，请稍候重试",void i().ui.tip({mode:"caution",msg:r,hasClose:!0,autoClose:!1})))},getFsidListData:function(t){return o.isArray(t)===!1&&(t=[t]),a.stringify(o.pluck(t,"fs_id"))},getPathListData:function(t){return o.isArray(t)===!1&&(t=[t]),a.stringify(o.pluck(t,"path"))},base64Encode:function(t){var r,e,a,o,i,n,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(a=t.length,e=0,r="";a>e;){if(o=255&t.charCodeAt(e++),e==a){r+=s.charAt(o>>2),r+=s.charAt((3&o)<<4),r+="==";break}if(i=t.charCodeAt(e++),e==a){r+=s.charAt(o>>2),r+=s.charAt((3&o)<<4|(240&i)>>4),r+=s.charAt((15&i)<<2),r+="=";break}n=t.charCodeAt(e++),r+=s.charAt(o>>2),r+=s.charAt((3&o)<<4|(240&i)>>4),r+=s.charAt((15&i)<<2|(192&n)>>6),r+=s.charAt(63&n)}return r},getDlinkPan:function(t,r,e,o,n,d){var c,u,p=this;if(null===p.sign){try{u=new Function("return "+s.sign2)()}catch(l){throw new Error(l.message)}if("function"!=typeof u)return void this._doError();p.sign=p.base64Encode(u(s.sign5,s.sign1))}"[object Array]"===Object.prototype.toString.call(t)?t=a.stringify(t):"string"!=typeof t||/^\[\S+\]$/.test(t)||(t="["+t+"]"),c={sign:p.sign,timestamp:s.timestamp,fidlist:t,type:r},o&&n&&(c.ct=o,c.cv=n),"cardHolder"===i().router.currentRouteName&&(c.src="cardholder"),a.ajax({url:this.URL_DLINK_PAN,data:c,dataType:"json",type:d||"GET",success:function(t,r,o){i().log.send({type:"webdownload",url:"//update.pan.baidu.com/statistics",clienttype:"0",op:"download",from:c.type,product:"pan",success:t&&0===+t.errno?1:0,reason:t?t.errno:0,ajaxstatus:o.status,ajaxurl:"/api/download",ajaxdata:a.stringify(r)}),0==t.errno?t.dlink&&t.dlink.length>0?"function"==typeof e&&(t.logType="webdownload",t.logFrom=c.type,e(t)):p._doError():p._doError(t.errno)},error:function(t,r){i().log.send({type:"webdownload",url:"//update.pan.baidu.com/statistics",clienttype:"0",op:"download",from:c.type,product:"pan",success:0,ajaxstatus:t.status,ajaxurl:"/api/download",ajaxdata:a.stringify(r)}),p._doError()}})},ajaxGetDlinkShare:function(){var t={encrypt:0};0===s.SHARE_PUBLIC&&(t.extra=a.stringify({sekey:decodeURIComponent(n("BDCLND"))}));var r=function(){a.get("/share/autoincre",{type:1,uk:s.SHARE_UK,shareid:s.SHARE_ID,sign:s.SIGN,timestamp:s.TIMESTAMP})};return function(e,o){var n=this,s=a.extend({},t,e),d=s.sign,c=s.timestamp;delete s.sign,delete s.timestamp,a.ajax({type:"POST",url:this.URL_DLINK_SHARE+"?sign="+d+"&timestamp="+c,data:s,dataType:"json",success:function(t,e,d){return i().log.send({type:"websharedownload",url:"//update.pan.baidu.com/statistics",clienttype:"0",op:"download",from:s.product,product:"pan",success:t&&0===+t.errno?1:0,reason:t?t.errno:0,ajaxstatus:d.status,ajaxurl:"/api/sharedownload",ajaxdata:a.stringify(e)}),t?void(0==t.errno?(s.product===n.PRODUCT_SHARE&&r(),"function"==typeof o&&(t.logType="websharedownload",t.logFrom=s.product,o(t))):n._doError(t.errno)):void n._doError()},error:function(t,r){i().log.send({type:"websharedownload",url:"//update.pan.baidu.com/statistics",clienttype:"0",op:"download",from:s.product,product:"pan",success:0,ajaxstatus:t.status,ajaxurl:"/api/sharedownload",ajaxdata:a.stringify(r)}),n._doError()}})}}(),getDlinkMbox:function(){var t=function(t){var r={uk:s.MYUK,product:d.PRODUCT_MBOX,encrypt:0,timestamp:"",sign:""},e={};return t.vcode&&(e.vcode=t.vcode,e.input=t.input),t.isForBatch===!0&&(e.type="batch"),t.isForGuanjia===!0&&(e.encrypt=1),t.ct&&t.cv&&(e.ct=t.ct,e.cv=t.cv),e=t.group_id?a.extend({},r,e,{primaryid:t.msg_id,fid_list:d.getFsidListData(t.list),extra:a.stringify({type:"group",gid:t.group_id})}):a.extend({},r,e,{primaryid:t.msg_id,fid_list:d.getFsidListData(t.list),extra:a.stringify({type:"single",from_uk:t.from_uk,to_uk:t.to_uk})})};return function(r,e){this.arguments=arguments,this.ajaxGetDlinkShare(t(r),e)}}(),getDlinkShare:function(){var t=function(t){var r={product:d.PRODUCT_SHARE,encrypt:0,timestamp:"",sign:""},e={};return t.vcode_input&&t.vcode_str&&(e.vcode_input=t.vcode_input,e.vcode_str=t.vcode_str),t.type&&(e.type=t.type),t.isForBatch===!0&&(e.type="batch"),t.isForGuanjia===!0&&(e.encrypt=1),t.ct&&t.cv&&(e.ct=t.ct,e.cv=t.cv),e=a.extend({},r,e,{uk:t.share_uk,primaryid:t.share_id,product:t.product,fid_list:t.list?d.getFsidListData(t.list):"",path_list:t.path?d.getPathListData(t.path):"",sign:t.sign,timestamp:t.timestamp})};return function(r,e){this.arguments=arguments,this.ajaxGetDlinkShare(t(r),e)}}(),_showVerifyDialog:function(){var t=this;t.dialog=i().ui.verify({title:"提示",prod:"pan",onSure:function(r,e){t.arguments[0].vcode_str=r,t.arguments[0].vcode_input=e,t.arguments.callee.apply(t,t.arguments)}}),t.dialog.show()}};e.exports=d});
;define("function-widget-1:download/util/downloadCommonUtil.js",function(e,n,t){var o=e("base:widget/libs/jquerypacket.js"),r=e("function-widget-1:download/service/dlinkService.js"),i=e("function-widget-1:download/util/context.js").getContext,s=e("base:widget/tools/service/tools.flash.js"),a={getFlashVersion:function(){var e=0,n=navigator;if(n.plugins&&n.plugins.length){for(var t=0,o=n.plugins.length;o>t;t++)if(-1!==n.plugins[t].name.indexOf("Shockwave Flash")){e=n.plugins[t].description.split("Shockwave Flash ")[1];break}}else if(window.ActiveXObject)try{var r=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(r){var i=r.GetVariable("$version"),s=/WIN ([\d\.\,]+)/g,a=s.exec(i);a&&(e=a[1])}}catch(c){}return e},compareVersion:function(e,n,t){return"string"==typeof e&&(e=e.replace(/(^|\.)(\d)(?=\.|$)/g,"$10$2").replace(/\./g,""),e=e.length<=6?e+="00":e,e=parseInt(e,10)),"string"==typeof n&&(n=n.replace(/(^|\.)(\d)(?=\.|$)/g,"$10$2").replace(/\./g,""),n=n.length<=6?n+="00":n,n=parseInt(n,10)),t?e>n:e>=n},getDownloadLogmsg:function(){var e;return e=r.getCurrentProduct()===r.PRODUCT_SHARE?2:1},getPackName:function(e){var n,t=i().tools.baseService.parseDirFromPath(e[0].path),o=e[0].isdir;if("number"==typeof e.length){var r=e.length>1?"【批量下载】{%packName%}等.zip":"{%packName%}.zip";return 0===o&&(n=t.lastIndexOf("."),-1!==n&&(t=t.substring(0,n))),r.replace(/{%packName%}/g,t)}return i().tools.baseService.parseDirFromPath(e[0].path)},isFile:function(e){return 0===e||void 0===e?!0:!1},isPlatformWindows:function(){var e=navigator.platform;return 0===e.toLowerCase().indexOf("win")},isPlatformMac:function(){var e=/Mac\D+(\d+).(\d*)/gi,n=e.exec(navigator.userAgent);return n&&n[1]&&(+n[1]>10||10===+n[1]&&n[2]&&+n[2]>=10)?!0:!1},getDownloadUrl:function(e){return o.browser.msie?e.dlink+"&response-cache-control=private":e.dlink},isChromeAndGreaterThan42:function(){var e="42";return a.getChromeVersion()>=e?!0:!1},getChromeVersion:function(){var e,n=navigator.userAgent.toLowerCase(),t=/chrome/,o=/safari\/\d{3}\.\d{2}$/,r=/chrome\/(\S+)/;return t.test(n)&&o.test(n)&&r.test(n)?e=RegExp.$1:0},isChrome:function(){var e=navigator.userAgent.toLowerCase(),n=/chrome/;return n.test(e)?!0:!1},ctrBrowserVersion:function(e,n,t){var o="get"+e.slice(0,1).toUpperCase()+e.slice(1)+"Version",r=a[o],i=parseInt(r(),10),t=parseInt(t,10);return"<"===n?t>i:"=="===n||"==="===n?i===t:"<="===n?t>=i:">="===n?i>=t:">"===n?i>t:void 0},shouldKeepAlive:function(){return location.protocol.indexOf("https")>-1&&(!s.checkFlashSupport()||a.isPlatformMac()&&a.ctrBrowserVersion("firefox",">","50")||a.ctrBrowserVersion("chrome","==","59"))},isFirefoxAndGreaterThan50:function(){var e="50";return a.isFirefox()&&a.getFirefoxVersion()>e?!0:!1},getFirefoxVersion:function(){var e,n=navigator.userAgent.toLowerCase(),t=/firefox\/(\S+)/;return t.test(n)?e=RegExp.$1:0},isFirefox:function(){var e=navigator.userAgent.toLowerCase(),n=/firefox/;return n.test(e)?!0:!1},toLogin:function(){i().ui.tip({toastMode:"loading",msg:"请稍候..."}),e.async("base:widget/passAPI/passAPI.js",function(e){i().ui.hideTip(),e.promise.done(function(){e.passAPI.PassportInit.netdiskLogin({reload:!0}),e.passAPI.PassLoginDialog.onLoginSuccessCallback=function(){e.passAPI.PassportInit.hide(),i().log.send({type:"download_share_single_size_limit_login_success"})}}),i().log.send({type:"download_share_single_size_limit_login_dialog_show"})})},openYunGuanjiaByScheme:function(e,n){var t=!1,r=function(){t=!0};o(window).on("blur",r);var i=function(){t&&setTimeout(function(){"function"==typeof n&&n()},100),t=!1,o(window).off("focus",i)};if(o(window).on("focus",i),a.isChrome()){var s=document.createElement("a"),c=null;"function"==typeof MouseEvent?c=new MouseEvent("click",{bubbles:!0,cancelable:!1}):(c=document.createEvent("MouseEvents"),c.initEvent("click",!0,!1)),s.href=e,s.dispatchEvent(c)}else{var l=a.callClientIframe;l||(l=document.createElement("iframe"),o(l).hide(),a.callClientIframe=l,document.body.appendChild(l)),l.src=e}setTimeout(function(){o(window).off("blur",r),t||(o(window).off("focus",i),"function"==typeof n&&n())},100)}};t.exports=a});
;define("function-widget-1:download/log.js",function(o,e,t){t.exports={event:{},ajax:{"/api/download":{logType:"dis",description:"下载文件",callback:function(o,e){return[{name:"downloadHttpTime",value:e&&e.time},{name:"downloadHttpStatus",value:e&&e.responseData&&e.responseData.errno}]}}},mix:{chromeStraightforwardDownload:{logType:"count",description:"chrome直接下载文件"},httpsAccessFail:{logType:"count",description:"https访问失败"},httpsAccessSuccess:{logType:"count",description:"https访问成功"},https_pub:{logType:"count",description:"是否命中https访问的小流量"},callGuanjia:{logType:"count",description:"是否成功调起云管家"},tab_download_click:{logType:"count",description:"选中文件后点上方按钮文件下载"},list_download_click:{logType:"count",description:"列表下载按钮文件下载"},file_down_count:{logType:"count",description:"文件下载统计(不包含文件夹)"},call_guanjia_local:{logType:"count",description:"下载本地服务调起"},call_guanjia_server:{logType:"count",description:"下载长连接方式调起"},getBrowserIdByServer:{logType:"count",description:"发送长连接调起browserId请求"},checkIsOnlineByServer:{logType:"count",description:"发送长连接调起online请求"},callGuanjiaByServer:{logType:"count",description:"发送长连接调起send请求"},checkGuanjiaStatusByServer:{logType:"count",description:"发送长连接调起check请求"}}}});
;define("function-widget-1:download/service/guanjiaConnector.js",function(o,e,n){var t=o("function-widget-1:download/util/downloadCommonUtil.js"),i=o("base:widget/libs/jquerypacket.js"),c=o("base:widget/httpProxy/httpProxy.js"),a=o("base:widget/tools/tools.js"),r={conf:{localUrl:"http://127.0.0.1",localPort:1e4,currentPort:1e4,portPollLimit:10,guanjiaVersion:0,localServerReady:!1,domIframeId:"guanjia-iframe-id",domHookId:"guanjia-hook-id",hook:null,minVersion:"5.3.4.5"},setVersion:function(o){r.conf.guanjiaVersion=o,"http:"!==location.protocol||t.isPlatformWindows()&&!t.compareVersion(o,"5.4.7")||r.imageAccess("https://"+location.host+"/yun-static/common/images/default.gif",function(){a.setCookie("secu",1,365,"/")})},imageAccess:function(o,e,n){var t=new Image;t.onload=function(o){"function"==typeof e&&e.call(null,o)},t.onerror=function(o){"function"==typeof n&&n.call(null,o)},t.src=o},util:{init:function(o){r.conf.checkStartTime=o?+new Date:0,r.util.checkLocalServer(),t.getChromeVersion()<=42&&setTimeout(function(){r.util.localServerReady||r.util.installHook()},1e3)},checkLtIe8:function(){var o=i.browser||{};return o.msie&&+o.version<=8?!0:!1},checkLocalServer:function(){if(!r.conf.localServerReady)for(var o=0,e=function(e){var n=r.conf.localUrl+":"+e+"/guanjia",a={url:n,type:"GET",data:{method:"GetVersion"},dataType:"json",timeout:3e3,success:function(o){try{o=i.parseJSON(o)}catch(n){}if(o&&o.version){if(t.isPlatformWindows()&&!t.compareVersion(o.version,r.conf.minVersion))return;r.conf.currentPort=e,r.setVersion(o.version),r.conf.localServerReady=!0}},error:function(){o++,o===r.conf.portPollLimit&&+new Date-r.conf.checkStartTime<3e3&&setTimeout(function(){r.util.checkLocalServer()},400)}};location.protocol.indexOf("https")>-1||r.util.checkLtIe8()?t.isPlatformMac()?r.imageAccess(r.conf.localUrl+":"+e+"/version.png",function(){c.ajax(a)},a.error):c.ajax(a):i.ajax(a)},n=0;n<r.conf.portPollLimit;n++)e(r.conf.localPort+n)},installHook:function(){var o,e,n=[];return null!==r.conf.hook?r.conf.hook:(o=document.getElementById(r.conf.domIframeId),o&&document.body.removeChild(o),o=document.createElement("div"),o.style.width="1px",o.style.height="1px",o.style.position="absolute",o.style.overflow="hidden",o.style.left="-999em",o.style.top="-999em",o.id=r.conf.domIframeId,document.body.appendChild(o),n.push("undefined"!=typeof window.attachEvent||window.ActiveXObject||"ActiveXObject"in window?'<object id="'+r.conf.domHookId+'" classid="CLSID:8DCE7B6C-C3B9-4efd-9CC6-2D9F938B4A06" hidden="true" viewastext></OBJECT>':-1!==navigator.userAgent.indexOf("Trident/7.0")?'<embed id="'+r.conf.domHookId+'" type="application/bd-npYunWebDetect-plugin" width="0" height="0">':'<embed id="'+r.conf.domHookId+'" type="application/bd-npYunWebDetect-plugin" width="0" height="0">'),o.innerHTML=n.join(""),e=r.util.hasPlugin(),e&&(r.conf.hook=document.getElementById(r.conf.domHookId),r.setVersion(r.conf.hook.GetVersion())),r.conf.hook)},hasPlugin:function(){var o=null;try{o=new ActiveXObject("YunWebDetect.YunWebDetect.1")}catch(e){for(var n=null,t=navigator.plugins,i=0,c=t.length;c>i;i++)if(n=t[i].name||t[i].filename,-1!=n.indexOf("BaiduYunGuanjia")){o=t[i];break}}return null!=o},checkPluginHook:function(){return r.conf.installHook()},sendData:function(o,e,n,a,l){if(r.conf.localServerReady){var u=r.conf.localUrl+":"+r.conf.currentPort+"/guanjia?";u+="method="+o+"&uk="+n+"&checkuser="+(a?1:0);var f={url:u,type:"POST",data:{filelist:e},success:function(){},timeout:3e3,error:function(){l||t.openYunGuanjiaByScheme("baiduyunguanjia://guanjia",function(){r.conf.localServerReady=!1,r.util.init(!0),setTimeout(function(){r.util.sendData(o,e,n,a,!0)},3e3)})}};location.protocol.indexOf("https")>-1||r.util.checkLtIe8()?c.ajax(f):i.ajax(f)}else{if(!r.conf.hook)return-2;try{"undefined"==typeof a?r.conf.hook[o](e,n):r.conf.hook[o](e,n,a)}catch(s){return-2}}}}};r.setVersion(0),n.exports={getVersion:function(){return r.conf.guanjiaVersion},checkConnect:function(){return r.conf.localServerReady?!0:t.isChromeAndGreaterThan42()?!1:r.conf.hook&&r.conf.guanjiaVersion},callGuanjia:function(o,e,n,t){return r.util.sendData(o,e,n,t)},init:function(o){r.util.init(o)}}});
;define("function-widget-1:download/start.js",function(n,i,t){function e(i,t,e,o){n.async("function-widget-1:download/service/dlinkService.js",function(n){switch(e){case"mbox":break;case"share":n.getDlinkShare(i,t);break;case"normal":default:n.getDlinkPan(i,o||"nolimit",function(n){"function"==typeof t&&t(n)},void 0,void 0,"POST")}})}function o(i,t){var o,c=null;if(l.setContext(i),"object"==typeof t&&t.filesList){if(c=t.filesList.length>0?t.filesList:[t.filesList],o=!!t.hasDlink,t.getDlink&&t.callback){var d=s.pluck(c,"fs_id");return void e(d,t.callback,t.filePosition)}}else if("string"==typeof t)c=[{dlink:t}],o=!0;else{if("object"==typeof t&&t.fsids&&t.getDlink)return void e(t.fsids,t.callback,t.filePosition);c=i.list.getSelected()}n.async("function-widget-1:download/controller/downloadController.js",function(n){var e={list:c,hasDlink:o};"share"===i.pageInfo.currentProduct&&(e={list:c,product:t&&"unzip"===t.from?"pan":i.pageInfo.currentProduct,hasDlink:o,share_uk:a.SHARE_UK,share_id:a.SHARE_ID,sign:a.SIGN,timestamp:a.timestamp}),n.download(e)})}var s=n("base:widget/libs/underscore.js"),a=window.yunData||{},l=n("function-widget-1:download/util/context.js");n("function-widget-1:download/service/guanjiaConnector.js"),t.exports.start=function(n,i){a.SHAREPAGETYPE?window.yunHeader.nameVerify(function(){o(n,i)}):o(n,i)},t.exports.getDownloadLink=function(n,i){l.setContext(n),e(i.config,i.callback,i.type,i.linkType)}});