define("system-core:context/SystemContext.js",function(e,t,s){function o(e){var t=this;if(this.isSystem=!!e,r.each(o.constructorList,function(e){e.call(t)}),e){if(o.instanceForSystem)return o.instanceForSystem;o.instanceForSystem=this,this.message=i,this.pluginControl=c}else this.message=new i}var n=e("base:widget/libs/jquerypacket.js"),r=e("base:widget/libs/underscore.js"),i=e("system-core:system/baseService/message/message.js"),c=e("system-core:pluginHub/main.js"),a=e("base:widget/router/Router.js").app,u=0;o.instanceForSystem=null,o.constructorList=[],o.extend=function(e,t){if("object"!=typeof e){if("string"==typeof e&&void 0!==t)if("object"==typeof t){var s=o.prototype[e];if(s)for(var n in t)t.hasOwnProperty(n)&&(s[n]=t[n])}else o.prototype[e]=t}else for(var r in e)e.hasOwnProperty(r)&&(o.prototype[r]?o.extend(r,e[r]):o.prototype[r]=e[r])},o.use=function(e,t){e(o,t)},r.extend(o.prototype,{addIconFont:!1,router:a,libs:{JQuery:n,$:n,underscore:r,_:r},pageInfo:{currentPage:"disk-home",currentProduct:"pan"},extend:o.extend,obtainId:function(){return"_system_id_"+ ++u}}),s.exports=o});
;define("system-core:pluginHub/invoker/pageLetInvoker.js",function(t,e,i){function o(t){var e=t.size.split("*");if(2!==e.length)throw new Error("wrong size property: ERROR!");var i=e[0],o=e[1],n="<div";void 0!==t.index&&(n+=' data-index="'+t.index+'"'),n+=' node-type="layout-absolute-box"',t.containerId&&(n+=' id="'+t.containerId+'"'),t.className&&(n+=' class="'+t.className+'"');var s=' style="width: '+i+"; height: "+o+"; background:"+(t.bg||"none")+"; z-index: "+(Number(t.zIndex)||0)+"; ";return t.extra&&a.each(t.extra,function(t,e){s+=e+": "+t+"; "}),s+='">',r(n+s)}function n(t){var e=t.selector,i=t.className,o=t.shortestDistance;this.count=0,this.contentElement=r(e);var n=i||"absolute-container",s=this.absoluteContainer=r('<div class="'+n+'">').css({visibility:"hidden",position:"absolute",width:"100%"});this.contentElement.append(s),r(window).resize(a.debounce(function(){var t=s.offset().top,e=s.data("isMoved");o>t?(s.data("isMoved",!0),s.css({position:"relative",bottom:0})):e&&s.css({position:"absolute",bottom:""})},500)),r(window).trigger("resize"),this.onPushPageLet=function(t){var e=this.absoluteContainer.height();if(this.absoluteContainer.height(e+t.height()),this.count++,1===this.count)this.absoluteContainer.append(t);else{for(var i,o,n=+t.data("index"),s=this.absoluteContainer.find('div[node-type="layout-absolute-box"]'),a=0,r=s.length;r>a;a++)if(i=s.eq(a),o=+i.data("index"),o>n)return void i.before(t);this.absoluteContainer.append(t)}}}function s(){this.ready=!1,this.layoutList={},this.autoExecCount=-1,this.initedCount=0}var a=t("base:widget/libs/underscore.js"),r=t("base:widget/libs/jquerypacket.js");s.prototype.setArea=function(t,e){this.layoutList[t]={layout:e,isUsed:!1},this.ready=!0},s.prototype.onready=function(){r.each(this.layoutList,function(t,e){e.isUsed&&e.layout.absoluteContainer.css("visibility","visible")})},s.prototype.addLayout=function(t){if(!this.ready||-1===this.autoExecCount)throw new Error("please set area firstly");if(!t.area)throw new Error("no area property, ERROR!");var e=o(t);this.initedCount++;var i=this.layoutList[t.area];return i?(i.isUsed=!0,i.layout.onPushPageLet(e),this.initedCount===this.autoExecCount&&this.onready(),e):null};var u=new s;i.exports.setAutoExecCount=function(t){u.autoExecCount=t},i.exports.setArea=function(t){r.isArray(t)||(t=[t]),r.each(t,function(t,e){u.setArea(e.name,new n(e))})},i.exports.usePageLet=function(){return u.ready},i.exports.invoke=function(t){return u.addLayout(t)}});
;define("system-core:pluginHub/data/Registry.js",function(e,n,t){var r=e("base:widget/libs/underscore.js"),i={};i.nameHash={},i.otherInfo={},i.fileHandle={_:[],"*":[]},i.defaultFileHandle={},i.plugin={},i.preload=[],i.autoExecute=[],i.randomID=function(){var e=String.fromCharCode(i.prefix++);return i.prefix>90&&(i.prefix=65),e+=Math.random().toString(16).substring(3).toUpperCase()},i.prefix=65,i.handleFile=function(e,n,t){if(!t)return void i.fileHandle._.push(e);if("*"===t)return void i.fileHandle["*"].push(e);t=String(t).replace(/"|\.|\*/g,"").split(",");for(var r,l,a=0,u=t.length;u>a;a++)r=t[a],l=i.fileHandle[r]||(i.fileHandle[r]=[]),l.push(e),2!=n||i.defaultFileHandle[r]||(i.defaultFileHandle[r]=e)},i.getPluginIdsByExtension=function(e){if(!r.isArray(e)||!i.fileHandle[e[0]])return null;for(var n=i.fileHandle[e[0]],t=n.length,l=1,a=e.length;a>l;l++){if("undefined"==typeof i.fileHandle[e[l]]){n=null;break}i.fileHandle[e[l]].length<t&&(n=i.fileHandle[e[l]],t=t.length)}if(n){n=r.assign(n);for(var u=0,o=n.length;o>u;u++)for(var s=0,f=e.length;f>s;s++){var p=i.plugin;if(-1===p[n[u]].filesType.indexOf(e[s])||-1===p[n[u]].type.indexOf("2")){n.splice(u,1),--u,o=n.length;break}}}return n},i.getPluginsByIds=function(e){return r.isArray(e)?r.map(e,function(e){return i.plugin[e]}):[]},t.exports.register=function(e,n){var t=i.randomID(),r=e.name,l=e.group,a=i.nameHash[l]||(i.nameHash[l]={});return a[r]=t,i.plugin[t]={pluginId:t,name:r,loaded:!1,type:e.type,filesType:e.filesType,entranceFile:e.entranceFile},i.otherInfo[t]={group:l,depsFiles:e.depsFiles,description:e.description,version:e.version,supportManage:"false"!==String(e.supportManage)},n?null:(i.handleFile(t,e.type,e.filesType),e.interface&&(e.autoExecute=!0),e.autoExecute?i.autoExecute.push(e):e.preload&&i.preload.push(e),t)},t.exports.getAllPlugins=function(){return r.map(i.plugin,function(e){return e})};var l=t.exports.getPluginById=function(e){return i.plugin[e]||null};t.exports.getPluginByNameAndGroup=function(e,n){if("string"!=typeof e)throw new Error("[regedit.js] The plugin name is must be a string !");if(!n){var t=e.match(/^(.+)@(([\w\-]+\.)+[\w\-]+)$/);t&&(e=t[1],n=t[2])}var r=i.nameHash[n]&&i.nameHash[n][e];return l(r)},t.exports.getPluginsByExtension=function(e){var n=i.fileHandle["*"],t=r.filter(n,function(e){return e.type.indexOf("2")>-1});"string"==typeof e&&(e=e.replace(/"|\.|\*/g,"").split(","));var l=i.getPluginIdsByExtension(e);return null!==l&&(t=t.concat(l)),i.getPluginsByIds(t)},t.exports.getDefaultPluginIdByExtension=function(e){return e=e.replace(/"|\.|\*/g,""),i.defaultFileHandle[e]?i.defaultFileHandle[e]:i.fileHandle[e]&&i.fileHandle[e][0]},t.exports.getOtherInfoById=function(e){return i.otherInfo[e]||null},t.exports.getAutoExecutePlugins=function(){return i.autoExecute},t.exports.getPreloadPlugins=function(){return i.preload}});
;define("system-core:system/baseService/message/message.js",function(e,t,s){function n(){this.events={},this.instanceForSystem=n,this.isSystem=!1}var i=e("base:widget/libs/underscore.js"),r=/^plugin:.+$/;n.events={},n.isSystem=!0,n.prototype={constructor:n,_define:function(e){"string"==typeof e&&(this.exist(e)||(this.events[e]={handlers:[]}))},exist:function(e){return this.events[e]},listen:function(e,t,s){if("string"!=typeof e)throw new Error("[message] The eventName must be a string !");if("function"==typeof t){this.exist(e)||this._define(e);var n=this.events[e];i.contains(n.handlers,t)||(s&&(t.__isOnce__=!0),n.handlers.push(t))}},once:function(e,t){this.listen(e,t,!0)},remove:function(e,t){this.exist(e)&&(this.events[e].handlers=i.isFunction(t)?i.filter(this.events[e].handlers,function(e){return e!==t}):[],0===this.events[e].handlers.length&&delete this.events[e])},triggerHandlers:function(e){for(var t=this.events[e],s=t.handlers,n=[].slice.call(arguments,1),i=0,r=null,o=s.length;o>i;i++)r=s[i],null!==r&&(r.__isOnce__&&(s[i]=null),r.apply(void 0,n))},trigger:function(e){return r.test(e)?void n.doPlugins(arguments):this.exist(e)?void this.triggerHandlers.apply(this,arguments):void n.doPlugins(arguments)},callPlugin:function(e,t){if("string"!=typeof e)throw new Error("[message] The pluginName must be a string !");n.trigger("plugin:"+e,t)},callSystem:function(e,t){if("string"!=typeof e)throw new Error("[message] The systemServiceName must be a string !");n.trigger(e,t)},listenSystem:function(e,t,s){n.listen(e,t,s)}},i.extend(n,n.prototype,{doPlugins:function(e){i.isArguments(e)||(e=arguments),e=[].slice.call(e,0),e.unshift("managePlugins"),this.triggerHandlers.apply(this,e)},trigger:function(e){return this.exist(e)?void this.triggerHandlers.apply(this,arguments):void this.doPlugins(arguments)},manage:function(e){this.listen("managePlugins",e)}}),s.exports=n});
;define("system-core:pluginHub/data/BrokerData.js",function(e,t,n){function o(e,t){e.pluginId=t,"object"==typeof e&&"undefined"==typeof e.length?"string"==typeof e.title&&("file"===e.type?(delete e.type,p.contextMenu.file.push(e)):(delete e.type,p.contextMenu.blank.push(e)),"share"===e.product&&(delete e.product,p.contextMenu.share.push(e))):e.length&&("undefined"!=typeof e[0].index&&(e.index=e[0].index),"file"===e[0].type?(delete e[0].type,p.contextMenu.file.push(e)):(delete e[0].type,p.contextMenu.blank.push(e)))}function u(e){return p.button[e]||[]}var i=e("base:widget/libs/underscore.js"),p={button:{},fileIcon:{},"interface":[],contextMenu:{file:[],blank:[],share:[]}};n.exports.pushPageLet=function(e,t){p["interface"].push(i.extend({pluginId:e},t))},n.exports.pushButtonFunction=function(e,t){if(!e)throw new Error("pushButtonFunction must be have a pluginId");i.isArray(t)||(t=[t]),i.each(t,function(t){t.pluginId=e;var n=t.position;n&&(t.position=void 0,i.each(n.split(","),function(e){(p.button[e]||(p.button[e]=[])).push(t)}))})},n.exports.pushFileHandle=function(e){i.extend(p.fileIcon,e)},n.exports.pushContextMenu=function(e,t){if("object"==typeof t&&"undefined"==typeof t.length)o(t,e);else if(t.length)if(1===t.length&&"string"==typeof t[0].title)o(t,e);else for(var n=0,u=t.length;u>n;n++)o(t[n],e)},n.exports.getButton=u,n.exports.getAllData=function(){return p};var r=i.extend({getButton:u},p);n.exports.getFaceData=function(){return r},n.exports.getMenu=function(e){return p.contextMenu[e]||[]}});
;define("system-core:pluginHub/invoker/invoker.js",function(e,n,t){function i(e){return(e.match(l)||e.match(f)||[""]).slice(1)}function s(n,t){function i(){e.async(n.entranceFile,function(e){n.loaded=!0,r.isFunction(t)&&t(e)})}if(n.loaded)return i();var s=a.getOtherInfoById(n.pluginId).depsFiles;if(""===s||void 0===s)return void i();var u=[],o=[];r.isArray(s)||(s=[s]),r.each(s,function(e){/^.+\.(css|less)$/.test(e)?u.push(e):/^.+\.js$/.test(e)&&o.push(e)});var c=!!u.length,g=!!o.length;c&&g?e.loadCss(u,function(){e.async(o,function(){i()})}):c?e.loadCss(u,function(){i()}):g?e.async(o,function(){i()}):i()}function u(e,n){n||(n={});var t=g.usePageLet();s(e,function(i){var s=i[n.run||"start"];s||(s=i.start);var u=d[e.pluginId]||(d[e.pluginId]=new o(!1));return t?void(e.interface?s(u,{$container:g.invoke(e.interface)}):s(u,n)):s(u,n)})}var r=e("base:widget/libs/underscore.js"),o=e("system-core:context/SystemContext.js"),c=e("system-core:system/baseService/message/message.js"),a=e("system-core:pluginHub/data/Registry.js"),g=e("system-core:pluginHub/invoker/pageLetInvoker.js"),l=/^plugin:([A-Z0-9]+)$/,f=/^plugin:((\S+)@(\S+))$/,d={},v=t.exports.execPlugin=function(e,n){if(e){if(r.isString(e)){var t=i(e),s=t.length;if(!s)return;e=3===s?a.getPluginByNameAndGroup(t[1],t[2]):a.getPluginById(t)}e&&e.pluginId&&u(e,n)}};c.listen("managePlugins",v),t.exports.invoke=function(e){if(e||(e={}),e.canAutoExecute!==!1){var n=a.getAutoExecutePlugins(),t=r.filter(n,function(e){return!(e.interface&&e.autoExecute)});g.usePageLet()?g.setAutoExecCount(n.length-t.length):n=t,r.each(n,u),setTimeout(function(){r.each(a.getPreloadPlugins(),s)},1e3)}}});
;define("system-core:pluginHub/register/register.js",function(require,exports,module){function preLoadManifest(){var manifests=window.manifest;return _.filter(manifests,function(manifest){var ignore=manifest.ignore;return _.isString(ignore)&&(ignore=eval(ignore)),!ignore})}var storage=require("base:widget/storage/storage.js"),tools=require("base:widget/tools/tools.js"),_=require("base:widget/libs/underscore.js"),BrokerData=require("system-core:pluginHub/data/BrokerData.js"),Registry=require("system-core:pluginHub/data/Registry.js"),browserString=tools.client().browserString,browserName=browserString.match(/[a-zA-Z]+/);browserName&&(browserName=new RegExp("(^|,)"+browserName[0]+"(,|$)")),module.exports.injectPlugin=function(){var e=preLoadManifest();if(e)for(var r,t,s,n=0,o=e.length;o>n;n++)r=e[n],t=r.notSupport,s="",t&&(~t.indexOf(browserString)||browserName&&browserName.test(t))||"string"==typeof r.name&&"string"==typeof r.group&&(_.isObject(r.filesIcon)&&BrokerData.pushFileHandle(r.filesIcon),!/^-\d$/.test(r.type)&&r.entranceFile&&(s=r.pluginId=Registry.register(r),r.interface&&BrokerData.pushPageLet(s,r["interface"]),_.isArray(r.buttons)&&BrokerData.pushButtonFunction(s,r.buttons),r.contextMenu&&BrokerData.pushContextMenu(s,r.contextMenu)))}});
;define("system-core:pluginHub/main.js",function(e,t,n){var a=e("system-core:pluginHub/data/Registry.js"),s=e("system-core:pluginHub/data/BrokerData.js"),r=e("system-core:pluginHub/register/register.js"),i=e("system-core:pluginHub/invoker/pageLetInvoker.js");n.exports={BrokerData:s,Registry:a,init:function(t){r.injectPlugin(),e.async("system-core:pluginHub/invoker/invoker.js",function(e){e.invoke(t)})},setArea:i.setArea,getFaceData:s.getFaceData},n.exports.setButtonContainer=function(){},n.exports.pluginData=n.exports.getPluginData=function(){return a},define("system-core:data/faceData.js",function(e,t){t.getData=s.getFaceData}),define("system-core:data/regedit.js",function(e,t,n){n.exports=a})});