define("disk-share:widget/pageModule/activateGuide/activateGuide.js",function(t,e,i){var a=t("base:widget/libs/jquerypacket.js"),o=t("system-core:context/context.js").instanceForSystem,n={};n.LoginActivate=1,n.unLoginActivate=2,n.main=function(){var t=this;this._insertStyle(),a(window).ready(function(){1==yunData.LOGINSTATUS?a.get("/api/account/uinfo?t="+(new Date).getTime(),function(e){try{var i=a.parseJSON(e)||e}catch(o){}0==i.type&&t.warmupHTML(n.LoginActivate)}):t.warmupHTML(n.unLoginActivate)})},n.insertStyle=function(t){var e=document.createElement("style");e.type="text/css",document.getElementsByTagName("head")[0].appendChild(e),e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))},n._insertStyle=function(){if(!this._styleInserted){this._styleInserted=!0;var t=[],e="",i="";if(e="undefined"!=typeof Page&&(Page.inViewMode(Page.VIEW_PROPERTY_OTHER)||Page.inViewMode(Page.VIEW_HOME_PAGE_SLAVE))?"25px":"5px",a.browser.msie&&6==a.browser.version){i="absolute";var o=0;a(window).scroll(function(){clearTimeout(o),o=setTimeout(function(){"5px"==a(".activate-outer").css("bottom")&&a(".activate-outer").css("bottom","6px").css("bottom","5px")},200)})}else i="fixed";t.push(".activate-outer { display:none; background:#fcfaf2; width: 265px;bottom: -195px;z-index: 2999;padding: 10px;border: 1px solid #d4d4d4;border-radius: 3px;color:#424e67;}"),t.push(".activate-outer {right: "+e+"; position:"+i+"; }"),t.push(".activate-outer dl { margin-bottom: 10px;}"),t.push(".activate-h{ font-size: 14px; font-weight: bold;}"),t.push(".activate-cls-btn{ width: 20px; height: 20px; background: url(/box-static/disk-share/widget/pageModule/activateGuide/img/_nomd5/btn_icon.gif?t=20161013001) -106px -114px no-repeat;cursor: pointer;}"),t.push(".activate-noti{ padding: 20px;}"),t.push(".activate-noti-h-ico{ width: 25px;  height: 20px; background:url(/box-static/disk-share/widget/pageModule/activateGuide/img/_nomd5/btn_icon.gif?t=20161013001) 0px -576px no-repeat; _display:inline; margin: 0 7px 0 -3px;}"),t.push(".activate-btn,.activate-btn b{ position: relative; height: 37px;width: 130px;display: block;text-align: center;line-height: 37px;margin: 0 auto;font-size: 14px;color: white;background: #fd6d65;text-decoration: none;cursor: pointer;padding-left: 1px; font-weight: normal; }"),t.push(".activate-btn b{ background-position: right -711px; }"),t.push(".activate-btn:hover,.activate-btn:active{ color: white;text-decoration:none; }"),t.push(".activate-btn:hover{background-position:  0 -763px; }"),t.push(".activate-btn:hover b{ background-position: right -763px; }"),t.push(".activate-btn:active{background-position:  0 -817px; }"),t.push(".activate-btn:active b{ background-position: right -817px; }"),t.push(".activate-qq { width: 280px;}"),t.push(".activate-qq .activate-noti { padding: 30px 15px;}"),t.push(".activate-qq .activate-btn b{ }"),t.push(".activate-qq .activate-qq-ico { height: 27px;width: 24px;position: absolute;left: 10px;top: 5px;background: url('/box-static/disk-share/widget/pageModule/activateGuide/img/_nomd5/btn_icon.gif?t=20161013001') -29px -577px no-repeat;z-index: 1;}"),t.push(".active-disk { width: 300px; height: 200px; background:url(/res/static/images/active_pan_1024.png?t=201308291902) center no-repeat; border: none; padding: 0;}"),t.push(".active-disk .activate-disk-cls-btn { display:block; width:10px; height:10px; position:absolute; top:8px; right:10px; cursor:pointer; font-size: 0;}"),t.push(".active-disk .activate-disk-btn { display:block; width:175px; height:45px; position:absolute; top:145px; left:60px; cursor:pointer;font-size: 0;}"),this.insertStyle(t.join(""))}},n.warmupHTML=function(t){var e=[];switch(t){case n.LoginActivate:e.push('<div id="activateGuidePopupOuter" class="activate-outer">'),e.push('<dl class="clearfix"><span class="activate-noti-h-ico b-fl"></span><h1 class="activate-h b-fl">百度网盘赠送空间</h1><span class="activate-cls-btn b-fr"></span></dl>'),e.push('<dl class="activate-noti clearfix"><!--span class="activate-noti-ico b-fl"></span-->发放福利啦！你已是百度用户，点击即可领取百度网盘<span style="font-weight:bold;">2048G永久免费容量</span>。</dl>'),e.push('<dl><a hideFocus="true" target="_blank" href="//pan.baidu.com/disk/home#from=share_activate_guide" class="activate-btn"><b>领取2048G容量</b></a></dl>'),e.push("</div>");break;case n.unLoginActivate:e.push('<div id="activateGuidePopupOuter" class="activate-outer activate-qq">'),e.push('<dl class="clearfix"><span class="activate-noti-h-ico b-fl"></span><h1 class="activate-h b-fl">百度网盘赠送空间</h1><span class="activate-cls-btn b-fr"></span></dl>'),e.push('<dl class="activate-noti clearfix"><!--span class="activate-noti-ico b-fl"></span-->发福利啦！新用户可以获得百度网盘<span style="font-weight:bold;">2048G永久免费容量</span>，超大文件极速秒传！</dl>'),e.push('<dl><a hideFocus="true" class="activate-btn third-qq"><b>领取2048G容量</b></a></dl>'),e.push("</div>")}var i=e.join("");a("body").append(i),this.toggleFn(t),this.visible(!0),n._buildIFrameMask()},n._buildIFrameMask=function(){var t=document.createElement("iframe");document.getElementById("activateGuidePopupOuter").appendChild(t),t.frameBorder="0",t.src="about:blank",t.style.position="absolute",t.style.left="0",t.style.top="0",t.style.zIndex="-1",t.style.width="100%",t.style.height="100%",a(t).css("opacity","0")},n.toggleFn=function(t){var e=this;switch(a(".activate-cls-btn , .activate-btn").click(function(){e.visible(!1)}),t){case n.unLoginActivate:n.thirdLogin()}},n.thirdLogin=function(){if("undefined"!=typeof disk){var t=-1;disk.globalThirdLoginSuccess=function(){-1!==document.cookie.indexOf("BDU_THIRD")&&(o.log.send({name:"share_qq_activate_guide_succ"}),o.log.sendUserReport("share_qq_activate_guide"),clearTimeout(t),setTimeout(function(){window.location.reload()},500))}}a(".activate-outer a.third-qq").click(function(){window.location.href="//pan.baidu.com/?frm=sharelogin"})},n.visible=function(t){t?a(".activate-outer").show().animate({bottom:5},1e3):a(".activate-outer").hide()},n.main(),i.exports=n});
;define("disk-share:widget/pageModule/adPlatform/adPlatform.tpl.js",function(i,t,e){var n={alljs:["<%= content %>"].join(""),singletext:["<%for(var i=0; i < info.length; i++){%>","<% var item = info[i]%>",'<a target="_blank" href="<%- item.action.action %>" title="<%- item.content %>">',"<%- item.content %>","</a>","<%}%>"].join(""),singleimage:["<%for(var i=0; i < info.length; i++){%>","<% var item = info[i]%>",'<a target="_blank" href="<%- item.action.action %>" title="<%- item.action.param.title %>"',' style="background:url(<%- item.content %>) no-repeat;height:<%- imgs %>;display:block;">',"</a>","<%}%>"].join(""),multiimage:["<%for(var i=0; i < info.length; i++){%>","<% var item = info[i]%>",'<a target="_blank" href="<%- item.action.action %>" title="<%- item.action.param.title %>"',' style="background:url(<%- imgs %>) repeat;height:90px;display:block;position:absolute;width:100%;">','<img src="<%- item.content %>" class="share-center" />',"</a>","<%}%>"].join(""),video:["<video>",'<source src="<%- info.content %>">',"</video>"].join(""),wangmengAside:['(window["cproStyleApi"] = window["cproStyleApi"] || {})','[ "u2380627" ]={at:"3",rsi0:"200",rsi1:"200",pat:"17",tn:"baiduCustNativeAD",','rss1:"#FFFFFF",conBW:"1",adp:"1",ptt:"0",','titFF:"%E5%BE%AE%E8%BD%AF%E9%9B%85%E9%BB%91",','titFS:"",rss2:"#000000",titSU:"0"};',"(window.cproArray = window.cproArray || []).push({",'id: "u2380627"',"});"].join(""),wangmengSingle:["(window.cproArray = window.cproArray || []).push({",'id: "u2493175"',"});"].join(""),wangmengBottom:["(window.cproArray = window.cproArray || []).push({",'id: "u2164871"',"});"].join("")};e.exports=n});
;define("disk-share:widget/pageModule/adPlatform/adPlatformService.js",function(e,a,t){var n=e("base:widget/libs/jquerypacket.js"),i=e("base:widget/libs/underscore.js"),r=e("disk-share:widget/system/util/FELog.js"),d=e("disk-share:widget/pageModule/adPlatform/adPlatform.tpl.js"),l=window.yunData||{},o={init:function(){o.dealWithAdShow(),o.eventInit()},dealWithAdShow:function(){var e=this,a=null;for(var t in o.data)e.checkAd(o.data[t])?("web-sharelinkpic"===t||"web-sharesinglebanner"===t||"web-sharemultibanner"===t)&&e.createScript(t):(a=o.data[t]&&o.data[t].list[0].type.toLowerCase()||"image",o.dealSingleAd(t,a))},checkAd:function(e){return null===e||e&&e.error_code},createScript:function(e){var a=document.createElement("div"),t=document.createElement("script"),n=document.createElement("script");if(""===t.innerHTML||""===t.innerHTML)return!1;var i={"web-sharelinkpic":{shareIdStr:"web-right-view",uid:"u2380627",shareTpl:"wangmengAside"},"web-sharesinglebanner":{shareIdStr:"web-single-bottom",uid:"u2493175",shareTpl:"wangmengSingle"},"web-sharemultibanner":{shareIdStr:"web-multi-bottom",uid:"u2164871",shareTpl:"wangmengBottom"}},r=document.getElementById(i[e].shareIdStr||"web-right-view");t.innerHTML=d[i[e].shareTpl||"wangmengAside"],t.type=n.type="text/javascript",n.src=window.location.protocol+"//cpro.baidustatic.com/cpro/ui/c.js",a.id="cpro_"+(i[e].uid||"u2380627"),r.appendChild(a);var l=document.getElementById("cpro_"+(i[e].uid||"u2380627"));l.appendChild(t),l.appendChild(n),t=null,n=null},formatHTTP:function(e){return i.isArray(e)&&e.length>0&&e[0].content?e[0].content=e[0].content.replace(/https?:/gi,window.location.protocol):i.isString(e)&&(e=e.replace(/https?:/gi,window.location.protocol)),e},dealSingleAd:function(e,a){var t="",r=n('.ad-platform-tips[node-id~="'+e+'"]');if("js"===a)if("baichuan"===o.data[e].list[0].uid){var l="";l="web-sharemultibanner"===e?['<div style="margin: 0 auto; width: 960px;">',o.base64decode(o.data[e].list[0].content),"</div>"].join(""):o.base64decode(o.data[e].list[0].content),r.html(l)}else{a="all"+a;var s=document.createElement("div"),c=document.createElement("script"),p=document.createElement("script");p.type="text/javascript",p.src=window.location.protocol+"//cpro.baidustatic.com/cpro/ui/c.js";var u=i.template(d[a])({content:o.base64decode(o.data[e].list[0].content)});s.id="cpro_"+(o.data[e].list[0].uid||"u2380627"),"web-sharemultibanner"===e&&(s.style="margin: 0 auto; width: 960px;"),c.innerHTML=u,r.append(s);var h=n("#cpro_"+(o.data[e].list[0].uid||"u2380627"));h.append(c),h.append(p),c=null,p=null}else{"web-sharemultibanner"===e?(a="multi"+a,t=o.data["web-sharelinkrepeat"].list?o.formatHTTP(o.data["web-sharelinkrepeat"].list[0].content):null):(a="single"+a,t="web-sharelinkpic"===e?"200px":"90px");var u=i.template(d[a])({info:o.formatHTTP(o.data[e].list),imgs:t});r.append(u)}this.sendViewCallback(e)},eventInit:function(){o.adPlatformTips.on("click",function(){var e=n(this).attr("node-id");o.sendClickCallback(e)})},base64decode:function(e){var a,t,n,i,r,d,l,o=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1];for(d=e.length,r=0,l="";d>r;){do a=o[255&e.charCodeAt(r++)];while(d>r&&-1===a);if(-1===a)break;do t=o[255&e.charCodeAt(r++)];while(d>r&&-1===t);if(-1===t)break;l+=String.fromCharCode(a<<2|(48&t)>>4);do{if(n=255&e.charCodeAt(r++),61===n)return l;n=o[n]}while(d>r&&-1===n);if(-1===n)break;l+=String.fromCharCode((15&t)<<4|(60&n)>>2);do{if(i=255&e.charCodeAt(r++),61===i)return l;i=o[i]}while(d>r&&-1===i);if(-1===i)break;l+=String.fromCharCode((3&n)<<6|i)}return l},sendCallback:function(e,a){var t="";"string"==typeof l.sampling&&l.sampling.indexOf("chengyong")>=0&&(t="shareLinkSmall");var n=(new Date).getTime()+e;window[n]=new Image;var i=window[n];if(e){var r=0,d=0;switch(e){case"web-sharelinkpic":r=200,d=200;break;case"web-sharemultibanner":d=910,r=90;break;case"web-sharesinglebanner":d=710,r=90;break;default:return}var o="&h="+r+"&w="+d+"&p="+(e+t||"web-text")+"&s="+encodeURIComponent(a),s="//pan.baidu.com/rest/2.0/pcs/adx?m=callback"+o;i.onload=i.onerror=function(){window[n]=null},i.src=s,i=null}},sendViewCallback:function(e){var a="";"string"==typeof l.sampling&&l.sampling.indexOf("chengyong")>=0&&(a="shareLinkSmall"),r.obtain.send({type:"web_show_"+o.data[e].list[0].id+a}),this.sendCallback(e,o.data[e].vsign)},sendClickCallback:function(e){var a="";"string"==typeof l.sampling&&l.sampling.indexOf("chengyong")>=0&&(a="shareLinkSmall"),r.obtain.send({type:"web_click_"+o.data[e].list[0].id+a}),this.sendCallback(e,o.data[e].csign)}},s={init:function(e){e||(e={}),o.data=e.data||{},o.adPlatformTips=e.AdPlatformTips||{},o.init()}};t.exports=s});
;define("disk-share:widget/pageModule/adPlatform/adPlatform.js",function(t,a,i){!function(){"use strict";var a=t("base:widget/libs/jquerypacket.js"),o=t("disk-share:widget/pageModule/adPlatform/adPlatformService.js"),r=function(){this.AdPlatformTips=a(".ad-platform-tips"),this.config={},this.errorCount=0,this.data={}};r.prototype={getAdResoucre:function(t,i,o){var r=this;t=t||{list:[{id:"web-text",w:0,h:0}],uk:window.yunData?window.yunData.MYUK:""},r.data=t,a.ajax({type:"GET",url:"/feproxy/ad/list",dataType:"json",data:t,success:function(t){t?(i&&"function"==typeof i&&i.call(r,t),r.configInitData(t)):(r.errorCount++,o&&"function"==typeof o&&o.call(r,t),r.errorCallback(t))},error:function(t){r.errorCount++,o&&"function"==typeof o&&o.call(r,t),r.errorCallback(t)}})},configInitData:function(t){this.config.data=t.data,this.config.AdPlatformTips=this.AdPlatformTips,o.init(this.config)},errorCallback:function(t){var a=this;t&&0!==t.errno&&1===a.errorCount&&(a.getAdResoucre(a.data),a.data=null)}},r.init=function(){return new r},i.exports=r.init()}()});
;define("disk-share:widget/pageModule/commentPanel/commentPanel.js",function(e,t,o){var a=e("base:widget/libs/jquerypacket.js"),i=e("base:widget/tools/tools.js"),s=e("system-core:context/context.js").instanceForSystem,n=function(){this._init()};n.defaults={domType:1,start:0,limit:20,scroll:!0,currentPageNum:1,avatar_url:"http://himg.bdimg.com/sys/portrait/item/c458fe2e.jpg"},n.API={create:"/pcloud/comment/create",remove:"/pcloud/comment/delete",list:"/pcloud/comment/list",vcode:"/pcloud/comment/vcode"},n.MSG={empty:"评论内容不能为空，说两句吧",limit:"评论内容超出300字限制了",sensitive:"评论内容有敏感词，优化一下吧",error:"评论失败，请稍候再试",error_param:"参数错误",same:"相同内容的评论歇会再发吧",quick:"评论发布过快，稍后再试吧",server:"服务器错误，请稍后重试一下",no_share:"该分享不存在",no_comment:"该评论不存在",empty_vcode:"验证码不能为空",error_vcode:"验证码输入错误",forbid_user:"用户名已被封禁，如有问题请联系客服"},n.singleton=null,n.prototype.startInit=function(e,t){var o=this;this.config=t,a.extend(this,n.defaults,t),this.$container=e,this._initBefore(),this._touchDataControll(function(){o._initSuccessCallback()},function(){o.model={count:0,comment_list:[]},o._initSuccessCallback()})},n.obtain=function(){return null===n.singleton&&(n.singleton=new n),n.singleton},n.prototype.getTotalCount=function(){console.log("fuck, why you get updated here?")},n.prototype.setArrawLeftPosi=function(e){this.$parentDom.find(".arraw").css("left",e+"px")},n.prototype.onUpdateCount=function(){},n.prototype.setVisible=function(e,t,o){this.startInit(t,o)},n.prototype.onAfterPageComponents=function(){},n.prototype._init=function(){a.browser.msie&&a.browser.version<=6&&(this.ie6=!0)},n.prototype._initBefore=function(){this.$container.html(this._preModuleDom()),this.$errorMessage=this.$module.find(".error-message"),this.$vcode=this.$module.find(".vcode"),this.$inputVCode=this.$module.find(".input-code"),this.$imgVCode=this.$module.find(".img-code"),this._bindTextareaFocus(),this.config&&"function"==typeof this.config.onLoadedTextarea&&this.config.onLoadedTextarea()},n.prototype._getBottomDom=function(e){var t,o="";return 0===e&&(o=' fn-hide"'),t=['<div class="list'+o+'">','<div class="total">共<span>'+e+"</span>条</div>",'<ul class="feed"></ul>',"</div>",'<div class="page clearfix">',"</div>"],t.join("")},n.prototype._getTopDom=function(){var e;if(this.domType<=1)e=['<div class="module-comment module-comment-page">','<div class="header">','<h3 class="title">参与评论</h3>','<div class="description">','<textarea class="area" id="commentTextarea"></textarea>','<label class="placeholder">来说两句话~</label>',"</div>",'<div class="deal clearfix">','<div class="vcode fn-hide fn-fl">','<div class="verify-body1">验证码：<input type="text" class="input-code" maxlength="4">','<img class="img-code" />','<span class="img-txt">验证码获取中</span>','<a href="javascript:void(0);" class="underline">换一张</a>',"</div>","</div>",'<div class="operation fn-fr">','<a href="javascript:void(0);" class="btn-comment">评论</a>',"</div>","</div>",'<div class="error-message"></div>',"</div>","</div>"];else{var t="";this.ie6&&(t=3===this.domType?' style="_width: 97.8%;"':' style="_width: 98%"'),e=['<div class="module-comment module-comment-dialog">','<div class="header">','<div class="description">','<textarea class="area"'+t+"></textarea>",'<label class="placeholder">我来评两句~</label>',"</div>",'<div class="deal clearfix">','<div class="vcode fn-hide fn-fl">','<div class="verify-body1">验证码：<input type="text" class="input-code" maxlength="4">','<img class="img-code" />','<span class="img-txt">获取中</span>','<a href="javascript:void(0);" class="underline">换一张</a>',"</div>","</div>",'<div class="operation fn-fr">','<span class="error-message"></span>','<a href="javascript:void(0);" class="btn-comment">评论</a>',"</div>","</div>","</div>","</div>"]}return e.join("")},n.prototype._hideVCode=function(){this.$vcode.removeClass("fn-block").addClass("fn-hide").data("isShow",!1)},n.prototype._verifyCodeLoad=function(){var e=this.$imgVCode,t=e.next(".img-txt"),o=this;this.$inputVCode.val(""),this.$vcode.removeClass("fn-hide").addClass("fn-block").data("isShow",!0),t.addClass("fn-iblock"),e.hide(),a.get(n.API.vcode+"?&t="+Math.random(),function(a){0===a.errno?(e.attr("src",a.imgurl),o.vcode_str=a.vcode_str,e.show(),t.hide(),disk.DEBUG&&console.log("验证码获取成功！")):t.text("获取失败").addClass("fn-iblock")},"json")},n.prototype._getItemListDom=function(e){var t="",o=this;return e.length>0&&a.each(e,function(e,a){t+=o._getItemDom(a)}),t},n.prototype._preventXSS=function(e){return e.replace(/\"|\'|\\|\<|\>|\=|\//g,function(e){return"\\\\\\"+e})},n.prototype._getItemDom=function(e){var t,o="";return e.comment_time=this._formatDate(e.comment_time),e.parent_comment_id&&"0"!=e.parent_comment_id&&(o='回复<a href="/share/home?uk='+e.parent_uk+"&suk="+e.parent_pansuk+'" target="_blank" class="talk-to">'+e.parent_name+"</a>"),t=this.domType<=1?['<li class="item clearfix" data-uk="'+e.uk+'" data-parentsuk="'+e.pansuk+'" data-commentid="'+e.comment_id+'" data-uname="'+this.encodeHTML(e.uname)+'">','<div class="img-wrapper fn-fl">','<a href="/share/home?uk='+e.uk+"&suk="+e.pansuk+'" class="link" target="_blank">','<img class="fn-block" src="'+e.avatar_url+'" width="50" height="50" />',"</a>","</div>",'<div class="item-info">','<p class="info-head">','<a href="/share/home?uk='+e.uk+"&suk="+e.pansuk+'" target="_blank" class="talk">'+this.encodeHTML(e.uname)+"</a>",o+"：","</p>",'<p class="body">'+this.encodeHTML(e.content)+"</p>",'<p class="foot clearfix">','<a class="reply fn-fr" href="javascript:void(0);">回复</a>','<span class="time fn-fl">'+e.comment_time+"</span>","</p>","</div>","</li>"]:['<li class="item clearfix" data-uk="'+e.uk+'" data-parentsuk="'+e.pansuk+'" data-commentid="'+e.comment_id+'" data-uname="'+this.encodeHTML(e.uname)+'">','<div class="img-wrapper fn-fl">','<a href="/share/home?uk='+e.uk+"&suk="+e.pansuk+'" class="link" target="_blank">','<img class="fn-block" src="'+e.avatar_url+'" width="24" height="24" />',"</a>","</div>",'<div class="item-info">','<p class="detail">','<span class="info-head">','<a href="/share/home?uk='+e.uk+"&suk="+e.pansuk+'" target="_blank" class="talk">'+this.encodeHTML(e.uname)+"</a>",o+"：","</span>",'<span class="body">'+this.encodeHTML(e.content)+"</span>",'<span class="time">（'+e.comment_time+"）</span>","</p>",'<p class="foot clearfix">','<a class="reply fn-fr" href="javascript:void(0);">回复</a>',"</p>","</div>","</li>"],t.join("")},n.prototype._preModuleDom=function(){var e,t=a(this._getTopDom());if(2===this.config.domType){if(e=a(this._getDialogDom()),e.find(".box-wrapper").append(t),this.$parentDom=e,this.$module=e.find(".module-comment"),this.config.dialog){var o=this.config.dialog;o.hasBorder&&this._setDialogBorder(e),o.left&&this.setArrawLeftPosi(o.left)}}else 3===this.config.domType?(this.$parentDom=e=t,this.$module=t):(this.$parentDom=e=t,this.$module=t);return e},n.prototype._touchDataControll=function(e,t){var o=this;this._ajaxGetModel(function(a){return"object"!=typeof a&&"string"!=typeof a?void t():(o.model=a,void o._callbackAjaxData(a,e))},t)},n.prototype._ajaxGetModel=function(e,t){a.ajax({url:n.API.list,type:"get",data:{source_uk:this.source_uk,source_id:this.source_id,type:this.type,start:this.start,limit:this.limit},dataType:"json",success:function(t){e(t)},error:function(){t()}})},n.prototype._callbackAjaxData=function(t,o,a){var i=this.$errorMessage,s=this,r=function(){s.$vcode&&s.$vcode.data("isShow")&&s._hideVCode()};switch(disk.DEBUG&&console.log("errno ============== "+t.errno),t.errno){case 0:r(),o&&o(t);break;case 1:disk.DEBUG&&console.warn(n.MSG.server),r(),i.text(n.MSG.server);break;case 2:disk.DEBUG&&console.warn(n.MSG.error_param),r(),i.text(n.MSG.error_param);break;case-6:r(),e.async("base:widget/passAPI/passAPI.js",function(e){e.promise.done(function(){e.passAPI.PassportInit.netdiskLogin({reload:!0})})});break;case-9:disk.DEBUG&&console.warn(n.MSG.no_comment),r(),i.text(n.MSG.no_comment);break;case-42:disk.DEBUG&&console.warn(n.MSG.no_share),r(),i.text(n.MSG.no_share);break;case-50:disk.DEBUG&&console.warn(n.MSG.quick),r(),i.text(n.MSG.quick);break;case-51:disk.DEBUG&&console.warn(n.MSG.same),r(),i.text(n.MSG.same);break;case-52:disk.DEBUG&&console.warn(n.MSG.sensitive),r(),i.text(n.MSG.sensitive);break;case 1e3:disk.DEBUG&&console.warn(n.MSG.error_vcode),r(),i.text(n.MSG.error_vcode);break;case-53:s._verifyCodeLoad(),i.text(n.MSG.error_vcode);break;case-54:disk.DEBUG&&console.warn(n.MSG.forbid_user),r(),i.text(n.MSG.forbid_user);break;default:disk.DEBUG&&console.warn("未知错误"),r(),i.text("未知错误")}a&&"function"==typeof a&&a()},n.prototype._initSuccessCallback=function(){this._afterModuleDom(this.model),this._initAfterAppend()},n.prototype._afterModuleDom=function(e){var t=e.comment_list;this.$module.append(this._getBottomDom(e.count)),this.$feed=this.$module.find(".feed"),e.count>0&&this.$feed.html(this._getItemListDom(t)),this._scrollTextarea()},n.prototype._initAfterAppend=function(){this.config&&this.config.dialog&&this.config.dialog.hasScroll&&this._setDialogScroll(),this._bindAll(),this._initPagePlugin(),this._viewCommentAnalyties()},n.prototype._bindVCode=function(){var e=this;this.$module.delegate(".underline, .img-code","click",function(){e._verifyCodeLoad()}),this.$module.delegate(".input-code","focus",function(){a(this).val("")}).delegate(".input-code","blur",function(){a(this).val()&&e.$errorMessage.empty()})},n.prototype._bindAll=function(){this._bindCreateComment(),this._bindReply(),this._bindItemHover(),this._bindItemDelete(),this._bindVCode()},n.prototype._initPagePlugin=function(){var e=this;e._pageCallback(function(){e._touchDataControll(function(){e._pageItemListSuccessCallback()})})},n.prototype._pageCallback=function(e){var t=this,o=!0,a=!0;this.domType>1&&(a=!1);var i=s.ui.page({allNu:t.model.count,everyPageNu:t.limit,pageType:o,pageBorder:a,pageContainer:t.$module.find(".page")});t.onAfterPageComponents(),t.pageObtain=i,i.onActive=function(o){t.currentPageNum=o,t.start=(o-1)*t.limit,e()},this.config&&"function"==typeof this.config.onLoadedCallBack&&this.config.onLoadedCallBack(this.model.count)},n.prototype._pageItemListSuccessCallback=function(){this.$feed.html(this._getItemListDom(this.model.comment_list)),this._updateCount(),this.pageObtain.chageAllNu(this.model.count),this.config&&"function"==typeof this.config.onrefreshPage&&this.config.onrefreshPage(this.model.count)},n.prototype._bindItemHover=function(){var e=this,t='<span class="delete-wrapper fn-fr"><a href="javascript:void(0);" class="delete">删除</a><span class="break">|</span></span>',o=function(){a(this).find(".foot").append(t)},i=function(){a(this).find(".delete-wrapper").remove()};this.$module.delegate(".item","mouseenter",function(){a(this).attr("data-uk")==e.current_uk&&o.call(this)}),this.$module.delegate(".item","mouseleave",function(){a(this).attr("data-uk")==e.current_uk&&i.call(this)})},n.prototype._bindItemDelete=function(){var e,t,o=this;window.fuck=o,this.$module.delegate(".delete","click",function(){e=a(this).closest(".item"),t=e.siblings(".item").length,o._ajaxDeleteComment(e.attr("data-commentid"),function(){o._updateCount("minus"),e.slideUp("slow",function(){e.remove(),console.log(window.fuck.getTotalCount.toString()),o.getTotalCount(o.model.count),0>=t&&o.startInit(o.$container,o.config)})})})},n.prototype._bindReply=function(){var e,t=this,o=this.$module,s=this.$container.find(".area");this.$module.delegate(".reply","click",function(){var n,r=a(this).closest(".item");t.$errorMessage.empty(),t.parent_uk=r.attr("data-uk"),t.parent_pansuk=r.attr("data-parentsuk"),t.parent_name=r.attr("data-uname"),t.parent_id=r.attr("data-commentid"),t.replyStr="回复"+t.parent_name+"：",s.val(t.replyStr),i.selectTextField(s[0],s.val().length,s.val().length),3===t.domType&&t.$module.offset().top-136<0&&(n=a("#main-content"),n.animate({scrollTop:n.scrollTop()+t.$module.offset().top-136},300)),2===t.domType&&(e=t.$parentDom.offset().top-32,n=a(a.browser.webkit?"html>body":"html"),n.scrollTop()>e&&n.animate({scrollTop:e},300)),1===t.domType&&(e=o.offset().top,n=a(a.browser.webkit?"html>body":"html"),n.scrollTop()>e&&n.animate({scrollTop:e},300))})},n.prototype._bindTextareaFocus=function(){var t=this,o=this.$module.find(".area"),i=this.$module.find(".placeholder");this.$module.delegate(".area","focus",function(){i.removeClass("fn-block").addClass("fn-hide"),t.$vcode.data("isShow")===!0||("0"===t.login_status||0===t.login_status?(e.async("base:widget/passAPI/passAPI.js",function(e){e.promise.done(function(){e.passAPI.PassportInit.netdiskLogin({reload:!0})})}),2===this.domType?a(document).focus():a(this).blur()):(t._verifyCodeLoad(),t.$container.find(".area").focus()))}),this.$module.delegate(".placeholder","click",function(){o.focus()}).delegate(".area","blur",function(){o.val().trim()||(o.val(""),i.removeClass("fn-hide").addClass("fn-block"))})},n.prototype._bindCreateComment=function(){var e,t=this,o=this.$container.find(".area"),i=(t.formatDate,function(){t.parent_id&&delete t.parent_id,t.parent_uk&&delete t.parent_id,t.parent_name&&delete t.parent_id,t.replyStr&&delete t.replyStr});this.$module.delegate(".btn-comment","click",function(){s.log.send({name:"module-comment-analyties",value:"detail-create"});var r,l,d=a(this),c=(a(this).closest(".item"),{}),m={send_from_pan:1,source_uk:t.source_uk,source_id:t.source_id,type:t.type};if(yunData.MYBDSTOKEN&&(m.bdstoken=yunData.MYBDSTOKEN),e=o.val().trim(),0===e.indexOf(t.replyStr)?(e=e.substring(t.replyStr.length),c={parent_comment_id:t.parent_id,parent_uk:t.parent_uk,parent_pansuk:t.parent_pansuk,parent_name:t.parent_name},m.parent_id=t.parent_id,r=!0):r=!1,0===e.length)return t.$errorMessage.text(n.MSG.empty),void t._hideVCode();if(e.length>300)return t.$errorMessage.text(n.MSG.limit),void t._hideVCode();if(t.$vcode.data("isShow")===!0){if(l=t.$inputVCode.val().trim(),""===l)return void t.$errorMessage.text(n.MSG.empty_vcode);if(4!==l.length)return void t.$errorMessage.text(n.MSG.error_vcode);m.input=l,m.vcode=t.vcode_str}t.$errorMessage.empty(),m.content=e;var u={uk:t.current_uk,avatar_url:t.avatar_url,uname:t.uname,pansuk:t.pansuk,comment_time:(new Date).getTime()},p=a.extend({},m,u,c);d.data("doing")||t._ajaxCreateComment(m,function(){d.data("doing",!0),d.text("提交中..."),d.css("color","#FBB5B5")},function(){"object"==typeof arguments[0]&&(p.comment_id=arguments[0].comment_id),t._addCommentDom(p),t.$module.find(".list").hasClass("fn-hide")===!0&&t.$module.find(".list").removeClass("fn-hide"),t.getTotalCount(t.model.count),o.val("").focus(),i()},void 0,function(){d.data("doing")&&d.removeData("doing"),d.text("评论"),d.css("color","#FFF"),t._createCommentAnalyties(t.domType,r)})}),this.$module.delegate(".area, .input-code","keyup",function(e){13===e.keyCode&&e.ctrlKey&&t.$module.find(".btn-comment").trigger("click")})},n.prototype._sendAnalyties=function(e){s.log.send({name:"module-comment-analyties",value:e})},n.prototype._viewCommentAnalyties=function(){3===this.domType&&this.$module.closest(".feed-dynamic-comment").hasClass("hide")===!1&&this._sendAnalyties("feed-list"),2===this.domType&&this._sendAnalyties("multifile-list"),1===this.domType&&this._sendAnalyties("detail-list")},n.prototype._createCommentAnalyties=function(e,t){switch(e){case 1:this._sendAnalyties(t?"detail-reply":"detail-create");break;case 2:this._sendAnalyties(t?"multifile-reply":"multifile-create");break;case 3:this._sendAnalyties(t?"feed-reply":"feed-create");break;default:disk.DEBUG&&console.log("_createCommentAnalyties params is wrong!")}},n.prototype._ajaxCreateComment=function(e,t,o,i,s){var r=this;a.ajax({url:n.API.create,type:"POST",data:e,dataType:"json",beforeSend:t,success:function(e){r._callbackAjaxData(e,o,i)},complete:function(){s&&"function"==typeof s&&s()}})},n.prototype._addCommentDom=function(e){var t=this;this.$feed.find(".empty-msg").remove();var o=a(this._getItemDom(e));2===this.domType&&this.$feed.scrollTop()>0?this.$feed.animate({scrollTop:0},300,function(){t.$feed.prepend(o.hide()),o.fadeIn("slow")}):(this.$feed.prepend(o.hide()),o.fadeIn("slow")),2===this.domType&&this.ie6&&this._setHeightOfIe6(),this._updateCount("plus")},n.prototype._getDialogDom=function(){var e=['<div class="module-comment-box">','<em class="arraw"></em>','<div class="box-wrapper"></div>',"</div>"];return e.join("")},n.prototype._setDialogBorder=function(e){e.find(".box-wrapper").css("border","1px #C2C2C2 solid")},n.prototype._setHeightOfIe6=function(){this.$feed.height()>270&&this.$feed.css({height:"270px",overflowY:"auto"})},n.prototype._setDialogScroll=function(){this.ie6?this._setHeightOfIe6():this.$feed.css({maxHeight:"270px",overflowY:"auto"})},n.prototype._ajaxDeleteComment=function(e,t){var o={source_uk:this.source_uk,source_id:this.source_id,type:this.type,comment_id:e};yunData.MYBDSTOKEN&&(o.bdstoken=yunData.MYBDSTOKEN),a.ajax({url:n.API.remove,type:"get",data:o,dataType:"json",success:function(e){0===e.errno&&t(),60===e.errno&&disk.DEBUG&&console.log("errno:60，评论不存在——commentId: commentId")}})},n.prototype._updateCount=function(e){var t;"plus"===e?(t=this.model.count+1,this.model.count=t):"minus"===e?this.model.count>=1&&(t=this.model.count-1,this.model.count=t):t=this.model.count,this.$module.find(".total span").text(t),this.onUpdateCount(this.model.count,this.currentPageNum)},n.prototype._scrollTextarea=function(){if(3===this.domType&&this.$module.closest(".feed-dynamic-comment").hasClass("hide")===!1){var e=a("#main-content"),t=Math.round(a("html>body").height()/2),o=this.$module.offset().top;o-t>0&&e.animate({scrollTop:e.scrollTop()+(o-t)},500)}},n.prototype._formatDate=function(e){9999999999>e&&(e=1e3*e);var t=new Date,o=t.getTime(),a=new Date;a.setTime(e);var i=o-e;if(t.getDate()===a.getDate()){var s=a.getHours();s=10>s?"0"+s:s;var n=a.getMinutes();return n=10>n?"0"+n:n,s+":"+n}if(864e5>i){var s=a.getHours();s=10>s?"0"+s:s;var n=a.getMinutes();return n=10>n?"0"+n:n,"昨天 "+s+":"+n}if(1728e5>i){var s=a.getHours();s=10>s?"0"+s:s;var n=a.getMinutes();return n=10>n?"0"+n:n,"前天 "+s+":"+n}if(314496e5>i){var r=a.getMonth()+1;r=10>r?"0"+r:r;var l=a.getDate();l=10>l?"0"+l:l;var s=a.getHours();s=10>s?"0"+s:s;var n=a.getMinutes();return n=10>n?"0"+n:n,this.lastTime=e,r+"-"+l+" "+s+":"+n}var d=a.getFullYear().toString(),r=a.getMonth()+1;r=10>r?"0"+r:r;var l=a.getDate();return l=10>l?"0"+l:l,this.lastTime=e,d+"-"+r+"-"+l},n.prototype._showErrorMessage=function(e,t){e.html("<div class='empty-msg' style='padding:20px 0 30px 0;text-align:center;font-size:12px;'>"+t+"</div>")},n.prototype.encodeHTML=function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")},o.exports=n});
;define("disk-share:widget/pageModule/data-center/data-center.js",function(e,t,n){var a=(e("base:widget/libs/jquerypacket.js"),{api:{quota:"/api/quota",appVersion:"/disk/cmsdata?do=client&channel=chunlei&clienttype=0&web=1"}}),i={};n.exports={set:function(e,t){var n,a=e.split(":"),o=i;for(n=0;n<a.length;n++)"undefined"==typeof o[a[n]]&&(o[a[n]]={}),n===a.length-1?o[a[n]]=t:o=o[a[n]];return t},get:function(e){var t,n=e.split(":"),a=i;for(t=0;t<n.length&&(a=a[n[t]],"undefined"!=typeof a);t++);return a},getQuotaAsync:function(e,t){var n=this;mdev.ajax({url:a.api.quota,data:e,success:function(e){n.set("quota",e),t.call(void 0,e)}})},getAppVersionAsync:function(e){var t=this,n=t.get("appVersion"),i=function(n){0==n.errorno&&(t.set("appVersion",n),e.call(void 0,n))};return n?void e.call(void 0,n):void mdev.ajax({url:a.api.appVersion,success:function(e){i(e)},error:function(e){i(e)}})}}});
;define("disk-share:widget/pageModule/error/error.js",function(t){var e=t("base:widget/libs/jquerypacket.js"),n=t("system-core:context/context.js").instanceForSystem,a=window.yunData||{},o={api:{cmsData:"/disk/cmsdata?clienttype=0&web=1"},main:function(){1==a.LOGINSTATUS&&e.get("/api/account/uinfo?t="+(new Date).getTime(),function(t){0==t.type&&(e(".repair_share_aside")[0].innerHTML="<dl style='height: 50px;line-height: 50px;text-align: center;font-size: 16px;font-weight: bolder;color: #666666;'>领取空间</dl><dl style='margin-bottom: 20px;padding: 0 15px;'><div>发福利啦！你已是百度用户，点击可领取百度网盘<em style='color: black;font-size: 12px;font-style: normal;'>5G永久免费容量。<em></div></dl><dl><a hideFocus='true' target='_blank' href='//pan.baidu.com/disk/home#from=share_notfound' class='activate-btn third-qq'><b>立即领取</b></a></dl>")},"json")},downloadURL:function(){e.get(o.api.cmsData+"&do=client&t="+(new Date).getTime(),function(t){null!=t&&0==t.errorno&&(e(".side-lwindows1").attr("href","http://issuecdn.baidupcs.com/issue/netdisk/apk/BaiduYunGuanjia_"+t.guanjia.version.match(/V(.+$)/)[1]+".exe"),e(".side-landroid1").attr("href","http://issuecdn.baidupcs.com/issue/netdisk/apk/BaiduYun_"+t.android.version.match(/V(.+$)/)[1]+".apk"))},"json")},adPlatform:{data:{},api:{systemApi:"/feproxy/ad/list"},tmpl:{alljs:function(t){return[t.content].join("")},cancellBanner:function(t){return t&&"object"==typeof t?['<a target="_blank" href="'+t.action+'" title="'+t.title+'"',' style="height:90px;display:block;position:absolute;width:100%;">',"<img src="+t.content+'" class="share-center" />',"</a>"].join(""):void 0},wangmeng:['var cpro_id="u2493161";','(window["cproStyleApi"]=window["cproStyleApi"]||{})','[cpro_id]={at:"3",rsi0:"750",rsi1:"250",pat:"6",tn:"baiduCustNativeAD",','rss1:"#FFFFFF",conBW:"1",adp:"1",ptt:"0",titFF:"%E5%BE%AE%E8%BD%AF%E9%9B%85%E9%BB%91",titFS:"14",','rss2:"#000000",titSU:"0",ptbg:"90",piw:"0",pih:"0",ptp:"0"};',"(window.cproArray=window.cproArray||[]).push({",'id: "u2493161"',"});"].join("")},sendLog:function(t,e){var n=(new Date).getTime()+"cancelleddoc";window[n]=new Image;var a=window[n],o=750,i=90,d="&h="+o+"&w="+i+"&p="+(t||"web-cancelleddoc")+"&s="+encodeURIComponent(e),r="http://pcs.baidu.com/rest/2.0/pcs/adx?m=callback"+d;a.onload=a.onerror=function(){window[n]=null},a.src=r,a=null},getWangMeng:function(t){var n=document.createElement("script"),a=document.createElement("script"),i={"web-cancelleddoc":{shareIdStr:"cpro_u2493161",shareTpl:"wangmeng"}},d=document.getElementById(i[t].shareIdStr||"cpro_u2493161");return n.innerHTML=o.adPlatform.tmpl[i[t].shareTpl||"wangmeng"],n.type=a.type="text/javascript",a.src="http://cpro.baidustatic.com/cpro/ui/c.js","undefined"==typeof d||null===d?!1:(d.appendChild(n),d.appendChild(a),n=null,a=null,void e("#BAIDU_UNION__wrapper_u2493161_0").hide())},sendCallback:function(t){for(var e in t.data)o.adPlatform.checkAd(t.data[e])?"web-cancelleddoc"===e&&o.adPlatform.getWangMeng(e):o.adPlatform.dealSingleAd(e)},checkAd:function(t){return t&&t.error_code},base64decode:function(t){var e,n,a,o,i,d,r,l=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1];for(d=t.length,i=0,r="";d>i;){do e=l[255&t.charCodeAt(i++)];while(d>i&&-1===e);if(-1===e)break;do n=l[255&t.charCodeAt(i++)];while(d>i&&-1===n);if(-1===n)break;r+=String.fromCharCode(e<<2|(48&n)>>4);do{if(a=255&t.charCodeAt(i++),61===a)return r;a=l[a]}while(d>i&&-1===a);if(-1===a)break;r+=String.fromCharCode((15&n)<<4|(60&a)>>2);do{if(o=255&t.charCodeAt(i++),61===o)return r;o=l[o]}while(d>i&&-1===o);if(-1===o)break;r+=String.fromCharCode((3&a)<<6|o)}return r},dealSingleAd:function(t){var n=o.adPlatform.data[t],a=e('.platform-tips[node-id~="'+t+'"]');if(n&&n.list&&n.list[0]&&"js"===n.list[0].type)if("baichuan"===n.list[0].uid){var i=o.adPlatform.base64decode(n.list[0].content);a.html(i)}else{var d=document.createElement("div"),r=document.createElement("script"),l=document.createElement("script"),c={"web-cancelleddoc":{shareId:"platform-non-found",uid:"cpro_u2493161",shareTpl:"wangmeng"}};d.id=c[t].uid||"cpro_u2493161",d.style="border-bottom: 1px solid #E7E7E7;padding: 10px 0; margin: 0 10px;overflow: hidden;";var s=document.getElementById(c[t].shareId||"platform-non-found");s.appendChild(d),r.innerHTML=o.adPlatform.tmpl.alljs({content:o.adPlatform.base64decode(n.list[0].content)}),r.type=l.type="text/javascript",l.src=window.location.protocol+"//cpro.baidustatic.com/cpro/ui/c.js",d.appendChild(r),d.appendChild(l),r=null,l=null}else t&&"web-cancelleddoc"===t&&n&&n.list&&a.html(o.adPlatform.tmpl.cancellBanner({action:n.list[0].action.action,title:n.list[0].action.param.title,url:n.list[0].content}));o.adPlatform.sendShowLog(t),o.adPlatform.eventInit(t)},eventInit:function(t){var n=e('.platform-tips[node-id~="'+t+'"]');n.on("click",function(){o.adPlatform.sendClickLog(t)})},sendShowLog:function(t){var e=o.adPlatform.data[t];o.adPlatform.sendLog(t,e&&e.vsign),n.log.send({name:"web_not_found_web_ad_show",value:"外链notfound页面广告显示"})},sendClickLog:function(t){o.adPlatform.sendLog(t,o.adPlatform.data[t].csign),n.log.send({name:"web_not_found_web_ad_click",value:"外链notfound页面广告点击"})},errorCallback:function(){o.adPlatform.getWangMeng()},getAjax:function(t,n){var i={list:[{id:"web-cancelleddoc",w:750,h:90}],uk:a?a.MYUK:""};e.ajax({type:"GET",url:o.adPlatform.api.systemApi,dataType:"json",data:i,success:function(e){e?(o.adPlatform.data=e.data,t&&"function"==typeof t&&t(e)):n&&"function"==typeof n&&n()},error:function(){n&&"function"==typeof n&&n()}})},init:function(){o.adPlatform.getAjax(o.adPlatform.sendCallback,o.adPlatform.errorCallback)}}};!function(){o.adPlatform.init(),o.downloadURL(),o.main()}()});
;define("disk-share:widget/pageModule/footer/footer.js",function(e,i,o){var r=e("base:widget/libs/jquerypacket.js"),t={resizeHandler:function(){var e=0||r("header").height(),i=r("#footer").offset(),o=r(window).height();r("#footer").height(o-i.top-e)}},n={resize:function(e){e&&(t.resizeHandler(),window.onresize=t.resizeHandler)}};o.exports=n});
;define("disk-share:widget/pageModule/hot-book/hot-book.js",function(e){function t(e){var t,o=r.length>3?3:r.length,n=r;for(t=0;o>t;t++)a.append(mdev.tmpl(l.tpl.item,n[t]));e&&(a.height(a.height()),a.show())}function o(e){n.get(l.url.hotbook,{novelid:e.data.novelid},function(o){try{var i=n.parseJSON(o);i&&i.list&&0!==i.list.length?(r=i.list,t(!0),e.success&&e.success()):e.error&&e.error()}catch(s){e.error&&e.error()}}).error(function(){e.error&&e.error()})}var r,n=e("base:widget/libs/jquerypacket.js"),i=e("system-core:context/context.js").instanceForSystem.message,s={module:"dl.module-hot-book"},l={url:{hotbook:"/share/novelrec"},tpl:{item:'<dd class="book_item"><p><a target="_blank" title="<%=name%>" href="<%=url%>"><img src="<%=img%>"/></a></p><p><a target="_blank" title="<%=name%>" href="<%=url%>"><%=name%></a></p><p><%=type%></p></dd>'}},a=n(s.module);i.listen("hot-book",function(e,t){"init"===e&&o(t)})});
;define("disk-share:widget/pageModule/hot-rec/hot-rec.js",function(e,t,n){function s(e){var t=/\.([^\.]+)$/.exec(e),n=t?x[t[1]]?t[1]:"default":"dir";return x[n]}function r(e){var t,n,r=[];for(t=0;t<e.length;t++)n={},n.fileTypeClass=s(e[t].fn),n.fn=e[t].fn,n.link=k.url.sharelink+"?shareid="+e[t].sid+"&uk="+e[t].uk,e[t].fid&&(n.link+="&fid="+e[t].fid),n.link+="&from=hotrec",r.push(n);return r}function i(e){var t=/\.([^\.]+)$/.exec(e),n=t&&t[0]?t[0]:"";return n}function o(e,t,n){var s,r=[];for(s=0;n>s;s++)r.push(e[t]),++t>=e.length&&(t-=e.length);return{index:t,list:r}}function a(e){var t,n=o(u,w,y.ddLength||3),s=n.list,r=b.find("dd");for(t=0;t<s.length;t++){var i=h.template(k.tpl.item)(s[t]);b.append(i)}w=n.index,f.browser.webkit?r.animate({height:"0px",opacity:"0"},300,function(){r.remove()}):r.remove(),e&&(b.height(window.XMLHttpRequest?b.height():b.height()+31),b.show())}function c(){b.delegate(".hot_item","click",function(){g.log.send({name:"hotrecClick",value:encodeURIComponent(f(this).attr("href"))})}),b.delegate(v.changeButton,"click",function(){g.log.send({name:"hotrecChange"})})}function l(){j.click(function(){a()}),c()}function d(e){var t=function(e){var t=f('.module-aside > dl[node-type="module"]');e?"block"===t.css("display")&&t.css("display","none"):"none"===t.css("display")&&t.css("display","block")};f.get(k.url.recommend,function(n){try{n&&n.list&&0!==n.list.length?(u=r(n.list),t(!1),a(!0),e.success&&e.success()):(t(!0),e.error&&e.error())}catch(s){t(!0),e.error&&e.error()}}).error(function(){t(!0),e.error&&e.error()})}var u,f=e("base:widget/libs/jquerypacket.js"),h=e("base:widget/libs/underscore.js"),g=e("system-core:context/context.js").instanceForSystem,m=g.message,p=window.yunData||{},v={module:"dl.module-hot-rec",changeButton:'a[node-type~="hot_rec_change"]'},k={url:{recommend:"/share/hotrec",sharelink:"/share/link"},tpl:{item:'<dd><a target="_blank" class="hot_item <%=fileTypeClass%>" href="<%=link%>" title="<%=fn%>"><%=fn%></a></dd>'}},y={ddLength:0},x={jpg:"s0",jpeg:"s0",gif:"s0",png:"s0",ppt:"s2",pptx:"s2",pdf:"s3",doc:"s4",docx:"s4",xls:"s5",xlsx:"s5",txt:"s6",mp3:"s7",wav:"s7",mp4:"s8",rmvb:"s8",avi:"s8",m3u8:"s8",flv:"s8",wmv:"s8",zip:"s11",rar:"s11",apk:"s12",torrent:"s14",dir:"s13","default":"s13"},w=0,b=f(v.module),j=b.find(v.changeButton);m.listen("hot-rec",function(e,t){if("init"===e){var n="";"undefined"==typeof p.FILEINFO||null===p.FILEINFO||(n=p.FILEINFO[0].server_filename);var s=i(t.data.filename||n);k.url.recommend+="?t="+(new Date).getTime()+(s?"&fn="+s:""),d(t),l()}});var F=function(e){"number"==typeof e.size&&(y.ddLength=e.size),g.message.trigger("hot-rec","init",{data:e})};n.exports={init:F}});
;define("disk-share:widget/pageModule/hot-user/hot-user.js",function(e){function t(e,t,r){var o,s=[];for(o=0;r>o;o++)s.push(e[t]),++t>=e.length&&(t-=e.length);return{index:t,list:s}}function r(e){var r,o=t(i,d,2),s=o.list;for(g.find("dd").remove(),r=0;r<s.length;r++)g.append(mdev.tmpl(l.tpl.item,s[r]));d=o.index,e&&(g.height(g.height()),g.show())}function o(e){a.get(l.url.hotuser,{start:0,limit:20},function(t){try{var o=a.parseJSON(t);o&&o.hotuser_list&&0!==o.hotuser_list.length?(i=o.hotuser_list,r(!0),e.success&&e.success()):e.error&&e.error()}catch(s){e.error&&e.error()}}).error(function(){e.error&&e.error()})}function s(){g.delegate(c.hotUserList,"click",function(){h.log.send({name:"hotpersonrec_click"})}),g.delegate(c.changeButton,"click",function(){h.log.send({name:"hotpersonrec_change"})})}function n(){_.click(function(){r()}),s()}var i,a=e("base:widget/libs/jquerypacket.js"),h=e("system-core:context/context.js").instanceForSystem,u=h.message,c={module:"dl.module-hot-user",changeButton:'a[node-type~="hot_user_change"]',hotUserList:'dd[node-type~="hot_user_list"]'},l={url:{hotuser:"/pcloud/friend/gethotuserlist"},tpl:{item:'<dd node-type="hot_user_list"><a target="_blank" href="/share/home?view=share&uk=<%=hot_uk%>"><img class="peo_item_l" src="<%=avatar_url%>"/></a><div class="peo_item_r"><a class="peo_name" target="_blank" href="/share/home?view=share&uk=<%=hot_uk%>"><%=hot_uname%></a><a class="peo_share" target="_blank" href="/share/home?view=share&uk=<%=hot_uk%>"><strong><%=pubshare_count%></strong>分享</a></div></dd>'}},d=0,g=a(c.module),_=g.find(c.changeButton);u.listen("hot-user",function(e,t){"init"===e&&(o(t),n())})});
;define("disk-share:widget/pageModule/init/init.js",function(e){function t(){c.init()}var o=e("base:widget/libs/jquerypacket.js"),i=e("base:widget/tools/tools.js"),n=e("system-core:context/context.js").instanceForSystem,r=n.ui.button,s=window.yunData,c={getParam:function(e,t){var o=new RegExp("(?:^|\\?|#|&)"+e+"=([^&#]*)(?:$|&|#)","i"),i=o.exec(t||location.href);return i?i[1]:""},api:{verify:"/share/verify"},requestToken:function(){var e=o("#rrdf6L46").val(),t=o("#zzJVkD").val(),n=o(".pickcode img:first").attr("verify"),r=s.vcodeStr?s.vcodeStr:"",a=function(){o.post(c.api.verify+location.search+"&t="+(new Date).getTime(),{pwd:e,vcode:t,vcode_str:r},function(e){var t=null;try{t=o.parseJSON(e)}catch(n){}if(null!=t&&-62==t.errno)o(".ac-close").addClass("ac-open").removeClass("ac-close"),o("#gcpf6KbJ").css("display","block").text("验证码错误"),c.verifyCodeLoad();else if(null==t||-19!=t.errno&&-63!=t.errno)if(null!=t&&-9==t.errno)o("#gcpf6KbJ").css("display","block").text("密码错误");else if(null==t||0!==t.errno)o("#gcpf6KbJ").css("display","block").text("密码错误");else{var r=i.getParam("surl",location.href);location.assign(r?"/s/1"+r:"/share/link"+location.search)}else o(".ac-close").addClass("ac-open").removeClass("ac-close"),o("#gcpf6KbJ").css("display","block").text("验证码错误"),c.verifyCodeLoad()})};return 0==e.length?(o("#gcpf6KbJ").text("请输入提取密码再提交").show(),!1):"verify"===n&&0===t.length?(o("#gcpf6KbJ").text("请输入验证码").show(),!1):(o("#gcpf6KbJ").css("display","none"),a(),void(e=e.toLowerCase()))},verifyCodeLoad:function(){var e=o(".pickcode img:first");e.attr({alt:"验证码获取中"}),o.get("/api/getcaptcha?prod=shareverify&web=1&t="+Math.random(),function(t){0===t.errno?(e.attr("src",t.vcode_img).attr("verify","verify"),s.vcodeStr=t.vcode_str):e.attr("alt","验证码获取失败").attr("verify","verify")},"json")},bindEvent:function(){document.accessForm.onsubmit=document.getElementById("wr6YxJ").onclick=function(){return c.requestToken(),!1},o("input").keyup(function(e){return 13==e.keyCode?(c.requestToken(),!1):void 0}),o(".change-code").click(function(){c.verifyCodeLoad()}),o("#rrdf6L46").focus()},init:function(){var e={type:"big",color:"blue",title:"提取文件",resize:!0};new r(e).appendTo(o("#wr6YxJ")),c.bindEvent()}};t(1)});
;define("disk-share:widget/pageModule/init/init.tpl.js",function(e,s,a){var i={verify:['<p class="share-verify-desc">请输入验证码</p>','<input type="text" maxlength="4" class="share-access-code share-verify-code" node-type="pzba697w">','<img src="" alt="" class="share-verify-image" node-type="leqq6Xv2">','<a href="javascript:;" node-type="ed6Kyb">换一个</a>','<p class="share-access-tip" node-type="iukJqd2"></p>'].join("")};a.exports=i});
;define("disk-share:widget/pageModule/list/grid-view/grid-view-builder.js",function(e,t,i){function a(e){f.gridViewContainer||(f.gridViewContainer=e.$gridViewContainer.find(".BNfIyPb")),f.itemHeight||(f.itemHeight=e.getCurrentView().itemHeight);var t=0;if(f.itemHeight>0){var i=f.gridViewContainer.scrollTop();t=Math.max(parseInt(i/f.itemHeight,10)-2,0)}f.load(t)}var s=e("base:widget/libs/jquerypacket.js"),n=e("disk-share:widget/system/fileOperate/fileOperate.js"),r=e("base:widget/historyManager/historyManager.js"),l=e("disk-share:widget/system/util/lazyLoadImage.js"),o=e("system-core:context/context.js").instanceForSystem,c=o.message,d=e("base:widget/libs/underscore.js"),h={LIST:"list",CATEGORY:"category",SEARCHPATH:"searchPath",SEARCHGLOBAL:"searchGlobal",SEARCH:"search"},m=function(){var e=document.createElement("dd");e.className="g-clearfix";var t=[];t.push('<div class="cEefyz">'),t.push('<span node-type="EOGexf" class="EOGexf"></span>'),t.push('<div class="JS-fileicon" title="">'),t.push('<img class="thumb"/>'),t.push('<span class="playIcon"></span>'),t.push("</div>"),t.push('<div class="file-name">'),t.push('<a node-type="sdnzBbvZ" class="filename" href="javascript:void(0);" title=""></a>'),t.push("</div>"),t.push("</div>");for(var i=[],a=f.columnsCount=this.getColumnsCount(),s=0;a>s;s++)i.push(t.join(""));return e.innerHTML=i.join(""),e},u=null,g=null,p=function(){u=null,g=null},v=function(e,t,i){var a,l,d=t;null==d&&(d=this.buildView(e,t,i));for(var m,p=this.getGroupElementsData(),v=p[i],C=s(d),b=this,y=this.getColumnsCount(),I=C.find(".cEefyz"),k=0;k<v.length;k++){if(m=v[k],a=I[k],l=s(a),a.style.display="block",a.setAttribute("_position",i),this.isAllItemChecked()||this.isItemChecked(i*y+k)?l.addClass("JS-item-active"):l.removeClass("JS-item-active hover-item"),!a.getAttribute("_installed")){var w,S;l.mouseover(function(){if(w=(new Date).getTime(),b.parent.isLocked())return!1;var e=s(this);return e.addClass("hover-item"),!1}).mouseout(function(){if(b.parent.isLocked())return!1;var e=s(this);return e.removeClass("hover-item"),S=(new Date).getTime(),o.log.send({name:"gridListHover",value:S-w}),!1}),l.bind("click dblclick",function(e){var t=(new Date).getTime();if(b.parent.isLocked())return!1;var i,a=s(this),n=parseInt(a.attr("_position"),10),l=a.index(),d=n*y+l,m=b.getElementsData()[d],p=b.isItemChecked(d),v=!1;if(e.shiftKey){var f=b.getCheckedIndexs(),C=f[0];0===C||C||(C=d),b.setItemsChecked(!1);var I=C,k=d;if(k>I)for(;k>=I;)b.setItemChecked(I,!0),I++;else if(I>k)for(I=f[f.length-1];I>=k;)b.setItemChecked(I,!0),I--;else b.setItemChecked(I,!0);b.requestLayout()}else{if(!e.ctrlKey){if(m.isdir)return b.setItemsChecked(!1),filename=m.server_filename,"string"==typeof m.path&&0===m.path.indexOf("/")&&(m.path=m.path.substr(1,m.path.length)),b.parent.cache.cacheName===h.SEARCH||b.parent.cache.cacheName===h.SEARCHGLOBAL||b.parent.cache.cacheName===h.SEARCHPATH?r.assignUrlHash("list/path="+encodeURIComponent(m.path)+"&vmode="+r.getCurrentParams().vmode):m.parent_path?b.parent.addHistory(m.path,m.server_filename,decodeURIComponent(m.parent_path)):b.parent.addHistory(m.server_filename,m.server_filename),!1;var w=a.data("plugin");if(w&&w.length)return c.trigger("plugin:"+w,{filesList:[m]}),!1;i=b.getCheckedIndexs(),i.length>0&&(p===!1||p&&i.length>1)&&(b.setItemsChecked(!1),v=!0),p&&i.length>1&&(p=!1)}u=d,g=null,b.setItemChecked(d,!p),v?b.requestLayout():p?a.removeClass("JS-item-active"):a.addClass("JS-item-active")}var S=(new Date).getTime();return o.log.send({name:"gridListSingleSel",value:S-t}),!1}).delegate(".EOGexf","click",function(e){var t=(new Date).getTime();if(b.parent.isLocked())return!1;e.stopPropagation();var i=s(this).closest(".cEefyz"),a=parseInt(i.attr("_position"),10),n=i.index(),r=a*y+n,l=b.isItemChecked(r);b.setItemChecked(r,!l),l?i.removeClass("JS-item-active"):i.addClass("JS-item-active");var c=(new Date).getTime();o.log.send({name:"gridListMultiSel",value:c-t})}).delegate(".EOGexf","dblclick",function(e){e.stopPropagation()}),a.setAttribute("_installed",1)}var L=n.getInfo(m.path,m.isdir);l.find(".playIcon").remove(),"fileicon-large-video"===L.largeIcon&&(l.find(".JS-fileicon").append('<span class="playIcon"></span>'),l.mouseenter(function(){s(this).find(".playIcon").show()}).mouseleave(function(){s(this).find(".playIcon").hide()})),l.find(".JS-fileicon").attr('class', 'JS-fileicon '+L.largeIcon),m.isdir||L.plugin?(l.addClass("open-enable"),l.data("plugin",L.plugin)):(l.removeClass("open-enable"),l.data("plugin",""));var A,_,H=l.find(".JS-fileicon img");H.removeAttr("src"),4!==m.category&&m.thumbs&&m.thumbs.url1?(_=m.thumbs.url1.replace("size=c140_u90","size=c180_u194"),(A=f.loadedImgMap[_])?(H.removeAttr("_src").attr("src",A.src).css({left:A.left,top:A.top,visibility:"visible"}),H.parent().attr('class', 'JS-fileicon')):H.removeAttr("src").attr("_src",_).css("visibility","hidden")):H.removeAttr("_src").removeAttr("src").css("visibility","hidden"),l.find(".filename").html(L.name).attr("title",L.fileName).data("filename",m.server_name)}if(v.length!=y)for(var J=v.length;y>J;++J)I[J].style.display="none";return d},f={columnsCount:0,gridViewContainer:null,itemHeight:0,lazyLoadImagePlugin:new l,loadedImgMap:{},init:function(){this.lazyLoadImagePlugin.on("done",d.bind(this.imgLoadedSuccessFunc,this)),this.lazyLoadImagePlugin.on("fail",d.bind(this.imgLoadedFailFunc,this))},imgLoadedSuccessFunc:function(e,t){e=s(e);var i,a=0,n=0,r=e.width(),l=e.height();r>0&&l>0&&(a=(90-r)/2,n=(92-l)/2),i={left:a,top:n,visibility:"visible"},e.css(i).removeAttr("_src");var c=e.attr("src");if(!c)return!1;var d=c.replace(/http:\/\/d[0-9]\./,"http://d.");i.src=c,this.loadedImgMap[d]=i,e.parent().attr('class', 'JS-fileicon'),o.log.send({name:"s_imgLoad",value:t})},imgLoadedFailFunc:function(e){e=s(e),e.removeAttr("src"),e.removeAttr("_src")},checkCanLoad:function(e){for(var t=0,i=f.gridViewContainer,a=i.scrollTop(),s=i.height();e&&-1===e.className.indexOf("cEefyz");)e=e.parentNode,t+=e.offsetTop;return a-100>t?-1:t>a+s?0:1},load:function(e){for(var t=f.gridViewContainer,i=e?t.find("dd:gt("+e+")").find(".thumb[_src]"):t.find(".thumb[_src]"),a=[],s=0,n=i.length;n>s;s++){var r=i[s];if(!r)break;var l=this.checkCanLoad(r);if(0===l)break;-1!==l?1===l&&([].push.apply(a,[].slice.call(i,s,s+this.columnsCount)),s=s+this.columnsCount-1):s=s+this.columnsCount-1}this.lazyLoadImagePlugin.changeImages(a)}};f.init();var C=-1,b=0,y=1e3,I=/vmode=grid/.test(location.hash);i.exports={getView:v,buildView:m,onScroll:d.debounce(function(){if(I)return void(I=!1);var e=this.parent,t=d.now(),i=b;clearTimeout(C),b=t,t-i>y?a(e):C=setTimeout(a,y,e)},350),clear:p}});
;define("disk-share:widget/pageModule/list/list-view-empty/list-view-empty.js",function(e,o,t){var i=e("base:widget/libs/jquerypacket.js"),d=e("base:widget/hash/hash.js"),n={dom:{module:".KPDwCE",searchEmptyModule:".empty-search-container",viewEmptyModule:".module-list-view-empty",noResultTcode:'a[node-type~="mnpBExp"]',noResultTcodePic:'div[node-type~="fzAGrl"]',noResultTcodeClose:'a[node-type~="qicaJxNp"]',newDirBox:'input[node-type~="vaka6pvn"]',newDir:'div[node-type~="chAPWn"]'},bindEvent:function(){var e=!1,o=i(n.dom.module);o.delegate(n.dom.noResultTcode,"mouseover",function(){i(n.dom.noResultTcodePic).show()}),o.delegate(n.dom.noResultTcodePic,"mouseover",function(){e=!0}),o.delegate(n.dom.noResultTcodePic,"mouseleave",function(){i(n.dom.noResultTcodePic).hide()}),o.delegate(n.dom.noResultTcode,"mouseout",function(){setTimeout(function(){e||(i(n.dom.noResultTcodePic).hide(),e=!1)},200)}),o.delegate(n.dom.noResultTcodeClose,"click",function(){i(n.dom.noResultTcodePic).hide()})},tmpl:{emptyViewContainer:'<div class="clearfix module-list-view-empty" style="" node-type="tgsJa09"><div class="list-view-empty-header"><div class="bar global-clearfix"><span class="chk"></span></div></div><div class="no-data"><div class="img"></div><p>没有数据...</p></div></div>',emptySearchContainer:'<div class="empty-search-container"><div class="search-empty-box"></div></div>'},util:{render:function(){i(n.tmpl.emptyViewContainer).appendTo(n.dom.module),i(n.tmpl.emptySearchContainer).appendTo(n.dom.module)}},init:function(){n.bindEvent()}};i(document).ready(function(){n.init()});var s={emptyView:function(){var e=d.get("search/key");return e?n.tmpl.emptySearchContainer:n.tmpl.emptyViewContainer}};t.exports=s});
;define("disk-share:widget/pageModule/list/list-view/list-view-builder.js",function(e,t,i){var a=e("base:widget/libs/jquerypacket.js"),s=e("disk-share:widget/system/fileOperate/fileOperate.js"),n=e("base:widget/historyManager/historyManager.js"),r=e("base:widget/tools/service/tools.date.js"),l=e("base:widget/tools/service/tools.format.js"),o=e("base:widget/tools/service/tools.path.js"),c=e("system-core:context/context.js").instanceForSystem,h=c.message;c.Broker.initButtonBroker({name:"shareList",config:{limit:2,container:a("<div>")}});var d=c.Broker.getButtonBroker("shareList"),g={LIST:"list",CATEGORY:"category",SEARCHPATH:"searchPath",SEARCHGLOBAL:"searchGlobal",SEARCH:"search"},m=function(){var e=this.parent.listHeader.config.columns||[{width:60},{width:16},{width:23}],t=document.createElement("dd");return t.className="g-clearfix AuPKyz",t.innerHTML='<span node-type="EOGexf" class="EOGexf"></span><div class="JS-fileicon"></div><div class="file-name" style="width:'+e[0].width+'%"><div class="text"><a href="javascript:void(0);" class="filename"></a></div><div class="sybxeNb">'+d.$container.html()+'</div></div><div class="file-size" style="width:'+e[1].width+'%">-</div><div class="ctime" style="width:'+e[2].width+'%"></div><div class="path-info" style="width:'+(e[3]?e[3].width-1:0)+'%"><span class="search-feild" node-type="axAv2e"></span></div>',t},p=null,v=null,f=function(){p=null,v=null},u=function(e,t){if(e&&0!==e.length)for(var i=0;i<e.length;i++){var s=a(e[i]),n=s.data("excludedir");if(n){var r=t.path.substring(1);-1!==n.indexOf(r)?s.addClass("g-disabled"):s.removeClass("g-disabled")}var l=s.data("includetype");if(l){var c=o.getFileCategory(t.path);-1===l.indexOf(c)?s.hide():s.show()}}},b=function(e){var t=/^[.,?\]})'";:`~!%&*|>，﹐。？、】）·！……’”；：]*/;if(e.highlighting&&e.highlighting.abstract){e.highlighting.abstractFixed=e.highlighting.abstract,e.highlighting.abstract=e.highlighting.abstract.replace(/\n+\s*\n/g,"\n"),e.highlighting.abstract=e.highlighting.abstract.replace(t,"");var i=e.highlighting.abstract;if(pos=i.search(/<em>/),pos>36){var a=pos-12;i=i.slice(a,i.length),e.highlighting.abstractFixed=i}e.highlighting.abstractFixed=e.highlighting.abstractFixed.replace(t,"")}return e},C=function(e,t,i){var o=t;null==o&&(o=this.buildView(e,t,i));var m=this.getElementDataByPosition(i),f=a(o),C=this.parent.cache.cacheName===g.SEARCHGLOBAL,w=this;if(C&&(f.addClass("list-view-vip-search"),m=b(m)),o.setAttribute("_position",i),o.setAttribute("_cmd_installed",1),this.isAllItemChecked()||this.isItemChecked(i)?f.addClass("JS-item-active"):f.removeClass("JS-item-active hover-item"),!o.getAttribute("_installed")){var S,k;f.mouseenter(function(){if(S=(new Date).getTime(),w.parent.isLocked())return!1;var e=a(this);return e.addClass("hover-item"),!1}).mouseleave(function(){if(w.parent.isLocked())return!1;var e=a(this);return e.removeClass("hover-item"),e.find(".g-dropdown-button").removeClass("button-open"),k=(new Date).getTime(),c.log.send({name:"listListHover",value:k-S}),!1}),f.click(function(e){var t=(new Date).getTime();if(w.parent.isLocked())return!1;var i=parseInt(this.getAttribute("_position"),10),s=w.isItemChecked(i),n=w.getCheckedIndexs(),r=e.ctrlKey,l=a(this);if(e.shiftKey){var o=Math.min(i,p),h=Math.max(i,p),d=l,g=!1;if("number"==typeof v){var m=Math.min(i,v),f=Math.max(i,v);for(g=m===i;f>=m;)w.setItemChecked(m,!1),d.length>0&&d.removeClass("JS-item-active"),d=g?d.next(".AuPKyz"):d.prev(".AuPKyz"),m++}for(d=l,g=o===i;h>=o;)w.setItemChecked(o,!0),d.length>0&&d.addClass("JS-item-active"),d=g?d.next(".AuPKyz"):d.prev(".AuPKyz"),o++;v=i}else p=i,v=null,r||(n.length>0&&(s===!1||s&&n.length>1)&&(w.setItemsChecked(!1),l.siblings(".AuPKyz").removeClass("JS-item-active")),s&&n.length>1&&(s=!1)),w.setItemChecked(i,!s),s?l.removeClass("JS-item-active"):l.addClass("JS-item-active");var u=(new Date).getTime();c.log.send({name:"listListSingleSel",value:u-t})}),f.delegate(".filename","click",function(){if(w.parent.isLocked())return!1;var e=parseInt(a(this).closest(".AuPKyz")[0].getAttribute("_position"),10),t=w.getElementDataByPosition(e);if(t.isdir)"string"==typeof t.path&&0===t.path.indexOf("/")&&(t.path=t.path.substr(1,t.path.length)),w.parent.cache.cacheName===g.SEARCH||w.parent.cache.cacheName===g.SEARCHGLOBAL||w.parent.cache.cacheName===g.SEARCHPATH?n.assignUrlHash("list/path="+encodeURIComponent(t.path)+"&vmode="+n.getCurrentParams().vmode):t.parent_path?w.parent.addHistory(t.path,t.server_filename,decodeURIComponent(t.parent_path)):w.parent.addHistory(t.server_filename,t.server_filename);else{var i=f.data("plugin");if(!i||!i.length)return!0;h.trigger("plugin:"+i,{filesList:[t]})}return!1}).delegate(".g-button","click",function(){if(w.parent.isLocked())return!1;var e=parseInt(a(this).closest(".AuPKyz")[0].getAttribute("_position"),10),t=w.getElementDataByPosition(e),i=a(this).next(".menu");if(i.length){var s=i.find(".g-button-menu");return u(s,t),a(this).closest(".g-dropdown-button").toggleClass("button-open"),void(i.offset().top>a(window).height()-i.outerHeight()?i.addClass("more-list-up"):i.removeClass("more-list-up"))}var n=a(this).index()-1;d.triggerClick(n,{filesList:[t],position:[e]})}).delegate(".g-button-menu","click",function(){if(w.parent.isLocked())return!1;var e=parseInt(a(this).closest(".AuPKyz")[0].getAttribute("_position"),10),t=w.getElementDataByPosition(e),i=a(this).index();d.triggerClick(i,{filesList:[t],position:[e]}),a(this).closest(".g-dropdown-button").removeClass("button-open")}).delegate(".sybxeNb","click",function(e){return w.parent.isLocked()?!1:void e.stopPropagation()}).delegate(".EOGexf","click",function(e){var t=(new Date).getTime();if(w.parent.isLocked())return!1;e.stopPropagation();var i=a(this).closest(".AuPKyz"),s=parseInt(i.attr("_position"),10),n=w.isItemChecked(s);w.setItemChecked(s,!n),n?i.removeClass("JS-item-active"):i.addClass("JS-item-active");var r=(new Date).getTime();c.log.send({name:"listListMultiSel",value:r-t})}).delegate(".EOGexf","dblclick",function(e){e.stopPropagation()}).delegate(".search-feild","click",function(e){e.stopPropagation(),n.assignUrlHash("list/path="+encodeURIComponent(a(e.target).data("path"))+"&vmode="+n.getCurrentParams().vmode)}),f.bind("dblclick",function(){if(w.parent.isLocked())return!1;var e=parseInt(a(this)[0].getAttribute("_position"),10),t=w.getElementDataByPosition(e);if(t.isdir)"string"==typeof t.path&&0===t.path.indexOf("/")&&(t.path=t.path.substr(1,t.path.length)),w.parent.cache.cacheName===g.SEARCH||w.parent.cache.cacheName===g.SEARCHGLOBAL||w.parent.cache.cacheName===g.SEARCHPATH?n.assignUrlHash("list/path="+encodeURIComponent(t.path)+"&vmode="+n.getCurrentParams().vmode):t.parent_path?w.parent.addHistory(t.path,t.server_filename,decodeURIComponent(t.parent_path)):w.parent.addHistory(t.server_filename,t.server_filename);else{var i=f.data("plugin");if(!i||!i.length)return!0;h.trigger("plugin:"+i,{filesList:[t]})}return!1}),o.setAttribute("_installed",1)}var y=s.getInfo(m.path,m.isdir,!0);if(C){if(1==m.category||3==m.category){var x=m.thumbs.url1.replace(/size=.*&/,"size=c50_u50&").replace(/&quality=100/,"&quality=80");f.find(".JS-fileicon").css("background","url("+x+") 50% 50% no-repeat")}else f.find(".JS-fileicon").removeAttr("style");f.find(".JS-fileicon").attr('class', 'JS-fileicon '+y.middleIcon)}else f.find(".JS-fileicon").attr('class', 'JS-fileicon '+y.smallIcon);if(m.isdir||y.plugin?(f.addClass("open-enable"),f.data("plugin",y.plugin)):(f.removeClass("open-enable"),f.data("plugin","")),C&&m.highlighting.filename?f.find(".filename").html(m.highlighting.filename).attr("title",y.fileName).data("filename",m.server_filename):f.find(".filename").html(y.name).attr("title",y.fileName).data("filename",m.server_filename),C){var A="";A+=m.highlighting&&m.highlighting.abstract?'<div node-type="qgdlBZ4m" class="name name-desc" title=" '+m.highlighting.abstract.replace(/\<em\>/g,"").replace(/\<\/em\>/g,"")+'">':'<div node-type="qgdlBZ4m" class="name name-desc" title="">',A+='<span class="name-text-wrapper">',A+=m.highlighting.abstractFixed?'<span node-type="yzOBbsb" class="yzOBbsb">'+m.highlighting.abstractFixed+"</span>":'<span node-type="yzOBbsb" class="yzOBbsb">'+(m.highlighting.abstract||"")+"</span>",A+="</span></div>",0===f.find(".name-desc").length?f.find(".file-name").append(A):f.find(".name-desc").html(A)}if(f.find(".file-size").text(m.isdir?"-":l.toFriendlyFileSize(m.size)),m.server_mtime||(m.server_mtime="-"),f.find(".ctime").text("-"===m.server_mtime?m.server_mtime:r.parseDate(m.server_mtime)),this.parent.cache.cacheName===g.SEARCH||this.parent.cache.cacheName===g.SEARCHGLOBAL||this.parent.cache.cacheName===g.SEARCHPATH){var L=m.path.split("/"),_="",H="";2===L.length?(_="/",H="全部文件"):(_=L.slice(0,L.length-1).join("/"),H=L[L.length-2]),f.find(".search-feild").data("path",_).attr("title",H).text(H)}return o};i.exports={getView:C,buildView:m,clear:f}});
;define("disk-share:widget/pageModule/list/listInit.js",function(e,t,i){var r=e("base:widget/libs/underscore.js"),a=e("base:widget/historyManager/historyManager.js"),n=e("base:widget/tools/tools.js"),o=(e("base:widget/storage/storage.js"),e("base:widget/libs/jquerypacket.js")),s=e("system-core:context/context.js"),l=s.instanceForSystem,c=l.ui.cacheManage,d=l.message,u=e("disk-share:widget/pageModule/list/list-view/list-view-builder.js"),h=e("disk-share:widget/pageModule/list/grid-view/grid-view-builder.js"),g=e("disk-share:widget/pageModule/list/list-view-empty/list-view-empty.js"),m="list",f="dir",v="category",y=".KPDwCE",p="JS-module-list-multselected",C={listViewContainer:".vdAfKMb",gridViewContainer:".JKvHJMb",listViewItem:".AuPKyz",gridViewItem:".cEefyz"},w=o(y),S=window.yunData||{},k=function(){var e={defaultViewModle:m};e.historyConfig=b(),e.listConfig=B(),e.listViewBuilder=L(),e.gridConfig=I(),e.gridViewBuilder=H(),e.listToolsConfig=M();var t=l.ui.list(y,e);s.setList(t);var i=e.listToolsConfig;return i.config.container=t.listHeader.getOperateContainer(),l.Broker.initButtonBroker(i),t.setListTools(l.Broker.getButtonBroker(i.name)),t},P={3:"全部图片",2:"全部音乐",4:"全部文档",1:"全部视频",7:"全部种子",6:"其他文件"},b=function(){return{}},B=function(){var e={defaultScroll:!0,listItemClass:"AuPKyz",itemActiveClass:"JS-item-active"};return e},L=function(){return u},I=function(){return{defaultScroll:!0,columnWidth:124,gridItemClass:"cEefyz",itemActiveClass:"JS-item-active"}},H=function(){return h},M=function(){return{name:"shareListTools",config:{cachePaddingLeft:!1,limit:8,outSize:36,resize:!0}}},_=k();_.onListOrderChange=function(e,t){var i="localshareorder_"+(S.MYNAME||"").replace(/@/g,"");if(e){var r=e+"_"+t;null!==localStorage&&localStorage.setItem(i,r)}else if(null!==localStorage&&"function"==typeof localStorage.getItem){var n,r=localStorage.getItem(i),o=a.getCurrentParams();if("undefined"!=typeof o&&"3"===o.type)return null;if(r&&2===(n=r.split("_")).length){var n=r.split("_"),s=parseInt(n[1],10),l={item:n[0],desc:s};return l}return null}};var V=function(e){e&&-1==e.errno?l.ui.tip({msg:'由于您的帐号存在违规行为，帐号已被封禁。<a href="http://help.baidu.com/add?prod_id=48">申诉</a>',mode:"caution",autoClose:!1,hasClose:!0}):e&&e.errno&&l.ui.tip({msg:l.errorMsg(e.errno)||"网络错误，请稍候重试",mode:"caution",autoClose:!1,hasClose:!0}),_.updateLoadingTips(2,0),_.listEmptyTip(_.$emptyTips)},O=function(){var e,t,i=_.onListOrderChange(),r="";r=decodeURIComponent(r?r:""),i&&(e=i.item,t="number"==typeof i.desc?i.desc:1);var a={api:"/share/list",params:{uk:S.SHARE_UK,shareid:S.SHARE_ID,order:e||"time",desc:void 0!==t?t:1,showempty:0,web:1},limit:100,currentPage:0,listKey:"list",parentPath:r,getParamsBykey:function(e){return{dir:e}},getPageParams:function(e,t){return{page:e+1,num:t}},getKeyByParams:function(e){return e.dir},failCallBack:function(e,t){V(e,t)}};return a},j=function(){var e,t,i=_.onListOrderChange();i&&(e=i.item,t="number"==typeof i.desc?i.desc:1);var r={api:"/api/categorylist",params:{order:e||"time",desc:void 0!==t?t:1,showempty:0,web:1},limit:100,currentPage:0,listKey:"info",getParamsBykey:function(e){return{category:e}},getPageParams:function(e,t){return{page:e+1,num:t}},getKeyByParams:function(e){return e.category},failCallBack:function(e,t){V(e,t)}};return r},T=a.getDefault();_.onListOrderChange("other",1);var A=new c("list",O(),""),F=new c("category",j(),"");A.selfAddDataToCache("list","/",window.yunData.FILEINFO,!1,0),d.listen("system-show-view-mode",function(e){return _.isLocked()?void(e.returnValue=!1):(d.trigger("system-change-view-mode-loadingtip"),void Q(e.type))}),_.onViewModuleChange=function(e){d.trigger("system-update-view-mode",{type:e}),_.listHeader.changeVmode({type:e})};var J=function(e){var t,i=e&&e.path;"undefined"!=typeof e&&e.all===!0?et.removeCacheAll():e&&e.flagChangeSuffix||("undefined"!=typeof i&&(i=i||"/",et.removeCache(i)),D===m?(t=a.getCurrentParams(),i=t.path||"/",i&&et.removeCache(i)):D===v&&et.removeCategoryCache()),_.refreshList()};d.listen("system-refresh",function(e){J(e)}),_.onCheckeChanged=function(e){e>1?w.addClass(p):w.removeClass(p)},_.onLockChanged=function(){},_.onLoadedCallBack=function(){d.trigger("after-list-loaded")},_.mapFirstFileByCategory=function(e,t){var i=null;if(e.length<=0)return i;i={};var r=_.getFirstPosition();if(0>r)return i;for(var a,s,l=_.getDomByPosition(r),c=null;null!==l&&e.length>0;){if(c=_.getElementDataByPosition(r),c&&!c.isdir&&c.server_filename&&(a=n.getFileCategory(c.server_filename))&&a&&(a="."+a,!i[a]&&(s=o.inArray(a,e))>=0&&(e.splice(s,1),t.call(null,a,o(l)))))return;l=_.getDomByPosition(++r)}},_.getIndexsByFiles=function(e){return _.cache.getIndexsByFiles(e)},_.remove=function(){},_.removeCacheByPath=function(e){et.removeCache(e)};var $=function(){L().clear(),H().clear()},D=m,x=function(e,t){var i=a.buildHistory(e,t);T.addHistory(i)},K=function(e,t){var i=e.vmode;_.setViewModule("grid"===i?"grid":"list",t)},E=function(e,t){return d.trigger("system-change-toolbar",{module:_.cache.cacheName}),"category"===e&&3===t?void l.toolbar.showTimelineDom():void l.toolbar.showDefault()},z=function(){var e,t,i=_.onListOrderChange();i&&(e=i.item,t="number"==typeof i.desc?i.desc:1);var r=[{order:e||"server_filename",desc:void 0!==t?t:1,operateOrderKey:function(){},columns:[{name:"文件名",key:"server_filename",checkbox:!0,width:60},{name:"大小",key:"size",width:16},{name:"修改日期",key:"time",width:23}],module:["list","category"]}];return r},N=function(e){for(var t=z(),i=_.cache&&_.cache.cacheName,r=e.cacheName,a=null,n=[],s=0;s<t.length;s++){if(a=t[s],n=a.module,-1!==o.inArray(i,n)&&-1!==o.inArray(r,n)&&"category"!==r)return;if(-1!=o.inArray(r,n))return _.changeHeaderConfig(a),e.config.params.order=a.order,void(e.config.params.desc=a.desc)}},R=function(e){L().clear();var t=e.path,i=e.parentPath;"undefined"==typeof t&&(t=""),K(e),_.$listHeader.show(),q(t,i),E("list",t),$()},U=function(e){x(m,e)},W=function(e){var t=e.type,i=parseInt(t,10);K(e),Y(i),E("category",i),$()},q=function(e,t){D=m,N(A),_.changeCache(A),"/"===e&&(e=""),/\S\/+$/.test(e)&&(e=e.replace(/\/+$/,""));var i=e.split("/"),r=i.slice(),t=t||"";t||(t=a.getCurrentParams().parentPath||"");var n=t.split("/");n[0]="/",i[0]="/",r[0]="全部文件",_.changeHistory(i,r,n)},Y=function(e){D=v,N(F),_.changeCache(F);var t=P[e];if(t){var i=[e],r=[t];_.changeHistory(i,r)}else G(["/"])};_.extend({getCheckMsg:function(e){return"已选中"+e+"个文件/文件夹"},resizeScrollBar:function(e){var t=this.$container;if("number"==typeof e||"string"==typeof e?t.height(e):e=t.height(),0===e)throw"[Error] list container's height is 0, need to set";t.height(e);var i=this.listHeader.hasInit===!1?0:55;"none"===t.find(".JDeHdxb").css("display")?(t.find(".NHcGw").height(e-i).find(".scrollbar-tracker").height(e-i-2-26),t.find(".BNfIyPb").height(e-i).find(".scrollbar-tracker").height(e-i-2-26)):(t.find(".NHcGw").height(e-75).find(".scrollbar-tracker").height(e-75-2),t.find(".BNfIyPb").height(e-75).find(".scrollbar-tracker").height(e-75-2))},checkLocalSort:function(){return!0},localSort:function(e,t,i){var r=e.key,a=e.getCache().list.data[r].list;"time"===t&&(t="server_mtime"),a.sort(function(e,i){return e[t]>i[t]?1:-1}),i&&a.reverse()}}),_.addHistory=function(e,t,i){var r=_.getHistoryIds();r=r?r.slice():[],r.push(e);var i=i||"";i||(i=a.getCurrentParams().parentPath||""),G(r,i)},_.goHistory=function(e,t){var i=a.getCurrentParams(),r={};i.vmode&&(r.vmode=i.vmode),t?/\S\/+$/.test(t)&&(t=t.replace(/\/+$/,"")):t="/",r.path=t,x(e,r)};var G=function(e,t){D=m,1!==e.length&&(e[0]="");var i=a.getCurrentParams(),r={};i.vmode&&(r.vmode=i.vmode);var n=e.join("/");/\S\/+$/.test(n)&&(n=n.replace(/\/+$/,"")),r.path=n,t&&(r.parentPath=t),x(D,r)},Q=function(e){var t=a.getCurrentParams();t.vmode="grid"===e?"grid":"list",x(D,t)};_.getHistoryList().goToHistory=function(e,t){if(!(e>=this.historyList.length||0>e)){var i=this.historyList.slice(),r=this.historyListParents.join("/");r=r.replace(/\/\//,"/");var a=this.historyListParents.length-1;t&&e-1===a&&(e=1,a=0),(1===e||e===this.historyList.length-1)&&(a=0),i.splice(e+a,this.historyList.length),G(i,r)}},T.listen(m,R),T.listen(f,U),T.listen(v,W);var X=function(){var e=a.getCurrentHash();return e&&e.length>1&&e[1]&&(e[0]===m&&e[1]&&e[1].path||e[0]===v&&e[1]&&e[1].type||e[0]===f&&e[1]&&e[1].path)?(D=e[0],!0):!1};X()?a.interpretCurrentWindow():_.addHistory("/","全部文件");var Z=r.throttle(function(){var e=o(window).height()-w.offset().top;_.resize(e-60)},300);Z(),o(window).resize(Z),_.listHeader.canTriggerOrder=function(){return!0},_.cancelEidtingDir=function(){},_.cancelFilesSelect=function(){w.find(".AuPKyz").removeClass("JS-item-active"),w.find(".cEefyz").removeClass("JS-item-active"),_.setItemsChecked(!1,!0)};var et={getCache:function(){return c.getCache()},deleteCacheByMode:function(e,t,i){var r=t.getDataByKey();this.removeCacheAll();for(var a=r&&r.list,n=!1,o="",s="",l=a.length,c=l-1;c>=0;c--){for(var d=i.length,u=d-1;u>=0;u--)o=i[u],s=o.path||o,a[c].path==s&&(i.splice(u,1),n=!0);n&&(a.splice(c,1),n=!1)}return r.list=a,et.getCache()[t.cacheName].data[t.getKey()]=r,r},removeCacheByPath:function(e){var t=this.getCache(),i={};t&&t.list&&t.list.data&&(i=t.list.data),i[e]&&delete i[e]},removeCacheAll:function(){var e=this.getCache();for(var t in e)e.hasOwnProperty(t)&&e[t]&&e[t].data&&(e[t].data={})},removeCache:function(e,t,i){var r=this.getCache(),a={};r&&r.list&&r.list.data&&(a=r.list.data),this.removeSubFiles(a,e),"move"===t&&this.removeSubFiles(a,i),this.removeOtherListCache()},removeSubFiles:function(e,t){t="/"===t?t:t+"/";for(var i in e)e.hasOwnProperty(i)&&0===(i+"/").indexOf(t)&&delete e[i]},removeOtherListCache:function(){this.removeCategoryCache(),this.removeTreeCache()},removeCategoryCache:function(){this.removeCacheByKey("category")},removeTreeCache:function(){this.removeCacheByKey("tree")},removeCacheByKey:function(e){var t=this.getCache();t&&t[e]&&t[e].data&&(t[e].data={})}};e.async("disk-share:widget/pageModule/mouse-utils/mouse-select.js",function(e){new e({$dom:o(C.listViewContainer),item:C.listViewItem,viewMod:"list",selectClass:"JS-item-active",list:_,canSelect:function(){return _.isLocked()?!1:void 0}}),new e({$dom:o(C.gridViewContainer),item:C.gridViewItem,vieMod:"grid",selectClass:"JS-item-active",list:_,canSelect:function(){return _.isLocked()?!1:void 0}})}),_.listEmptyTip=function(e){_.$listHeader.hide(),e.html(g.emptyView).show()};var tt=function(){var e=document.referrer,t="fm_self",i=/(http|https)\:\/\/(tieba|hao123)\.baidu\.com/gi,r=/(http|https)\:\/\/www\.hao123\.com/gi;return"string"==typeof e&&e.length>0&&(t=i.test(e)?"fm_"+RegExp.$2:r.test(e)?"fm_hao123":-1!==e.indexOf("http://www.baidu.com/s?wd=")?"fm_baidups":"fm_not_proved"),t};l.log.sendUserReport(tt()),i.exports=_});
;define("disk-share:widget/pageModule/list/listMenu.js",function(e){var i=e("base:widget/libs/jquerypacket.js"),t=e("system-core:context/context.js").instanceForSystem,s=e("disk-share:widget/pageModule/list/listInit.js"),n=void 0,r={listTarget:".zJMtAEb",gridTarget:".fyQgAEb"},o={top:[{title:"打开",action:function(){s.isGridMode()?i(this).closest(".cEefyz").find(".filename").trigger("click"):i(this).closest(".AuPKyz").find(".filename").trigger("click")},display:function(){if(s.getCheckedIndexs().length>1)return"disable";var e=i(this).closest(".AuPKyz");return s.isGridMode()&&(e=i(this).closest(".cEefyz")),e.length&&!e.hasClass("open-enable")?"disable":void 0},keyboard:"o"}],middle:[],bottom:[]};t.Broker.initMenuBroker({target:i(r.listTarget)[0],type:"share",config:o,events:{beforeMenu:function(){var e=i(this).closest(".AuPKyz")[0];if(!e)return!1;s.cancelEidtingDir();var t=parseInt(e.getAttribute("_position"));n=t,s.isItemChecked(t)||(s.setSingleItemChecked(t,!0),i(this).closest(".zJMtAEb").is(":visible")?i(this).closest(".NHcGw").find(".AuPKyz").removeClass("JS-item-active"):i(this).closest(".BNfIyPb").find(".cEefyz").removeClass("JS-item-active"),i(e).addClass("JS-item-active")),i(e).removeClass("hover-item")},afterMenu:function(){s.lock(!0)},menuHide:function(){s.lock(!1)}}}),t.Broker.initMenuBroker({target:i(r.gridTarget)[0],type:"share",config:o,events:{beforeMenu:function(){var e=i(this).closest(".cEefyz")[0];if(!e)return!1;s.cancelEidtingDir();var t=parseInt(e.getAttribute("_position")),r=i(e).index();n=s.getGridPostiion(t,r),s.isItemChecked(n)||(s.setSingleItemChecked(n,!0),i(this).closest(".BNfIyPb").find(".cEefyz").removeClass("JS-item-active"),i(e).addClass("JS-item-active")),i(e).removeClass("hover-item")},afterMenu:function(){s.lock(!0)},menuHide:function(){s.lock(!1)}}})});
;define("disk-share:widget/pageModule/mouse-utils/mouse-select.js",function(t,e,o){function i(t){this.ms=new s(t.$dom),this.$dom=t.$dom,this.item=t.item,this.viewMod=t.viewMod,this.selectClass=t.selectClass,this.list=t.list,this.canSelect=t.canSelect||null,this.cacheList=[],this.positionArray=[],this._init()}var s=t("base:widget/mouse-utils/mouse-selection.js");i.prototype._init=function(){var t=this;t.onStart(),t.onSelect(),t.onEnd()},i.prototype.onStart=function(t){var e=this;e.ms.onStart=function(o){if(null!==e.canSelect&&"function"==typeof e.canSelect&&e.canSelect()===!1)return!1;var i,s,n,l,r=e.$dom.find(e.item);return n=$(o.target),l=n.closest(e.item),s=l.attr("_position"),i="list"===e.viewMod?s:s*e.list.getColumnsCount()+l.index(),e.positionArray=[],l.hasClass(e.selectClass)?!1:(e.cacheList=r,"function"==typeof t&&t(o),!0)}},i.prototype.onSelect=function(t){var e=this;e.ms.onSelect=function(o){"list"===e.viewMod?e.listMouseSelect(o):e.gridMouseSelect(o),"function"==typeof t&&t(o)}},i.prototype.onEnd=function(t){var e=this;e.ms.onEnd=function(){e.list.setEachItemChecked(e.positionArray,!0),e.positionArray=[],"function"==typeof t&&t()}},i.prototype.listMouseSelect=function(t){var e,o,i,s,n,l=this;for(e=0;e<l.cacheList.length;e++)if(n=$(l.cacheList[e]),o=n.attr("_position"),i=n.offset(),s=n.outerHeight(),i.top<t.top&&i.top+s>t.top||i.top>t.top&&i.top+s<t.top+t.height||i.top<t.top+t.height&&i.top+s>t.top+t.height){var r=l.positionArray.indexOf(o);-1===r&&l.positionArray.push(o),n.addClass(l.selectClass)}else{n.removeClass(l.selectClass);var r=l.positionArray.indexOf(o);r>-1&&l.positionArray.splice(r,1)}},i.prototype.gridMouseSelect=function(t){var e,o,i,s,n,l,r=this;for(e=0;e<r.cacheList.length;e++)if(n=$(r.cacheList[e]),o=parseInt(n.attr("_position"))*r.list.getColumnsCount()+n.index(),i=n.offset(),s=n.outerHeight(),l=n.outerWidth(),(i.top<t.top&&i.top+s>t.top||i.top>t.top&&i.top+s<t.top+t.height||i.top<t.top+t.height&&i.top+s>t.top+t.height)&&(i.left<t.left&&i.left+l>t.left||i.left>t.left&&i.left+l<t.left+t.width||i.left<t.left+t.width&&i.left+l>t.left+t.width)){var a=r.positionArray.indexOf(o);-1===a&&r.positionArray.push(o),n.addClass(r.selectClass)}else{n.removeClass(r.selectClass);var a=r.positionArray.indexOf(o);a>-1&&r.positionArray.splice(a,1)}},o.exports=i});
;define("disk-share:widget/pageModule/page-controller/min-width.js",function(i){!function(){var e=i("base:widget/libs/jquerypacket.js");e(window).bind("resize",function(){var i=e(window).width(),d=e("#doc");d.width(1230>i?1230:"auto")}),e(window).trigger("resize")}()});
;define("disk-share:widget/pageModule/page-controller/share-multi.js",function(e){var a=e("disk-share:widget/pageModule/data-center/data-center.js"),t=e("base:widget/libs/jquerypacket.js"),s=e("system-core:context/context.js").instanceForSystem;s.message.trigger("share-person-info","show-intro"),a.set("page","share-multi"),t.ajax({url:"/share/autoincre",type:"get",data:{uk:yunData.SHARE_UK,shareid:yunData.SHARE_ID,type:2,sign:yunData.SIGN,timestamp:yunData.TIMESTAMP}})});
;define("disk-share:widget/pageModule/page-controller/share-single.js",function(e){var a=e("base:widget/libs/jquerypacket.js"),t=e("system-core:context/context.js").instanceForSystem;t.message.trigger("share-person-info","show-intro"),a.ajax({url:"/share/autoincre",type:"get",data:{uk:yunData.SHARE_UK,shareid:yunData.SHARE_ID,type:2,sign:yunData.SIGN,timestamp:yunData.TIMESTAMP}})});
;define("disk-share:widget/pageModule/share-ad/share-ad.js",function(e){var t=e("system-core:context/context.js").instanceForSystem,a={};a.resize=function(){var e=$("#share_aside"),t=e.find("#module-ad"),a=e.find("dl");t&&t.length&&a&&a.length&&a.last().after(t)},a.installAdPanl=function(e){var n=function(e,t){var a=null;a=document.createElement("script"),a.type="text/javascript",a.src=e,"function"==typeof t&&(window.attachEvent?a.onreadystatechange=function(){var e=a.readyState;("loaded"===e||"complete"===e)&&(a.onreadystatechange=null,t())}:a.onload=t),document.getElementsByTagName("head")[0].appendChild(a)},d=$('<div id="module-ad" style="text-align: center;"><div style="margin: 14px auto; width: 203px; height: 1px; overflow: hidden; background: #e3e3e3; border-bottom: 1px solid #fff;"></div></div>'),o=$('<div style="margin: 0 auto; width: 203px; height: 186px; overflow: hidden;"></div>');d.append(o),t.log.send({name:"share_page_ad_request"}),n("http://pups.bdimg.com/advert/js/advert.js?"+ +new Date,function(){t.log.send({name:"share_page_ad_request_succ"}),window.upsadvert&&upsadvert.run&&"function"==typeof upsadvert.run&&upsadvert.run("83",o[0],function(n){t.log.send({name:"share_page_ad_exec_succ"}),n&&0!=n.errno&&5!=n.errno||(e.append(d),a.resize())})})},a.doResizeAdPanl=function(e){var t=$("#share_ad_info_panl");if(!(t.length<=0)){var a=186,n=e.find("dl").last();if(n.length>0){var d=n.offset().top,o=n.height();disk.DEBUG&&console.log(d,o);var s=n.offset().top+n.height(),i=s-e.offset().top+10,r=e.height(),l=Math.min(r-i,a);t.css({top:i,height:l})[50>l?"hide":"show"]()}}},$(".module-share-ad").length&&a.installAdPanl($(".module-share-ad"))});
;define("disk-share:widget/pageModule/share-empty/share-empty.js",function(e,s,t){var o=e("base:widget/libs/jquerypacket.js"),n=e("system-core:context/context.js").instanceForSystem.message,r=function(){var e={module:"div.module-share-empty"};n.listen("share-empty",function(s,t){"render"===s&&(t.show?o(e.module).show():o(e.module).hide())})};t.exports=new r});
;define("disk-share:widget/pageModule/share-file-main/adPanLog.js",function(e){var n=e("base:widget/libs/jquerypacket.js"),i=e("system-core:context/context.js").instanceForSystem,a={isOnIframe:!1,type:"",log:{view:function(e){n(window).load(function(){i.log.send({name:"sharePage_AD_plan_"+e+"_show"})})},click:function(e,o){e.find("iframe").hover(function(){a.isOnIframe=!0},function(){a.isOnIframe=!1}),n(window).blur(function(){a.isOnIframe&&i.log.send({name:"sharePage_AD_plan_"+o+"_click"})})},adClick:function(e,n){e.on("click",function(){i.log.send({name:"sharePage_AD_plan_"+n+"_click"})})}}},o=function(){var e=n("#share-ad-box"),i=n('.ad-multi-tips[node-type="share-mutil-bottom"]'),o=e.attr("type")||4,t=i.attr("type")||"";a.log.view(o),a.log.view(t),a.log.click(e,o),a.log.adClick(i,t)};o()});
;define("disk-share:widget/pageModule/share-file-main/commonLogic.js",function(e,t,n){var i=e("base:widget/storage/storage.js"),a=e("system-core:context/context.js").instanceForSystem,o=window.yunData,s={parseQuota:a.tools.baseService.toFriendlyFileSize,saveFileMeta:function(e){e.conf.meta=window.yunData.FILEINFO[0],a.extend({list:{getSelected:function(){return[e.conf.meta]}}})},checkLoginCallTransfer:function(){"1"===i.getItem("transferFiles")&&(o.MYNAME!==o.SHARE_USER_NAME&&a.message.callPlugin("保存到网盘@com.baidu.pan"),i.removeItem("transferFiles"))},getFileIcon:function(e){var t=e.conf.meta,n=a.file.getFileInfo(t.path,t.isdir,!1,!1,!0);return n},getFileSuffix:function(e){return e.match(/([^\.]+)$/)[1].toLowerCase()}};n.exports=s});
;define("disk-share:widget/pageModule/share-file-main/fileType/application/application.js",function(e){var i=e("base:widget/libs/jquerypacket.js"),a=e("base:widget/libs/underscore.js"),n=e("disk-share:widget/pageModule/share-file-main/commonLogic.js"),o={conf:{},node:{fileInfo:'[node-type="share-info-box"]'},renderStyle:function(){var e=['<a class="fileicon" href="javascript:;" style="cursor: default;"></a>','<div class="share-info-zipdesc">',"文件大小:",'<span class="zip-quota"><%- info.fileQuota %></span>',"</div>"].join(""),s=a.template(e,{variable:"info"})({fileQuota:n.parseQuota(o.conf.meta.size)}),l=o.node.fileInfoNode=i(o.node.fileInfo);l.append(s).addClass("share-info-default").find(".fileicon").addClass(n.getFileIcon(o).largeIcon)}},s={init:function(){n.saveFileMeta(o),o.renderStyle(),n.checkLoginCallTransfer()}};s.init()});
;define("disk-share:widget/pageModule/share-file-main/fileType/bt/bt.js",function(e){var n=e("base:widget/libs/jquerypacket.js"),i=e("base:widget/libs/underscore.js"),a=e("disk-share:widget/pageModule/share-file-main/commonLogic.js"),o=(e("system-core:context/context.js").instanceForSystem,{conf:{},node:{fileInfo:'[node-type="share-info-box"]'},tmpl:{bt:['<a class="fileicon" node-type="info-open-button" href="javascript:;"></a>','<div class="share-info-zipdesc">',"文件大小:",'<span class="zip-quota"><%- info.fileQuota %></span>','<div class="bt-box-bar"><span class="bt-box" node-type="bt-open-button"></span></div>',"</div>"].join("")},renderStyle:function(){var e=i.template(o.tmpl.bt,{variable:"info"})({fileQuota:a.parseQuota(o.conf.meta.size)}),s=o.node.fileInfoNode=n(o.node.fileInfo);s.append(e).addClass("share-info-default").find(".fileicon").addClass(a.getFileIcon(o).largeIcon)}}),s={init:function(){a.saveFileMeta(o),o.renderStyle(),a.checkLoginCallTransfer()}};s.init()});
;define("disk-share:widget/pageModule/share-file-main/fileType/document/document.js",function(e){var i=e("base:widget/libs/jquerypacket.js"),o=e("system-core:context/context.js").instanceForSystem,n=e("disk-share:widget/pageModule/share-file-main/commonLogic.js"),d={conf:{},node:{fileInfo:'[node-type="share-info-box"]'},renderStyle:function(){d.node.fileInfoNode=i(d.node.fileInfo),d.node.fileInfoNode.addClass("share-info-doc"),d.node.fileInfoNode.css({height:i(window).height()-190})},openTheFile:function(){setTimeout(function(){o.message.callPlugin("网盘文档阅读器@com.baidu.pan",{filesList:d.conf.meta,dom:d.node.fileInfoNode,errorCallBack:function(e){if(0===+e)return!1;var i=window.isNaN(e)?e:"啊哦，预览不成功啊，下载下来看吧",o=['<div class="doc-view-failed">','<div class="doc-view-failed-img" style="display: block;">','<div class="doc-view-failed-txt">',i,"</div>","</div>",'<div class="cb"></div>',"</div>"].join("");d.node.fileInfoNode.html(o)}})},600)}},s={init:function(){n.saveFileMeta(d),d.renderStyle(),d.openTheFile(),n.checkLoginCallTransfer()}};s.init()});
;define("disk-share:widget/pageModule/share-file-main/fileType/music/music.js",function(e){var i=(e("base:widget/libs/jquerypacket.js"),e("system-core:context/context.js").instanceForSystem),s=e("disk-share:widget/pageModule/share-file-main/commonLogic.js"),a=window.yunData||{},n={conf:{},init:function(){s.saveFileMeta(n),i.message.callPlugin("网盘音频播放器@com.baidu.pan",{filesList:a.FILEINFO,inDialog:!1})}};n.init()});
;define("disk-share:widget/pageModule/share-file-main/fileType/other/other.js",function(e){var i=e("base:widget/libs/jquerypacket.js"),n=e("base:widget/libs/underscore.js"),o=e("disk-share:widget/pageModule/share-file-main/commonLogic.js"),a=e("system-core:context/context.js").instanceForSystem,t={conf:{},node:{fileInfo:'[node-type="share-info-box"]',unzipBox:"span.unzip-box",fileOpenBtn:'[node-type="info-open-button"]'},tmpl:{zip:['<a class="fileicon" node-type="info-open-button" href="javascript:;"></a>','<div class="share-info-zipdesc">',"文件大小:",'<span class="zip-quota"><%- info.fileQuota %></span>','<div class="unzip-box-bar"><span class="unzip-box" node-type="info-open-button"></span></div>',"</div>"].join(""),other:['<a class="fileicon" href="javascript:;" style="cursor: default;"></a>','<div class="share-info-zipdesc">',"文件大小:",'<span class="zip-quota"><%- info.fileQuota %></span>',"</div>"].join("")},classify:function(){var e=t.conf.meta,i=o.getFileSuffix(e.server_filename);"zip"===i||"rar"===i?(t.conf.meta.fileType="zip",t.excuteZip()):t.checkIsCode(i)?(t.conf.meta.fileType="code",t.excuteCode()):(t.conf.meta.fileType="other",t.excuteOther())},checkIsCode:function(e){for(var i="",n=0;n<window.manifest.length;n++)"网盘代码阅读器"===window.manifest[n].name&&(i=window.manifest[n].filesType);return i.indexOf(e)>-1?!0:!1},excuteZip:function(){t.renderStyle();var e={type:"big",color:"blue",title:"打开压缩包",resize:!0};a.ui.button(e).appendTo(i(t.node.unzipBox)),t.node.fileInfoNode.delegate(t.node.fileOpenBtn,"click",function(){a.message.callPlugin("网盘解压缩@com.baidu.pan",{filesList:[t.conf.meta]})})},excuteCode:function(){var e=t.node.fileInfoNode=i(t.node.fileInfo);e.css({height:i(window).height()-190}),a.message.callPlugin("网盘代码阅读器@com.baidu.pan",{filesList:t.conf.meta,dom:e,errorCallBack:function(i){if(0===+i)return!1;var n=['<div class="doc-view-failed">','<div class="doc-view-failed-img" style="display: block;">','<div class="doc-view-failed-txt">啊哦，预览不成功啊，下载下来看吧</div>',"</div>",'<div class="cb"></div>',"</div>"].join("");e.html(n)}})},excuteOther:function(){t.renderStyle()},renderStyle:function(){var e=n.template(t.tmpl[t.conf.meta.fileType],{variable:"info"})({fileQuota:o.parseQuota(t.conf.meta.size)}),a=t.node.fileInfoNode=i(t.node.fileInfo);a.append(e).addClass("share-info-default").find(".fileicon").addClass(o.getFileIcon(t).largeIcon)}},s={init:function(){o.saveFileMeta(t),t.classify(),o.checkLoginCallTransfer()}};s.init()});
;define("disk-share:widget/pageModule/share-file-main/fileType/picture/Rotater.js",function(t,i,e){var a=t("base:widget/libs/jquerypacket.js"),o=function(t,i){if(!(this instanceof o)){var e=new o(t,i);return e}this.init(t,i)};o.prototype.init=function(t,i){this.rotaterBox=a(t),this.image=this.rotaterBox.find("img"),this.leftButton=a(".left"+i.slice(1)),this.rightButton=a(".right"+i.slice(1)),this._setupData(),this._style(),this._bindEvent(i)},o.prototype._setupData=function(){this.leftButton.data("dir","-1"),this.rightButton.data("dir","1"),this.rotation=1,this.containerWidth=this.rotaterBox.width(),this.containerHeight=this.rotaterBox.height()},o.prototype._style=function(){this.rotaterBox.addClass("poorRotaterBox"),"absolute"!==this.rotaterBox[0].style.position&&(this.rotaterBox[0].style.position="relative"),this.imageStylePrefix=a.browser.msie&&parseInt(a.browser.version,10)<9?"ie":"",this.image.addClass(this.imageStylePrefix+"poorRotater-1"),this.image.animate({marginTop:this.image.height()/-2,marginLeft:this.image.width()/-2},function(){a(this).css("visibility","visible")})},o.prototype._bindEvent=function(t){var i=this;a(t).bind("click",function(){var t=parseInt(a(this).data("dir"),10),e=(i.rotation+t)%4,o=i.image.width(),s=i.image.height();0>=e&&(e+=4),i.image.removeClass(i.imageStylePrefix+"poorRotater-"+i.rotation).addClass(i.imageStylePrefix+"poorRotater-"+e),i.image.css(e%2===0&&o>i.containerHeight&&o>s?{width:i.containerHeight,height:"auto"}:{width:"auto",height:"auto"}),i.rotation=e,o=i.image.width(),s=i.image.height(),i.image.css({marginTop:s/-2,marginLeft:o/-2})})},e.exports=o});
;define("disk-share:widget/pageModule/share-file-main/fileType/picture/picture.js",function(e,i,t){var a=e("base:widget/libs/jquerypacket.js"),n=e("disk-share:widget/pageModule/share-file-main/fileType/picture/Rotater.js"),o=e("disk-share:widget/system/util/selection.js"),r=e("disk-share:widget/pageModule/share-file-main/commonLogic.js"),s=e("system-core:context/context.js"),c=(window.yunData||{},{conf:{},q:{mod:".module-share-file-main",picFileDetail:".picture-file-detail",picContainer:".picContainer",rotateBar:".rotateBar"},init:function(e){var i=this,t=a(i.q.mod),r=function(){var e=document.getElementById("viewFailed");e.style.display="block",t.find(q.picFileDetail).css("background","#efefef"),t.find(q.picContainer).remove(),t.find(q.rotateBar).remove()};if(!e)return void r();var c=document.getElementById("rotateImage"),d=e.replace("c850_u580","c710_u400");c.style.visibility="hidden",c&&(c.onload=function(){o.resizeImage(c),a(".picture-file-detail").mouseenter(function(){a(".rotateBar").show()}).mouseleave(function(){a(".rotateBar").hide()}),n("#rotateContainer",".RotaterBtn"),s.instanceForSystem.log.send({type:"picpreview_successed_analyties",sendPageFrom:!0})},c.onerror=r,c.src=d)}});t.exports={showPicture:function(e){r.saveFileMeta(c),c.init(e)}}});
;define("disk-share:widget/pageModule/share-file-main/fileType/video/video.js",function(e){var i=e("base:widget/libs/jquerypacket.js"),n=e("system-core:context/context.js").instanceForSystem,a=e("disk-share:widget/pageModule/share-file-main/commonLogic.js"),r=e("base:widget/storage/storage.js"),t=n.message,o=window.yunData,s={conf:{},node:{container:"#video-wrap",mod:"#video-wrap-outer",startTip:".video-start-tip",saveToPan:".save-to-pan"},vars:{hasTransfered:!1,shareFileId:o.FS_ID+"@"+o.MYUK+",",previewTime:30,resolveFileInDiskStatus:0},callPlugin:function(){t.callPlugin("网盘视频播放器@com.baidu.pan",{file:s.getFile(),container:i(s.node.container),flag:"sharevideo",rememberPosition:!1,autoplay:!0,werbung:s.getIsSelf(),getUrl:function(e){return s.concatUrl(s.getFile(),e)},callback:function(e){s.player=e,s.checkInDisk()||i(s.node.mod).find(".video-start-tip").show()},onBeforePlay:function(){return!0},onPlay:function(){},onPause:function(){},onBeforeDestroy:function(){return!0},onTimeUpdate:function(e,i){s.checkNotOver(e,i)}})},concatUrl:function(e,i){var n=location.protocol+"//"+location.host+"/share/streaming?channel=chunlei&uk="+window.yunData.SHARE_UK+"&path="+encodeURIComponent(e.path)+"&sign="+window.yunData.SIGN+"&timestamp="+window.yunData.TIMESTAMP+"&shareid="+window.yunData.SHARE_ID+"&type="+i;return n},checkNotOver:function(e){if(s.vars.hasTransfered||o.SHARE_UK===o.MYUK)return!0;if(e>s.vars.previewTime){var n=i(s.node.mod);s.player.pause(),n.find(".video-start-tip").hide(),n.find(".video-overlay-iframe").show(),n.find(".video-over-tip").show()}},getLoginStatus:function(){return o.LOGINSTATUS},getIsSelf:function(){return o.MYSELF},getFile:function(){return o.FILEINFO[0]},checkInDisk:function(){if(1!==+s.getLoginStatus())return!1;if(s.getIsSelf())return!0;var e=r.getItem("panTransferedFile");return e=e?e:"",-1!==e.indexOf(s.vars.shareFileId)?(s.vars.hasTransfered=!0,!0):!1},playError:function(e,n,a){var r=i(s.node.container);r.addClass("error-tips"),r.html('<div class="tip">'+(n?'<i class="tip-fail"></i>':"")+'<span class="tip-txt">'+e+(a?'&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0);">重试</a>':"")+"</span></div>"),a&&r.find("a").click(function(){s.callPlugin()})},events:function(){var e=i(s.node.mod);e.find(".video-start-tip").on("click",".close-btn",function(){e.find(".video-start-tip").hide()}),e.find(".save-to-pan").on("click",function(){t.trigger("plugin:保存到网盘@com.baidu.pan",{savepath:"/我的资源",from:"sharePlayerReminder"}),e.find(".video-start-tip").hide(),e.find(".video-over-tip").hide(),e.find(".video-overlay-iframe").hide(),s.rememberTreansfer()}),t.listen("share-video-after-transfer",function(){s.rememberTreansfer(),e.find(".video-start-tip").hide(),"block"===e.find(".video-overlay-iframe").css("display")&&(e.find(".video-overlay-iframe").hide(),e.find(".video-over-tip").hide(),s.player&&s.player.play())})},rememberTreansfer:function(){s.vars.hasTransfered=!0;var e=r.getItem("panTransferedFile");e=e?e:"",-1===e.indexOf(s.vars.shareFileId)&&r.setItem("panTransferedFile",e+s.vars.shareFileId)}},d={init:function(){s.events(),a.saveFileMeta(s),a.checkLoginCallTransfer(),s.getFile()&&o.SHARE_ID?s.callPlugin():s.playError("文件不存在，加载失败",!0,!1)}};d.init()});
;define("disk-share:widget/pageModule/share-file-main/info.tpl.js",function(a,s,i){var n={zip:['<a class="fileicon" node-type="info-open-button" href="javascript:;"></a>','<div class="share-info-zipdesc">',"文件大小:",'<span class="zip-quota"><%- info.fileQuota %></span>','<div class="unzip-box-bar"><span class="unzip-box" node-type="info-open-button"></span></div>',"</div>"].join(""),bt:['<a class="fileicon" node-type="info-open-button" href="javascript:;"></a>','<div class="share-info-zipdesc">',"文件大小:",'<span class="zip-quota"><%- info.fileQuota %></span>','<div class="bt-box-bar"><span class="bt-box" node-type="bt-open-button"></span></div>',"</div>"].join(""),other:['<a class="fileicon" href="javascript:;" style="cursor: default;"></a>','<div class="share-info-zipdesc">',"文件大小:",'<span class="zip-quota"><%- info.fileQuota %></span>',"</div>"].join("")};i.exports=n});
;define("disk-share:widget/pageModule/share-file-main/shareFileOpen/shareFileVideoOpen.js",function(e,i,n){var t=(e("base:widget/libs/jquerypacket.js"),e("base:widget/storage/storage.js")),o=e("system-core:context/context.js").instanceForSystem,s=window.yunData,a={conf:{filesMeta:null},util:{openVideoPlayer:function(){window.open("/enterprise/play/video?fid="+a.conf.filesMeta.fs_id)},openVideo:function(){if(s.uk===s.sharelinkMeta.uk)this.openVideoPlayer();else{var e=t.getItem("enterpriseTransferedFile"),i=e.indexOf(a.conf.filesMeta.fs_id+"@"+s.uk+",")>-1;i?this.openVideoPlayer():o.ui.tip({mode:"caution",msg:"请先保存此视频"})}}}},r=function(e){a.conf.filesMeta=e,a.util.openVideo()};n.exports=r});
;define("disk-share:widget/pageModule/share-file-main/shareFileOpen/shareFileOpen.js",function(e,i,o){var n=(e("base:widget/libs/jquerypacket.js"),e("system-core:context/context.js").instanceForSystem),l=e("disk-share:widget/pageModule/share-file-main/shareFileOpen/shareFileVideoOpen.js"),s={conf:{docDom:null,filesList:null,errorCallBack:null},util:{openDoc:function(){n.message.callPlugin("网盘文档阅读器@com.baidu.pan",{filesList:s.conf.filesList,dom:s.conf.docDom,errorCallBack:s.conf.errorCallBack})},openCooder:function(){n.message.callPlugin("网盘代码阅读器@com.baidu.pan",{filesList:s.conf.filesList,dom:s.conf.docDom,errorCallBack:s.conf.errorCallBack})},openPicture:function(){},openMusic:function(){n.message.callPlugin("网盘音频播放器@com.baidu.pan",{filesList:[s.conf.filesList]})},openVideo:function(){l(s.conf.filesList)},openZip:function(){n.message.callPlugin("网盘解压缩@com.baidu.pan",{filesList:[s.conf.filesList]})},execute:function(){for(var e=s.conf.filesList.server_filename.split("."),i=e[e.length-1].toLowerCase(),o="",n=0;n<window.manifest.length;n++)"网盘代码阅读器"===window.manifest[n].name&&(o=window.manifest[n].filesType);switch(+s.conf.filesList.category){case 1:s.util.openVideo();break;case 2:s.util.openMusic();break;case 3:s.util.openPicture();break;case 4:s.util.openDoc();break;case 6:o.indexOf(i)>-1?s.util.openCooder():s.util.openZip()}}}},a=function(e){s.conf.filesList=e.filesList,s.conf.docDom=e.dom||null,s.conf.errorCallBack=e.errorCallBack||null,s.util.execute()};o.exports=a});
;define("disk-share:widget/pageModule/share-file-main/share-file-main.js",function(e){var t=e("base:widget/libs/jquerypacket.js"),i=e("base:widget/libs/underscore.js"),o=e("base:widget/storage/storage.js"),n=e("system-core:context/context.js").instanceForSystem,a=n.ui.button,l=e("disk-share:widget/pageModule/share-file-main/shareFileOpen/shareFileOpen.js"),s=e("disk-share:widget/pageModule/share-file-main/info.tpl.js"),r={conf:{meta:{},parseDate:n.tools.baseService.parseDate,parseQuota:n.tools.baseService.toFriendlyFileSize,openDocCall:null,category:{cat1:"share-info-video",cat3:"share-info-picture",cat4:"share-info-doc",cat6:"share-info-zip"},imgDeg:0},node:{module:'[node-type="module-sharefile-main"]',fileHead:".module-share-header .x-button-box",fileInfo:'[node-type="share-info-box"]',fileInfoBtn:'[node-type="file-info-button"]',fileOpenBtn:'[node-type="info-open-button"]',btOpenBtn:'[node-type="bt-open-button"]',sharePicture:'[node-type="share-info-picture"]',leftRotater:'[node-type="leftRotater"]',rightRotater:'[node-type="rightRotater"]',rotateBar:"div.share-rotate-buttons",unzipBox:"span.unzip-box",btBox:"span.bt-box"},tmpl:{zip:s.zip,bt:s.bt,other:s.other},bindUI:function(){r.node.fileInfoNode=t(this.node.fileInfo),r.node.fileInfoNode.delegate(this.node.fileOpenBtn,"click",function(){r.util.openTheFile()}).delegate(this.node.leftRotater,"click",function(){r.util.imgRotate(-1)}).delegate(this.node.rightRotater,"click",function(){r.util.imgRotate(1)}).delegate(this.node.btOpenBtn,"click",function(){r.util.openTheBt()})},util:{openTheFile:function(e){var i={filesList:r.conf.meta,errorCallBack:function(t){if(0===+t)return!1;var i=['<div class="doc-view-failed">','<div class="doc-view-failed-img" style="display: block;">','<div class="doc-view-failed-txt">啊哦，预览不成功啊，下载下来看吧</div>',"</div>",'<div class="cb"></div>',"</div>"].join("");e.dom.html(i)}};e&&t.extend(!0,i,e),("4"==r.conf.meta.category||e&&"coder"===e.openType)&&r.node.fileInfoNode.css({height:t(window).height()-190}),l(i)},openTheBt:function(){var e=n.data.user;n.message.callPlugin("网盘BT离线下载@com.baidu.pan",{filesList:[r.conf.meta],moreParam:{uk:e.uk,sid:e.shareid,method:"query_sharedsinfo",fs_id:r.conf.meta.fs_id}})},getFileSuffix:function(e){return e.match(/([^\.]+)$/)[1].toLowerCase()},getFileIcon:function(){var e=r.conf.meta,t=n.file.getFileInfo(e.path,e.isdir,!1,!1,!0);return t},executeVideo:function(){},executeZip:function(){var e={type:"big",color:"blue",title:"打开压缩包",resize:!0};new a(e).appendTo(t(r.node.unzipBox))},executeBt:function(){var e={type:"big",color:"blue",title:"离线下载",resize:!0};n.data.user.uk!==n.data.user.visitor_uk&&new a(e).appendTo(t(r.node.btBox))},executeDefault:function(){var e=r.util.getFileSuffix(r.conf.meta.path),t="zip"===e||"rar"===e,o="torrent"===e||"bt"===e,n=r.node,a=t?r.tmpl.zip:r.tmpl.other;o&&(a=r.tmpl.bt);var l=i.template(a,{variable:"info"})({meta:r.conf.meta,fileQuota:r.conf.parseQuota(r.conf.meta.size)});n.fileInfoNode.append(l),n.fileInfoNode.find(".fileicon").addClass(this.getFileIcon().largeIcon),r.node.fileInfoNode.addClass("share-info-default"),t&&r.util.executeZip(),o&&r.util.executeBt()},executeInfo:function(){for(var e=r.conf.category["cat"+r.conf.meta.category],t=r.conf.meta.server_filename.split("."),i=t[t.length-1].toLowerCase(),o="",n=0;n<window.manifest.length;n++)"网盘代码阅读器"===window.manifest[n].name&&(o=window.manifest[n].filesType);switch(+r.conf.meta.category){case 1:r.util.executeVideo();break;case 3:break;case 4:setTimeout(function(){r.util.openTheFile({dom:r.node.fileInfoNode})},600);break;case 6:o.indexOf(i)>-1?setTimeout(function(){r.util.openTheFile({dom:r.node.fileInfoNode,openType:"coder"})},600):r.util.executeDefault();break;default:r.util.executeDefault()}r.node.fileInfoNode.addClass(e)},checkLoginCallTransfer:function(){"1"===o.getItem("transferFiles")&&(n.message.callPlugin("保存到网盘@com.baidu.pan"),o.removeItem("transferFiles"))}}},f=window.yunData;!function(){f.sharelinkMeta=f.FILEINFO[0],n.extend({list:{getSelected:function(){return[f.sharelinkMeta]}}}),r.conf.meta=f.sharelinkMeta,r.bindUI(),r.util.executeInfo(),r.util.checkLoginCallTransfer()}()});
;define("disk-share:widget/pageModule/share-footer/share-footer.js",function(e){var t=e("base:widget/libs/jquerypacket.js");t(document).ready(function(){var e,n="/disk/cmsdata";try{e=Page.getCookie}catch(o){e=function(e){if(document.cookie.length>0){var t=document.cookie.indexOf(e+"=");if(-1!==t){t=t+e.length+1;var n=document.cookie.indexOf(";",t);return-1===n&&(n=document.cookie.length),unescape(document.cookie.substring(t,n))}}return""}}t.get(n+"?do=recommend&time="+(new Date).getTime(),function(e){var n;try{n=t.parseJSON(e)}catch(o){}if(n&&0===n.errorno&&"null"!==n.recommend){var i=function(e,t,n,o){var i=new Date;i.setDate(i.getDate()+o),document.cookie=e+"="+escape(t)+(null==n?"":" ;path="+n)+(null==o?"":" ;expires="+i.toGMTString())};i("recommendTime",n.recommend+n.recommend_time,"/",3),t("#vers-update-new").css("visibility","hidden")}})})});
;define("disk-share:widget/pageModule/share-header/service/btns.js",function(e){var t=e("base:widget/libs/jquerypacket.js"),a=e("system-core:context/context.js").instanceForSystem,s=window.yunData||{},i={obj:{isAlreadyGetLike:!1,shareFileName:""},mod:{like:"a.funcs-tui",comment:"a.funcs-comment",share:"div.funcs-share",panel:"#bdshare_panel",shareArea:"span.funcs-share-area"},api:{getLikes:"/pcloud/like/data"},util:{getFileName:function(){i.obj.shareFileName=s.FILEINFO&&s.FILEINFO[0].server_filename,"multi_file"===s.SHAREPAGETYPE&&(i.obj.shareFileName+="等")},createShareBtn:function(){var e=t('<div class="funcs-share"><span>分享至</span><em class="btn-icon more-icon"></em><div id="bdshare_panel"><div id="bdshare" class="bdshare_t bds_tools get-codes-bdshare"><a class="bds_tsina">新浪微博</a><a class="bds_qzone">QQ空间</a><a class="bds_tqq">腾讯微博</a><a class="bds_renren">人人网</a><a class="bds_t163">网易微博</a></div><iframe src="about:blank" id="bdsshare_panel_iframe" frameborder="0"></iframe></div></div>');t(i.mod.shareArea).append('<span class="share-operate-seprate"></span>'),t(i.mod.shareArea).append(e),e.bind("mouseover",function(){t("#bdshare_panel").show()}).bind("mouseleave",function(){t("#bdshare_panel").hide()});var a="Hi，好东西一起分享，给大家分享“"+i.obj.shareFileName+"”文件，快来看看吧~~来自#百度网盘#";window.bds_config={bdPopTitle:"百度云专辑",bdText:a,des:a,text:a,searchPic:1,comment:a};var s=document.createElement("script");s.type="text/javascript",s.id="bdshare_js",s.setAttribute("data","type=tools"),document.body.appendChild(s);var n=document.createElement("script");n.type="text/javascript",n.id="bdshell_js",n.src="http://bdimg.share.baidu.com/static/js/shell_v2.js?cdnversion"+Math.ceil(new Date/36e5),document.body.appendChild(n)},getLikes:function(){i.obj.isAlreadyGetLike||t.ajax({type:"post",url:i.api.getLikes,data:{type:1,query_uk:s.SHARE_UK,source_id:s.SHARE_ID},timeout:1e5,success:function(e){if(!i.obj.isAlreadyGetLike){var e=t.parseJSON(e);e&&0==e.errno&&(i.obj.isAlreadyGetLike=!0,i.util.upDateLike(e))}}})},upDateLike:function(e){var a="",n="",o=e.like_count>999?"999+":e.like_count,c=e.comment_count>999?"999+":e.comment_count;if(e&&1===e.like_status?(a="已赞("+o+")",t(i.mod.like).children("em").removeClass("tui_icon")):e&&0===e.like_status&&(a="赞("+o+")",t(i.mod.like).children("em").addClass("tui_icon")),e&&"undefined"!=typeof e.comment_count){var d=c?c:0;n="评论("+d+")"}t(i.mod.like).data({count:e.like_count,status:e.like_status}),t(i.mod.like).children("b").text(a),t(i.mod.comment).data("count",e.comment_count),t(i.mod.comment).text(n),"multi_file"!==s.SHAREPAGETYPE&&t(i.mod.comment).attr({href:"#comment_panel"})},doComment:function(e){"multi_file"===s.SHAREPAGETYPE&&a.message.callPlugin("网盘链接管理-评论@com.baidu.pan",{source_uk:s.SHARE_UK,source_id:s.SHARE_ID,type:0,avatar_url:s.MYAVATAR,uname:s.MYNAME,current_uk:s.MYUK,pansuk:s.PANSUK,domType:2,limit:20,dialog:{hasBorder:!0,hasArraw:!0,hasScroll:!0,left:290},commentBtnDom:e})}},bindEvent:function(){t(i.mod.like).on("click",function(){var e=t(this);a.message.callPlugin("网盘链接管理-点赞@com.baidu.pan",{state:+e.data("status"),sourceUk:s.SHARE_UK,type:0,sourceId:s.SHARE_ID,ele:t("#albumTui"),btnDom:e})}),t(i.mod.comment).on("click",function(e){e.stopPropagation(),i.util.doComment(t(this))})},init:function(){i.util.getFileName(),"https:"!==window.location.protocol&&i.util.createShareBtn(),i.bindEvent(),i.util.getLikes()}};i.init()});
;define("disk-share:widget/pageModule/share-header/share-header.js",function(e){var t=e("base:widget/libs/jquerypacket.js"),a=e("base:widget/tools/tools.js"),n=e("system-core:context/context.js").instanceForSystem,s=a.toEntity(yunData.FILEINFO[0].server_filename),i="",o=t(".module-share-header .file-name");switch(yunData.SHAREPAGETYPE){case"single_file_page":i=s.substring(s.lastIndexOf(".")+1).toLowerCase();break;case"multi_file":1===yunData.FILEINFO.length&&yunData.FILEINFO[0].isdir?i="dir":(i="multi",s+="等")}o.attr("title",s).html('<em class="global-icon-16 global-icon-16-'+i+'"></em> '+s),setTimeout(function(){var e=[".panHelperBtn","[data-key=downloadhelper]","[node-type=btn-helper]"],a=t(e.join(","));if(a.length)try{n.log.send({name:"sharePage_plugin_downloadhelper"}),t.each(a,function(e,t){t.remove()})}catch(s){}},1e3),function(){Object.freeze&&Object.freeze(navigator)}()});
;define("disk-share:widget/pageModule/share-manage-header/share-manage-header.js",function(e){var a=e("base:widget/libs/jquerypacket.js"),t=e("base:widget/hash/hash.js"),n=e("system-core:context/context.js").instanceForSystem.message;e("disk-share:widget/inbox-manage/inbox-manage.js");var s=window,i={mod:"div.module-share-manage-header",tab:'li[node-type~="tabs-item"]'},r=a(i.mod),o={_init:function(){this.listenHash(),this.addMessage(),this.initHash(),this.addEvent()},addMessage:function(){n.listen("share-manage-header",function(e,a){if("render"===e)switch(a.tabtype="share",a.tabtype){case"email":n.trigger("inbox-manage","inbox-manage-tab",{type:0,userType:1}),disk.DEBUG&&console.log("%c[Message]render-by-tabtype","background-color: blue; color: white;");break;case"phone":n.trigger("inbox-manage","inbox-manage-tab",{type:0,userType:2}),disk.DEBUG&&console.log("%c[Message]render-by-tabtype","background-color: blue; color: white;")}})},initHash:function(){try{var e=t.get("tabtype");void 0===e&&"email"!==e&&"phone"!==e&&(e="share"),n.trigger("share-manage-header","render",{tabtype:e})}catch(a){throw new Error(a.message)}},listenHash:function(){t.listen("tabtype",function(){var e=t.get("tabtype");n.trigger("share-manage-header","render",{tabtype:e})})},handleTabChange:function(e){a("li[data-tabtype="+e+"]").addClass("selected").siblings(i.tab).removeClass("selected")},addEvent:function(){var e=function(e){"email"===e||"phone"===e?t.set("tabtype",e):(s.location.href="/share/manage",window.event.returnValue=!1)};r.find(i.tab).click(function(){try{var t=a(this).data("tabtype");e(t)}catch(n){throw new Error(n.message)}})}};a(document).ready(function(){o._init()})});
;define("disk-share:widget/pageModule/share-person-info/service/shareCount.js",function(r,e,o){var a=r("base:widget/libs/jquerypacket.js"),t={reqUrl:"/share/count",provideShareData:function(r){return r.uk?void t._fetchData(r.uk,r.shareId,r.type,r.callback):void(disk.DEBUG&&console.log("[shareCount.provideShareData()] uk is must"))},_fetchData:function(r,e,o,i){var n={};void 0!==r&&(n.uk=r),void 0!==e&&(n.shareid=e),void 0!==o&&(n.type=o),a.ajax({url:t.reqUrl,type:"get",data:n,dataType:"json",success:function(r){0===r.errno?i(r):t.doError(r.errno)},error:function(){t.doError()}})},doError:function(){}};o.exports=t});
;define("disk-share:widget/pageModule/share-person-info/share-person-info.js",function(o){var e=o("base:widget/libs/jquerypacket.js"),t=o("system-core:context/context.js").instanceForSystem,a=o("disk-share:widget/pageModule/share-person-info/service/shareCount.js"),l=o("base:widget/storage/storage.js"),n=o("base:widget/libs/underscore.js"),s={mod:".module-share-person-info",followBtn:'a[node-type~="share-follow-btn"]',followTxt:'span[node-type~="follow-txt"]',sharePersonInfoTmpl:'textarea[node-type~="tmpl-share-person-info"]',sharePersonNumbers:'ul[node-type="share-person-numbers"]'},i="立即订阅",u="相互订阅",r="已订阅",f={normalize:function(o,e){if("string"!=typeof o||0==o.length)return o;if(null==e||"string"!=typeof e)return o;var t,a=-1!=o.indexOf("?"),l=o.substring(o.length-1),n="bdstoken="+e;return t="&"==l||"?"==l?o+n:a?o+"&"+n:o+"?"+n},api:{getInfo:"/pcloud/user/getinfo",addFollow:"/pcloud/friend/addfollow",removeFollow:"/pcloud/friend/removefollow",userReport:"/api/report/user"}};e(document).ajaxSend(function(o,e,t){/share\/count/.test(t.url)&&(t.url+="&sign="+yunData.SIGN+"&timestamp="+yunData.TIMESTAMP)});var d=e(s.mod),c={templatePromise:null,templateReady:!1,templateData:{intro:"",avatar_url:"",pubshare_count:0,album_count:0,follow_count:0,fans_count:0,query_uk:"",follow_class:"",fans_class:"",uname:"",follow_txt:i,btnClass:""},getShareUserIntro:function(){var o=this,t=function(o){return Math.round(o/1e3)/10};e.get(f.normalize(f.api.getInfo+"?query_uk="+yunData.SHARE_UK),function(e){if(e&&!e.errno){var a=e.user_info.intro;""===a&&(a=e.user_info.uk===yunData.MYUK?"说明：你还没有个人介绍呢。":"说明：Ta很懒什么也没留下。");var l=e.user_info;switch(o.templateData.pubshare_count=l.pubshare_count,o.templateData.album_count=l.album_count,o.templateData.fans_count=l.fans_count,o.templateData.follow_count=l.follow_count,l.pubshare_count>9999&&(o.templateData.pubshare_count=t(l.pubshare_count)+"万"),l.album_count>9999&&(o.templateData.album_count=t(l.album_count)+"万"),l.fans_count>9999&&(o.templateData.fans_count=t(l.fans_count)+"万"),l.follow_count>9999&&(o.templateData.follow_count=t(l.follow_count)+"万"),(l.pubshare_count>9999||l.album_count>9999||l.fans_count>9999||l.follow_count>9999)&&d.find(s.sharePersonNumbers).find("em").css("font-size","13px"),l.pair_follow_type){case 2:o.templateData.btnClass="mutualfollow",o.templateData.follow_txt=u;break;case 1:case-1:o.templateData.btnClass="follow",o.templateData.follow_txt=i;break;case 0:o.templateData.btnClass="followed",o.templateData.follow_txt=r}o._buildTemplate(function(){d.find(s.followBtn).data("followtype",l.pair_follow_type)}),d.append('<div node-type="share-person-intro" class="share-person-intro" title="'+a+'">'+a+"</div>")}},"json")},_getShareCount:function(){a.provideShareData({uk:yunData.SHARE_UK,shareId:yunData.SHARE_ID,type:"vdt",callback:function(){c.getShareUserIntro()}})},addFollow:function(o,t){e.ajax({url:f.normalize(f.api.addFollow,yunData.MYBDSTOKEN),type:"post",data:{appid:o.appid||null,follow_uk:o.uk||null,follow_uname:o.uname||null,mark_name:o.mark_name||null,group_id:o.group_id||null},dataType:"json",success:function(o){t(o.errno)}}),this.reportLogger()},delFollow:function(o,t){e.ajax({url:f.normalize(f.api.removeFollow,yunData.MYBDSTOKEN),type:"post",data:{follow_uk:o.uk},dataType:"json",success:function(o){t(o.errno)}}),this.reportLogger()},reportLogger:function(){e.ajax({url:f.api.userReport,type:"POST",data:{timestamp:Math.round(new Date/1e3),action:"web_friend_api"}})},_bindEvent:function(){var a,n=this,f={};this._bindLogEvent(),d.delegate(s.followBtn,"click",function(d){var c,p,m=e(d.currentTarget),w=m.find(s.followTxt),g=m.data("followtype"),h={uk:yunData.SHARE_UK,uname:yunData.SHARE_USER_NAME,appid:123123};return 1!==yunData.LOGINSTATUS?(o.async("base:widget/passAPI/passAPI.js",function(o){o.promise.done(function(){o.passAPI.PassportInit.netdiskLogin({reload:!0}),o.passAPI.PassLoginDialog.onLoginSuccessCallback=function(){o.passAPI.PassportInit.hide(),l.setItem("followAction","1")}})}),!1):(m.hasClass("follow")?(h.follow_uname=n.templateData.uname,w.html("订阅中"),m.removeClass("follow").addClass("following"),n.addFollow(h,function(o){o?(w.html(i),m.removeClass("following").addClass("follow"),t.ui.tip(-6===o?{mode:"caution",msg:"订阅失败，用户未登录",sticky:!1}:{mode:"caution",msg:"订阅失败，请刷新后再试",sticky:!1})):1===g?(w.html(u),m.removeClass("following").addClass("mutualfollow").data("followtype",2)):(w.html(r),m.removeClass("following").addClass("followed").data("followtype",0))})):m.hasClass("followed")?(f={title:"取消订阅",className:"un-follow",body:'<div class="content">确定不再订阅“'+h.uname+"”了吗？</br>(取消订阅后你就不能看到TA的分享动态了哦。)</div>",draggable:!1,width:"480px",position:{xy:"center"},buttons:[{name:"confirm",title:"确定",type:"big",color:"blue",position:"center",padding:[50,50],click:function(){c()}},{name:"cancel",title:"取消",type:"big",position:"center",padding:[50,50],click:function(){p()}}]},w.html("取消中"),m.removeClass("followed").addClass("unfollowing"),"undefined"==typeof a&&(a=t.ui.window(f)),a.show(),c=function(){a.hide(),n.delFollow(h,function(o){o?(console.warn("del follow fail"),w.html(r),m.removeClass("unfollowing").addClass("followed")):(w.html(i),m.removeClass("unfollowing").addClass("follow").data("followtype",-1))})},p=function(){a.hide(),w.html(r),m.removeClass("unfollowing").addClass("followed")}):m.hasClass("mutualfollow")&&(f={title:"取消订阅",className:"un-follow",body:'<div class="content">确定不再订阅“'+h.uname+"”了吗？</br>(取消订阅后你就不能看到TA的分享动态了哦。)</div>",draggable:!1,width:"480px",position:{xy:"center"},buttons:[{name:"confirm",title:"确定",type:"big",color:"blue",position:"center",padding:[50,50],click:function(){c()}},{name:"cancel",title:"取消",type:"big",position:"center",padding:[50,50],click:function(){p()}}]},"undefined"==typeof a&&(a=t.ui.window(f)),w.html("取消中"),m.removeClass("mutualfollow").addClass("unfollowing"),a.show(),c=function(){a.hide(),n.delFollow(h,function(o){o?(console.warn("del follow fail"),w.html(u),m.removeClass("unfollowing").addClass("mutualfollow")):(w.html(i),m.removeClass("unfollowing").addClass("follow").data("followtype",1))})},p=function(){w.html(u),m.removeClass("unfollowing").addClass("mutualfollow")}),!1)})},_bindLogEvent:function(){d.delegate(".share-person-avatar a","click",function(){}),d.delegate(".share-person-username","click",function(){}),d.delegate(".sicon","click",function(){t.log.send({name:"dlink_personal_info_sicon",value:"外链页个人信息皇冠icon"})})},_buildTemplate:function(o){var e=d.find(s.sharePersonInfoTmpl).val();void 0!==e&&(d.html(n.template(e,{variable:"data"})(this.templateData)),this.templateReady=!0,o(),"1"===l.getItem("followAction")&&(d.find(s.followBtn).trigger("click"),l.removeItem("followAction")))},init:function(){this._bindEvent()}};t.message.listen("share-person-info",function(o){"show-intro"===o&&c._getShareCount()}),c.init()});
;define("disk-share:widget/pageModule/share-top-bar/share-top-bar.js",function(e){var t=e("base:widget/libs/jquerypacket.js"),r=e("system-core:context/context.js").instanceForSystem,o=t(".module-share-top-bar");r.Broker.initButtonBroker({name:"shareTools",config:{container:o.find(".bar"),limit:5}})});
;define("disk-share:widget/pageModule/share-video/share-video.js",function(e){var t=e("base:widget/libs/jquerypacket.js"),i=e("system-core:context/context.js").instanceForSystem,a=(e("disk-share:widget/system/swfUtil/swfUtil.js"),e("base:widget/storage/storage.js")),n=(e("base:widget/hash/hash.js"),i.message),s=function(){var s={},o={},r=function(){return location.search.indexOf("fid=")>0}(),l={target:"module-sharevideo-play"},f=function(){o.init()};return o.shareFileId=yunData.FILEINFO[0].fs_id+"@"+yunData.MYUK+",",o.init=function(){o.bindListener(),o.afterPluginLoaded()},o.bindListener=function(){n.listen("share-video-after-transfer",function(){o.afterTransfer()})},o.checkLogin=function(){var t=o.getLoginStatus();return 0==t?(VideoFlash.flashPlayer.pause(),e.async("base:widget/passAPI/passAPI.js",function(e){e.promise.done(function(){e.passAPI.PassportInit.netdiskLogin({reload:!0}),e.passAPI.PassLoginDialog.onLoginSuccessCallback=function(){a.setItem("sharevideologin","1")}})}),!1):!0},o.checkOver=function(e){if(1!==o.resolveFileInDiskStatus){o.flagAddTipsFlag=!1;var t=VideoFlash.flashPlayer,i=yunData.FILEINFO[0].duration||VideoFlash.obtain().getTotalTime(),a=i>o.maxTimes?o.maxTimes:parseInt(i/2,10);return e>a?(o.resolveTime=setTimeout(function(){t.pause()}),o.addTransferTipsByVideo(),"full"===VideoFlash.obtain().getDisplayState()&&VideoFlash.obtain().setDisplayState("normal"),!1):!0}return o.flagAddTipsFlag=!0,!0},o.addTransferTipsByStartDisplayed=!1,o.addTransferTipsByStart=function(){if(!o.addTransferTipsByStartDisplayed&&1!==o.resolveFileInDiskStatus){o.addTransferTipsByStartDisplayed=!0;var e=new VideoFlashTips({closeFunc:function(){},text:'为你播放片头，<a class="opendir" href="javascript:;">保存到网盘</a>后就可以看完整视频啦',userEvent:{".opendir":function(){o.triggerTransfer(),e.setVisible(!1)}},close:!0}),i=t("#"+l.target),a=i.offset(),n=a.top,s=a.left,r=i.height();e.setLocation(s+15,n+r-90),e.setVisible(!0),t(window).resize(function(){var t=i.offset(),a=t.top,n=t.left,s=i.height();e&&e.setLocation(n+15,a+s-90)})}},o.addTransferTipsByVideo=function(){VideoFlashTips.removeAllTips();var e=t("#"+l.target),i=e.offset(),a=i.top,n=i.left,s=e.height(),r=e.width(),f=new VideoFlashTips({iWidth:r,iHeight:s,iLeft:n,iTop:a,closeFunc:function(){},className:"transfertip",text:'1秒钟<a class="opendir" href="javascript:;">保存至百度网盘</a>即可观看完整视频',userEvent:{".opendir":function(){o.triggerTransfer()}}});f.setLocation(n+259,a+288),f.setVisible(!0),t(window).resize(function(){var t=e.offset(),i=t.top,a=t.left;f&&f.setLocation(a+259,i+288)})},o.addLoginTipsByStart=function(){VideoFlashTips.removeAllTips();var e=t("#"+l.target),i=e.offset(),a=i.top,n=i.left,s=e.height(),r=e.width(),f=new VideoFlashTips({iWidth:r,iHeight:s,iLeft:n,iTop:a,closeFunc:function(){},className:"logintip",text:'<span class="logintipalert"> <a href="javascript:;">登录</a>即可观看视频</span>',userEvent:{".logintipalert":function(){o.checkLogin()}}});f.setLocation(n+299,a+288),f.setVisible(!0),t(window).resize(function(){var t=e.offset(),i=t.top,a=t.left;f&&f.setLocation(a+299,i+288)}),t(".flash-video-iframe-tips").hide()},o.onplayererrorFunc=function(){VideoFlashTips.removeAllTips();var e=t("#"+l.target),i=e.offset(),a=i.top,n=i.left,s=e.height(),r=e.width(),f=new VideoFlashTips({iWidth:r,iHeight:s,iLeft:n,iTop:a,center:!0,closeFunc:function(){},className:"largefontsize",text:'<em class="tip-fail"></em>服务器有点儿忙，稍后重试一下吧<a class="retry" href="javascript:;" style="margin-left: 20px;">重试</a>',userEvent:{".retry":function(){o.reLoadVideo()}}});f.setVisible(!0),t(".flash-video-iframe-tips").css("opacity","1")},o.reLoadVideo=function(){t(".flash-video-iframe-tips").css("opacity","0.7"),VideoFlashTips.removeAllTips(),o.afterPluginLoaded()},o.afterPluginLoadedFail=function(){tip.show({mode:"caution",msg:'组件加载失败，请<a href="javascript:window.location.reload();">刷新</a>后重试',hasClose:!0,autoClose:!1})},o.flagSendPlayAnalytics=!1,o.afterPluginLoaded=function(){var e=o.getFile(),t=o.getShareInfo();if(o.checkFileIsInDisk(e.md5,o.afterCheckIsInDisk),-1!=navigator.platform.indexOf("iPhone")||-1!=navigator.platform.indexOf("iPad"))var n="M3U8_AUTO_480";else var n="M3U8_FLV_264_480";var s=location.protocol+"//"+location.host+"/share/streaming?channel=chunlei&uk="+t.share_uk+"&type="+n+"&path="+encodeURIComponent(e.path)+"&sign="+t.sign+"&timestamp="+t.timestamp+"&shareid="+t.share_id,f=!1;VideoFlash.obtain().getVideoPath=function(){return s},r&&(f=!0),"1"===a.getItem("sharevideologin")&&(f=!0,a.removeItem("sharevideologin"),i.log.send({name:"share_video_play_login"})),"0"==o.getLoginStatus()&&(f=!1);var d={path:e.path,target:l.target,autoStart:f,onLoad:function(){"0"==o.getLoginStatus()&&setTimeout(function(){o.addLoginTipsByStart()},500)},onTime:function(e){o.checkOver(e),o.checkLogin()},onReady:function(){1!==o.resolveFileInDiskStatus&&o.addTransferTipsByStart()},onPlay:function(){o.flagSendPlayAnalytics||(o.flagSendPlayAnalytics=!0,i.log.send({name:"share_video_play_start"}))},onBeforePlay:function(){return o.checkLogin()},onBeforeSeek:function(e){return o.checkOver(e)},onError:function(e){o.onplayererrorFunc(e)}};VideoFlash.obtain().play(d)},o.afterCheckIsInDisk=function(e){o.resolveFileInDiskStatus=e},o.checkFileIsInDisk=function(e,t){var i=({access_token:o.getBDsToken(),uk:yunData.MYUK,md5:e},function(){"function"==typeof t&&t(2)}),n=function(e){"function"==typeof t&&t(e.result?1:2)};if(1!=o.getLoginStatus())return void i();if(o.getIsSelf())return void n({result:!0});var s=a.getItem("panTransferedFile");s||(s=""),-1!=s.indexOf(o.shareFileId)?n({result:!0}):i()},o.playFlashVideo=function(e){VideoFlash.obtain().play(e)},o.getBDsToken=function(){return yunData.MYBDSTOKEN},o.getLoginStatus=function(){return yunData.LOGINSTATUS},o.getIsSelf=function(){return yunData.MYSELF},o.getFile=function(){return yunData.FILEINFO[0]},o.maxTimes=30,o.getShareInfo=function(){return{share_id:yunData.SHARE_ID,share_uk:yunData.SHARE_UK,sign:yunData.SIGN,timestamp:yunData.TIMESTAMP,cover_img:yunData.FILEINFO[0].thumbs.url3.replace("850_u580","440_u260")}},o.triggerTransfer=function(){i.ui.tip.show({mode:"loading",msg:'正在保存至<a href="//pan.baidu.com/disk/home#/all?path='+encodeURIComponent("/我的资源")+'">我的资源</a>文件夹',hasClose:!0,autoClose:!1})},o.afterTransfer=function(){o.resolveFileInDiskStatus=1;var e=a.getItem("panTransferedFile");e||(e=""),e.slice(-27e4),a.setItem("panTransferedFile",e+o.shareFileId),VideoFlashTips.removeAllTips(),VideoFlash.flashPlayer.play()},o.flagLoadedFlash=!1,o.flagAddTipsFlag=!1,o.resolveTime=null,o.resolveFileInDiskStatus=0,f.apply(s,arguments),s};"undefined"==typeof diskPlayer&&t.getScript("/box-static/common/thirdparty/flashVideo/js/playerAPI.js?t=1457430666874",function(){new s})});
;define("disk-share:widget/pageModule/share-video/share-video.js",function(require,exports,module){var $=require("base:widget/libs/jquerypacket.js"),Context=require("system-core:context/context.js").instanceForSystem,Message=Context.message,SwfUtil=require("disk-share:widget/system/swfUtil/swfUtil.js"),Storage=require("base:widget/storage/storage.js"),yunData=window.yunData,q={mod:"div.module-video",videoTitle:'div[node-type~="video-title"] .video-title-left',videoWrap:"#video-wrap"},$mod=$(q.mod),videoWrap=$(q.videoWrap),supportedByFlash="3gpp m3u8 m3u asf wmv avi flv f4v gif mkv mov mp4 m4a m4v 3gp 3g2 mj2 mp2 m2a mp3 mpeg mpg ts ogg MTS M2TS dat wma aac m4a ape flac rm rmvb wav webm".split(/\s+/),flashPlayerDownloadUrl="http://get.adobe.com/cn/flashplayer/",flashUrl="/box-static/disk-share/widget/pageModule/share-video/_nomd5/player/DiskPlayer.swf",supportFormat=function(e){for(var a=e.substr(e.lastIndexOf(".")+1).toLowerCase(),i=supportedByFlash,t=0,n=i.length;n>t;++t)if(i[t]==a)return!0;return!1},getTrackUrl=function(e){var a={hash_str:e.md5,format:2,hash_method:1,wd:e.server_filename,share_uk:window.yunData.SHARE_UK};a.search_local=yunData.MYSELF?1:0,a.video_path=e.path;var i="/api/resource/subtitle?",t="";for(var n in a)a.hasOwnProperty(n)&&(t+="&"+n+"="+encodeURIComponent(a[n]));return t&&(i+=t.slice(1)),i};if(-1!=navigator.platform.indexOf("iPhone")||-1!=navigator.platform.indexOf("iPad"))var playBPSType="M3U8_AUTO_480";else var playBPSType="M3U8_FLV_264_480";var getVideoUrl=function(e){var a=location.protocol+"//"+location.host+"/share/streaming?channel=chunlei&uk="+yunData.SHARE_UK+"&type="+playBPSType+"&path="+encodeURIComponent(e.path)+"&sign="+yunData.SIGN+"&timestamp="+yunData.TIMESTAMP+"&shareid="+yunData.SHARE_ID;return a},myFlashPlayer=!1,videoPlaying=!1,isIosPlatform=-1!=navigator.platform.indexOf("iPhone")||-1!=navigator.platform.indexOf("iPad"),destory=function(){operateUtil.hideLoading(),myFlashPlayer&&(SwfUtil.destroy(myFlashPlayer),myFlashPlayer=!1)},operateUtil={loading:function(){videoWrap.html(""),$(".video-loading-tip").show(),$("#video-wrap").removeClass("error-tips")},hideLoading:function(){$(".video-loading-tip").hide()},playError:function(e,a,i){destory(),$("#video-wrap").addClass("error-tips"),videoWrap.html('<div class="tip">'+(a?'<i class="tip-fail"></i>':"")+'<span class="tip-txt">'+e+(i?'&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0);">重试</a>':"")+"</span></div>"),i&&videoWrap.find("a").click(function(){playVideo(videoPlaying)})},installFlash:function(){destory(),$("#video-wrap").addClass("error-tips"),videoWrap.html('<div class="tip flash-not-installed">安装Flash插件后就可以看视频啦，快来下载安装吧<br/>（安装成功后，重启浏览器就可以播放啦）<br/><a target="_blank" href="'+flashPlayerDownloadUrl+'">下载Flash插件</a></div>')},installIosVideoHTML:function(e,a,i){e.html('<video width="100%" height="100%" autoplay controls="controls" id="'+a+'" src="'+i+'">浏览器不支持播放功能</video>'),playerFuncs.onLoad()}},utils={changePlayerStart:function(e){e?"function"==typeof myFlashPlayer.pause&&myFlashPlayer.pause():"function"==typeof myFlashPlayer.play&&myFlashPlayer.play()},getAvageSpeed:function(e){for(var a=0,i=0,t=0,n=e.length;n>t;t++)a+=e[t].bytes,i+=e[t].secs;return(a/1024/i).toFixed(2)},parseNameFromPath:function(e){return e.substring(e.lastIndexOf("/")+1,e.length)},getFlashVersion:function(){var f=null,n=navigator;if(n.plugins&&n.plugins.length){for(var ii=0,len=n.plugins.length;len>ii;ii++)if(-1!=n.plugins[ii].name.indexOf("Shockwave Flash")){f=n.plugins[ii].description.split("Shockwave Flash ")[1];break}}else if(window.ActiveXObject)for(var ii=11;ii>=2;ii--)try{var fl=eval("new ActiveXObject('ShockwaveFlash.ShockwaveFlash."+ii+"');");if(fl){f=ii+".0";break}}catch(e){}return f},sendLog:function(){},sendAvageSpeed:function(){if(priVars.speedArray&&!(priVars.speedArray.length<=0)){var e={},a=priVars.speedArray[0].url;e.op="video_flash_v2_avaspeed_analytics",videoPlaying&&(e.filepath=videoPlaying.path,e.fsid=videoPlaying.fs_id),e.speed=utils.getAvageSpeed(priVars.speedArray),e.hostName=a.slice(7,a.indexOf("?")),utils.sendLog(e),priVars.speedArray.length=0}},hackIeBrowserHasHashValue:function(){var e=document.title,a=function(a){a=a||window.event,"title"===a.propertyName&&document.title!==e&&setTimeout(function(){document.title=e},1)};"function"==typeof document.attachEvent&&document.attachEvent("onpropertychange",function(e){a(e)})},getFilePosition:function(e){var a=0;return"undefined"!=typeof Storage&&(a=Storage.getItem("videoflash_"+e)||0,a&&(a=parseInt(a,10),a=0>a?0:a),0/0==a&&(a=0)),a},setFilePosition:function(e,a){if("undefined"!=typeof Storage&&myFlashPlayer&&"function"==typeof myFlashPlayer.getDuration){if(null==a)return;var i=myFlashPlayer.getDuration();e="videoflash_"+e,a+25>=i?Storage.removeItem(e):Storage.setItem(e,a)}}},priVars={flagCanAddTime:!0,speedArray:[],speedArrayList:[],originalTitle:document.title,previewTime:30,shareFileId:yunData.FS_ID+"@"+yunData.MYUK+",",hasTransfered:!1},pri={};pri.afterCheckIsInDisk=function(e){pri.resolveFileInDiskStatus=e},pri.checkInDisk=function(e){({access_token:pri.getBDsToken(),uk:yunData.MYUK,md5:e});if(1!==+pri.getLoginStatus())return!1;if(pri.getIsSelf())return!0;var a=Storage.getItem("panTransferedFile");return a||(a=""),-1!==a.indexOf(priVars.shareFileId)?(priVars.hasTransfered=!0,!0):!1},pri.getBDsToken=function(){return yunData.MYBDSTOKEN},pri.getLoginStatus=function(){return yunData.LOGINSTATUS},pri.getIsSelf=function(){return yunData.MYSELF},pri.getFile=function(){return yunData.FILEINFO[0]},pri.maxTimes=30,pri.checkNotOver=function(e){return priVars.hasTransfered||yunData.SHARE_UK===yunData.MYUK?!0:e>priVars.previewTime?(myFlashPlayer&&(myFlashPlayer.pause(),myFlashPlayer.setDisplayState("normal"),$mod.find(".video-start-tip").hide(),$mod.find(".video-overlay-iframe").show(),$mod.find(".video-over-tip").show()),!1):!0};var playerFuncs={onLoad:function(){operateUtil.hideLoading(),$("#flashplayer").addClass("visiblevideo"),document.title=priVars.originalTitle},onReady:function(){},onPlayerErrorFunc:function(e){if(e||(e={}),videoPlaying&&(e.filepath=videoPlaying.path),e.analytics&&!e.httpstatus)return e.analyticsSpeed?void(priVars.speedArray=e.speedArray):(e.op="video_flash_v2_analytics",e.speedArray&&e.speedArray.length>0&&(utils.speedArrayList=e.speedArray,e.speed=utils.getAvageSpeed(e.speedArray),e.hostName=e.speedArray[0].url,delete e.speedArray),void utils.sendLog(e));e.httpstatus&&(e.op="video_flash_v2_httpstatus",utils.sendLog(e),404==e.httpstatus&&(e.error_code=31066));var a,i="",t=!1;a=e.error_code,e.islive?(i="视频正在转码，请稍候重试... ",t=!0):31346===a?(i="加载失败了，稍候重试一下吧",t=!0):31066===a?i="文件不存在，换一个吧":0==yunData.loginstate?i='您还没有登录，请<a class="tips-login">登录</a>后重试一下吧':(i="服务器有点儿忙，稍候重试一下吧... ",t=!0),operateUtil.playError(i,!0,t),$mod.find(".tips-login").off().on("click",function(){var e=Context.ui.tip({mode:"loading",msg:"请稍候..."});require.async("base:widget/passAPI/passAPI.js",function(a){e.hide(),a.promise.done(function(){a.passAPI.PassportInit.netdiskLogin({reload:!0}),a.passAPI.PassLoginDialog.onLoginSuccessCallback=function(){a.passAPI.PassportInit.hide()}})})}),$.ajax({url:"//update.pan.baidu.com/statistics",data:{op:"webvideo",from:"playvideo",ajaxurl:getVideoUrl(videoPlaying.path),path:encodeURIComponent(videoPlaying.path),fsid:videoPlaying.fs_id,type:playBPSType,md5:videoPlaying.md5,playError:1}})},onPlayerOverFunc:function(e){e?Context.ui.tip({mode:"caution",msg:"视频正在转码，播放过程中可能稍有卡顿"}):utils.sendAvageSpeed()},onPlayerPlayFunc:function(){},onPlayerPauseFunc:function(){},onPlayerSeekFunc:function(e){return pri.checkNotOver(e)},onPlayerBeforePlayFunc:function(){return!0},onPlayerBeforeSeekFunc:function(e){return pri.checkNotOver(e)},onTimeFunc:function(e){return pri.checkNotOver(e)}};window.windowPlayerFunc=playerFuncs;var playVideo=function(e){if(utils.sendAvageSpeed(),destory(),!e)return void operateUtil.playError("文件不存在",!0,!1);videoPlaying=e,operateUtil.loading();var a=utils.parseNameFromPath(e.path),i=a.substring(0,a.lastIndexOf("."));$(".video-title span").text(i).attr("title",i);var t=utils.getFlashVersion();if(!isIosPlatform&&(null==t||parseFloat(t,10)<10.1))operateUtil.installFlash();else if(supportFormat(e.path)){videoWrap.html("");var n=getVideoUrl(e),o=location.protocol+"//update.pan.baidu.com/statistics?clienttype=0&op=webvideo&from=sharevideo";if(isIosPlatform)operateUtil.installIosVideoHTML(videoWrap,"flashplayer",n);else{var r="fsid="+encodeURIComponent(e.fs_id)+"&filename="+encodeURIComponent($(".video-title-left").text())+"&file="+encodeURIComponent(n)+"&srturl="+encodeURIComponent(getTrackUrl(e))+"&logurl="+encodeURIComponent(o)+"&md5="+encodeURIComponent(e.md5)+"&onReady="+encodeURIComponent("windowPlayerFunc.onReady")+"&onLoad="+encodeURIComponent("windowPlayerFunc.onLoad")+"&onError="+encodeURIComponent("windowPlayerFunc.onPlayerErrorFunc")+"&onOver="+encodeURIComponent("windowPlayerFunc.onPlayerOverFunc")+"&onBeforeSeek="+encodeURIComponent("windowPlayerFunc.onPlayerBeforeSeekFunc")+"&onBeforePlay="+encodeURIComponent("windowPlayerFunc.onPlayerBeforePlayFunc")+"&onPlay="+encodeURIComponent("windowPlayerFunc.onPlayerPlayFunc")+"&onPause="+encodeURIComponent("windowPlayerFunc.onPlayerPauseFunc")+"&onSeek="+encodeURIComponent("windowPlayerFunc.onPlayerSeekFunc")+"&autoStart=false&onTime="+encodeURIComponent("windowPlayerFunc.onTimeFunc");SwfUtil(videoWrap.attr("id"),{id:"flashplayer",src:flashUrl,flashvars:r,allowFullScreenInteractive:!0,allowFullScreen:!0,wmode:"Opaque",quality:"high"})}myFlashPlayer=document.getElementById("flashplayer")}else operateUtil.playError("视频格式暂不支持播放，换一个吧",!0,!1);Message.trigger("video-trigger-playvideo",{file:videoPlaying}),pri.checkInDisk(e.md5,pri.afterCheckIsInDisk)||$mod.find(".video-start-tip").show(),utils.sendLog({type:"playVideo",username:yunData.username,file:e.path,fs_id:e.fs_id,playbyflash:1},"disklog")};Message.listen("video-trigger-file",function(e){playVideo(e)}),Message.listen("video-trigger-list-error",function(e){operateUtil.playError(e.msg,!0,!1)}),Message.listen("share-video-after-transfer",function(){priVars.hasTransfered=!0,$mod.find(".video-start-tip").hide(),"block"==$mod.find(".video-overlay-iframe").css("display")&&($mod.find(".video-overlay-iframe").hide(),$mod.find(".video-over-tip").hide(),myFlashPlayer&&myFlashPlayer.play())}),yunData.SHARE_ID?(pri.checkInDisk(yunData.FILEINFO[0].md5,pri.afterCheckIsInDisk),playVideo(yunData.FILEINFO[0])):operateUtil.playError("文件不存在，加载失败",!0,!1),$mod.find(".video-start-tip").on("click",".close-btn",function(){$mod.find(".video-start-tip").hide()}),$mod.find(".save-to-pan").on("click",function(){Message.trigger("plugin:保存到网盘@com.baidu.pan",{savepath:"/我的资源",from:"sharePlayerReminder"}),$mod.find(".video-start-tip").hide(),$mod.find(".video-over-tip").hide(),$mod.find(".video-overlay-iframe").hide(),pri.resolveFileInDiskStatus=1;var e=Storage.getItem("panTransferedFile");e||(e=""),e.slice(-27e4),Storage.setItem("panTransferedFile",e+priVars.shareFileId)}),$mod.bind("click",function(){myFlashPlayer&&"function"==typeof myFlashPlayer.hideControlBar&&(myFlashPlayer.hideControlBar(),Message.trigger("video-listen-show-aside-toolbar",{visible:0}))}),$(window).on("beforeunload",function(){var e=$("#flashplayer").get(0);"function"==typeof e.sendDataBeforeUnload&&e.sendDataBeforeUnload()}),yunData.sharelinkMeta=yunData.FILEINFO[0],Context.extend({list:{getSelected:function(){return[yunData.sharelinkMeta]}}}),Context.log.send({type:"video_old_init"})});
;define("disk-share:widget/pageModule/shareCount/shareCount.js",function(r,e,o){var a=r("base:widget/libs/jquerypacket.js"),t={reqUrl:"/share/count",provideShareData:function(r){return r.uk?void t._fetchData(r.uk,r.shareId,r.type,r.callback):void(disk.DEBUG&&console.log("[shareCount.provideShareData()] uk is must"))},_fetchData:function(r,e,o,n){var i={};void 0!==r&&(i.uk=r),void 0!==e&&(i.shareid=e),void 0!==o&&(i.type=o),a.ajax({url:t.reqUrl,type:"get",data:i,dataType:"json",success:function(r){0===r.errno?n(r):t.doError(r.errno)},error:function(){t.doError()}})},doError:function(){}};o.exports=t});
;define("disk-share:widget/pageModule/singleFileComment/singleFileComment.js",function(n,e,t){var o,a=n("base:widget/libs/jquerypacket.js"),i=function(){this.recommentPanl=a(".comment_panel"),this.initCommentPlugin()};i.prototype={initCommentPlugin:function(){var n=this,e={source_uk:yunData.SHARE_UK,source_id:yunData.SHARE_ID,type:0,avatar_url:yunData.MYAVATAR,uname:yunData.MYNAME,current_uk:yunData.MYUK,pansuk:yunData.PANSUK,login_status:yunData.LOGINSTATUS,domType:1,limit:20,dialog:{hasBorder:!1,hasArraw:!1,hasScroll:!1},onLoadedCallBack:function(){disk.DEBUG&&console.log("loaded comment successed!")},onrefreshPage:function(){disk.DEBUG&&console.log("loaded comment successed ~~~!")},onLoadedTextarea:function(){}};this._installCommentPlugin(function(){n._mCommentPanel=new o,n._mCommentPanel.startInit(n.recommentPanl,e),n._mCommentPanel.getTotalCount=function(n){var e=n>999?"999+":n;a(".funcs-comment").text("评论("+e+")")}})},_installCommentPlugin:function(e){void 0===o?n.async("disk-share:widget/pageModule/commentPanel/commentPanel.js",function(n){o=n,"function"==typeof e&&e()}):"function"==typeof e&&e()}},t.exports=i});
;define("disk-share:widget/pageModule/toolbar/toolbar.js",function(e){var i=e("base:widget/libs/jquerypacket.js"),t=(e("base:widget/storage/storage.js"),e("system-core:context/context.js").instanceForSystem),o=t.message,d=i(".module-toolbar"),s={listGridSwitch:".list-grid-switch",listSwitch:".list-switch",gridSwitch:".grid-switch",prevDom:"div.prev-dom",afterDom:"div.after-dom",defaultDom:"div.default-dom",userDom:"div.user-dom",timeLineDom:"div.yun-pic-bar"};t.Broker.initButtonBroker({name:"shareTools",config:{container:d.find(".bar"),limit:4}});var n=function(e){null!==localStorage&&localStorage.setItem("chooseviewtype",e)};d.on("click",s.listSwitch,function(){if(!i(this).parent().hasClass("list-switched-on")){var e={type:"list"};n("list"),o.trigger("system-show-view-mode",e)}}),d.on("click",s.gridSwitch,function(){if(!i(this).parent().hasClass("grid-switched-on")){var e={type:"grid"};n("grid"),o.trigger("system-show-view-mode",e)}}),o.listen("system-update-view-mode",function(e){var i=d.find(s.listGridSwitch);"list"===e.type?(i.addClass("list-switched-on").removeClass("grid-switched-on"),i.find("a[node-type=axjm6DKn]").hide(),i.find("a[node-type=aeztJ2Gl]").show()):(i.removeClass("list-switched-on").addClass("grid-switched-on"),i.find("a[node-type=axjm6DKn]").show(),i.find("a[node-type=aeztJ2Gl]").hide())});var r=!1,a=!1;t.extend({toolbar:{afterDom:function(e,t){if(e){if(a)return;t===!0&&(a=!0),d.find(s.afterDom).html("").append(e).show()}else e===!1?(d.find(s.afterDom).html(""),a=!1):d.find(s.afterDom).hide();i(window).trigger("resize")},prevDom:function(e,t){if(e){if(r)return;t===!0&&(r=!0),d.find(s.prevDom).html("").append(e).show()}else e===!1?(d.find(s.prevDom).html(""),r=!1):d.find(s.prevDom).hide();i(window).trigger("resize")},showDefault:function(){d.find(s.userDom).hide(),d.find(s.defaultDom).show(),d.find(s.prevDom).children().length&&d.find(s.prevDom).show(),d.find(s.afterDom).children().length&&d.find(s.afterDom).show(),d.find(s.timeLineDom).hide(),d.removeClass("module-toolbar-hackbg")},setDom:function(e){d.find(s.defaultDom).hide(),d.find(s.prevDom).hide(),d.find(s.afterDom).hide(),d.find(s.timeLineDom).hide(),d.find(s.userDom).html("").append(e).show(),d.removeClass("module-toolbar-hackbg"),i(window).trigger("resize")},showTimelineDom:function(){d.find(s.defaultDom).hide(),d.find(s.prevDom).hide(),d.find(s.afterDom).hide(),d.find(s.userDom).hide(),d.find(s.timeLineDom).show(),d.addClass("module-toolbar-hackbg"),i(window).trigger("resize")}}})});